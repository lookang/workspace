<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <title>spring k=(Ï€^2)/25 N/m) massm=1 kg  model x,v,a vs t</title>
    <link rel="stylesheet"  type="text/css" href="_ejs_library/css/ejss.css" />
    <script src="_ejs_library/scripts/common_script.js"></script>
    <script src="_ejs_library/scripts/textresizedetector.js"></script>
<script type="text/javascript"><!--//--><![CDATA[//><!--
function Matrix(){var e=Array.prototype.concat.apply([],arguments);e.length||(e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.m=hasFloat32Array?new Float32Array(e):e}function Vector(e,t,r){"object"==typeof e?(this.x=e[0]||0,this.y=e[1]||0,this.z=e[2]||0):(this.x=e||0,this.y=t||0,this.z=r||0)}function _smartDevice(e,t){return this.websocket=e,this.loadMetadata(t),this}function wrapper(e,t){e.hasOwnProperty("ip")?(wsUri="ws://"+e.ip+":"+e.port+"/",this.websocket=new WebSocket(wsUri)):this.websocket=e,this.smartdevice=new _smartDevice(this.websocket,t),this.smartdevice.loadApis(),this.smartdevice.loadModels(),this.smartdevice.generateMethodCall(),this.smartdevice.generateModelFilling()}var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.AnalyticCurve={copyTo:function(e,t){EJSS_DRAWING2D.Element.copyTo(e,t),t.setNumPoints(e.getNumPoints()),t.setMinimun(e.getMinimun()),t.setMaximun(e.getMaximun()),t.setVariable(e.getVariable()),t.setFunctionX(e.getFunctionX()),t.setFunctionY(e.getFunctionY())},registerProperties:function(e,t){EJSS_DRAWING2D.Element.registerProperties(e,t),t.registerProperty("NumPoints",e.setNumPoints,e.getNumPoints),t.registerProperty("Minimum",e.setMinimun,e.getMinimun),t.registerProperty("Maximum",e.setMaximun,e.getMaximun),t.registerProperty("Variable",e.setVariable,e.getVariable),t.registerProperty("FunctionX",e.setFunctionX,e.getFunctionX),t.registerProperty("FunctionY",e.setFunctionY,e.getFunctionY),t.registerAction("OnError")}},EJSS_DRAWING2D.analyticCurve=function(e){var t,r,n=EJSS_DRAWING2D.element(e),i="t",o="t",a="0",s={},l=5*screen.width;return n._23=function(){return"ElementAnalyticCurve"},n.setParameters=function(e){for(var t in e)s[t]=e[t];n.setChanged(!0)},n.getParameters=function(){return s},n.getBounds=function(e){var u,g,c=n.getX(),S=n.getY(),d=n.getSizeX(),f=n.getSizeY(),E=d/2,p=f/2,h=n.getRelativePositionOffset(d,f),m=EJSS_DRAWING2D.functionsParser(),A=!1;try{u=m.parse(o)}catch(e){console.log("Analytic curve error parsing FunctionX: "+o),A=!0}if(!A)try{g=m.parse(a)}catch(e){console.log("Analytic curve error parsing FunctionY: "+a),A=!0}if(A)return n.getController().invokeAction("OnError"),{left:c+h[0]-E-d,right:c+h[0]-E+d,top:S+h[1]-p+f,bottom:S+h[1]-p-f};var P=void 0===t||null===t?n.getPanel().getRealWorldXMin():t,v=void 0===r||null===r?n.getPanel().getRealWorldXMax():r,y=(v-P)/l,C=[],D={};for(var I in s)D[I]=s[I];try{for(var R=0,_=P;_<v;_+=y){D[i]=_;var T=u.evaluate(D),N=g.evaluate(D);isNaN(T)||isNaN(N)||(C[R]=[],C[R][0]=T,C[R++][1]=N)}}catch(e){return n.getController().invokeAction("OnError"),{left:c+h[0]-E-d,right:c+h[0]-E+d,top:S+h[1]-p+f,bottom:S+h[1]-p-f}}var O=0,M=0,b=0,G=0;if(C.length>0){O=C[0][0],b=C[0][0],M=C[0][1],G=C[0][1];for(var x=0;x<C.length;x++)C[x][0]>O&&(O=C[x][0]),C[x][0]<b&&(b=C[x][0]),C[x][1]>M&&(M=C[x][1]),C[x][1]<G&&(G=C[x][1])}return{left:c+h[0]-E+b*d,right:c+h[0]-E+O*d,top:S+h[1]-p+M*f,bottom:S+h[1]-p+G*f}},n.setNumPoints=function(e){l!=e&&(l=e,n.setChanged(!0))},n.getNumPoints=function(){return l},n.setMinimun=function(e){t!=e&&(t=e,n.setChanged(!0))},n.getMinimun=function(){return t},n.setMaximun=function(e){r!=e&&(r=e,n.setChanged(!0))},n.getMaximun=function(){return r},n.setVariable=function(e){i!=e&&(i=e,n.setChanged(!0))},n.getVariable=function(){return i},n.setFunctionX=function(e){o!=e&&(o=e,n.setChanged(!0))},n.getFunctionX=function(){return o},n.setFunctionY=function(e){a!=e&&(a=e,n.setChanged(!0))},n.getFunctionY=function(){return a},n.registerProperties=function(e){EJSS_DRAWING2D.AnalyticCurve.registerProperties(n,e)},n.setSize([1,1]),n.setRelativePosition("SOUTH_WEST"),n};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Arrow={NONE:0,ANGLE:1,CIRCLE:2,RECTANGLE:3,LINE:4,CURVE:5,TRIANGLE:6,DIAMOND:7,WEDGE:8,POINTED:9,INVANGLE:10,INVTRIANGLE:11,copyTo:function(e,t){EJSS_DRAWING2D.Element.copyTo(e,t),t.setRelativePosition(e.getRelativePosition()),t.setMarkEnd(e.getMarkEnd()),t.setMarkEndWidth(e.getMarkEndWidth()),t.setMarkEndHeight(e.getMarkEndHeight()),t.setMarkEndColor(e.getMarkEndColor()),t.setMarkEndStroke(e.getMarkEndStroke()),t.setMarkEndOrient(e.getMarkEndOrient()),t.setMarkStart(e.getMarkStart()),t.setMarkStartWidth(e.getMarkStartWidth()),t.setMarkStartHeight(e.getMarkStartHeight()),t.setMarkStartColor(e.getMarkStartColor()),t.setMarkStartStroke(e.getMarkStartStroke()),t.setMarkStartOrient(e.getMarkStartOrient()),t.setMarkMiddle(e.getMarkMiddle()),t.setMarkMiddleWidth(e.getMarkMiddleWidth()),t.setMarkMiddleHeight(e.getMarkMiddleHeight()),t.setMarkMiddleColor(e.getMarkMiddleColor()),t.setMarkMiddleColorSnd(e.getMarkMiddleColorSnd()),t.setMarkMiddleStroke(e.getMarkMiddleStroke()),t.setMarkMiddleOrient(e.getMarkMiddleOrient()),t.setMarkProportion(e.getMarkProportion())},registerProperties:function(e,t){EJSS_DRAWING2D.Element.registerProperties(e,t),t.registerProperty("Offset",e.setRelativePosition,e.getRelativePosition),t.registerProperty("MarkEnd",e.setMarkEnd),t.registerProperty("MarkEndWidth",e.setMarkEndWidth),t.registerProperty("MarkEndHeight",e.setMarkEndHeight),t.registerProperty("MarkEndDiameter",e.setMarkEndDiameter),t.registerProperty("MarkEndColor",e.setMarkEndColor),t.registerProperty("MarkEndStroke",e.setMarkEndStroke),t.registerProperty("MarkEndOrient",e.setMarkEndOrient),t.registerProperty("MarkStart",e.setMarkStart),t.registerProperty("MarkStartWidth",e.setMarkStartWidth),t.registerProperty("MarkStartHeight",e.setMarkStartHeight),t.registerProperty("MarkStartDiameter",e.setMarkStartDiameter),t.registerProperty("MarkStartColor",e.setMarkStartColor),t.registerProperty("MarkStartStroke",e.setMarkStartStroke),t.registerProperty("MarkStartOrient",e.setMarkStartOrient),t.registerProperty("MarkMiddle",e.setMarkMiddle),t.registerProperty("MarkMiddleWidth",e.setMarkMiddleWidth),t.registerProperty("MarkMiddleHeight",e.setMarkMiddleHeight),t.registerProperty("MarkMiddleDiameter",e.setMarkMiddleDiameter),t.registerProperty("MarkMiddleColor",e.setMarkMiddleColor),t.registerProperty("MarkMiddleColorSnd",e.setMarkMiddleColorSnd),t.registerProperty("MarkMiddleStroke",e.setMarkMiddleStroke),t.registerProperty("MarkMiddleOrient",e.setMarkMiddleOrient),t.registerProperty("MarkProportion",e.setMarkProportion)}},EJSS_DRAWING2D.arrow=function(e){var t=EJSS_DRAWING2D.element(e),r=.5,n=EJSS_DRAWING2D.Arrow.NONE,i="none",o=12,a=10,s=-1,l="auto",u=EJSS_DRAWING2D.Arrow.ANGLE,g="none",c=12,S=12,d=-1,f="auto",E=EJSS_DRAWING2D.Arrow.NONE,p="none",h="none",m=12,A=10,P=-1,v="auto";return t._23=function(){return"ElementArrow"},t.setMarkProportion=function(e){r!=e&&(r=e,t.setChanged(!0))},t.getMarkProportion=function(){return r},t.setMarkStart=function(e){n="string"==typeof e?EJSS_DRAWING2D.Arrow[e.toUpperCase()]:e},t.getMarkStart=function(){return n},t.setMarkStartColor=function(e){return"string"!=typeof e&&(e=EJSS_TOOLS.DisplayColors.getLineColor(e)),e!=i&&(i=e,t.setChanged(!0)),t},t.getMarkStartColor=function(){return i},t.setMarkStartStroke=function(e){s!=e&&(s=e,t.setChanged(!0))},t.getMarkStartStroke=function(){return s},t.setMarkStartWidth=function(e){o!=e&&(o=e,t.setChanged(!0))},t.getMarkStartWidth=function(){return o},t.setMarkStartHeight=function(e){a!=e&&(a=e,t.setChanged(!0))},t.getMarkStartHeight=function(){return a},t.setMarkStartDiameter=function(e){a==e&&o==e||(a=e,o=e,t.setChanged(!0))},t.getMarkStartOrient=function(){return l},t.setMarkStartOrient=function(e){l!=e&&(l=e,t.setChanged(!0))},t.setMarkEnd=function(e){u="string"==typeof e?EJSS_DRAWING2D.Arrow[e.toUpperCase()]:e},t.getMarkEnd=function(){return u},t.setMarkEndColor=function(e){return"string"!=typeof e&&(e=EJSS_TOOLS.DisplayColors.getLineColor(e)),e!=g&&(g=e,t.setChanged(!0)),t},t.getMarkEndColor=function(){return g},t.setMarkEndStroke=function(e){d!=e&&(d=e,t.setChanged(!0))},t.getMarkEndStroke=function(){return d},t.setMarkEndWidth=function(e){c!=e&&(c=e,t.setChanged(!0))},t.getMarkEndWidth=function(){return c},t.setMarkEndHeight=function(e){S!=e&&(S=e,t.setChanged(!0))},t.getMarkEndHeight=function(){return S},t.setMarkEndDiameter=function(e){S==e&&c==e||(S=e,c=e,t.setChanged(!0))},t.getMarkEndOrient=function(){return f},t.setMarkEndOrient=function(e){f!=e&&(f=e,t.setChanged(!0))},t.setMarkMiddle=function(e){E="string"==typeof e?EJSS_DRAWING2D.Arrow[e.toUpperCase()]:e},t.getMarkMiddle=function(){return E},t.setMarkMiddleColor=function(e){return"string"!=typeof e&&(e=EJSS_TOOLS.DisplayColors.getLineColor(e)),e!=p&&(p=e,t.setChanged(!0)),t},t.getMarkMiddleColor=function(){return p},t.setMarkMiddleStroke=function(e){P!=e&&(P=e,t.setChanged(!0))},t.getMarkMiddleStroke=function(){return P},t.setMarkMiddleColorSnd=function(e){return"string"!=typeof e&&(e=EJSS_TOOLS.DisplayColors.getLineColor(e)),e!=h&&(h=e,t.setChanged(!0)),t},t.getMarkMiddleColorSnd=function(){return h},t.setMarkMiddleWidth=function(e){m!=e&&(m=e,t.setChanged(!0))},t.getMarkMiddleWidth=function(){return m},t.setMarkMiddleHeight=function(e){A!=e&&(A=e,t.setChanged(!0))},t.getMarkMiddleHeight=function(){return A},t.setMarkMiddleDiameter=function(e){A==e&&m==e||(A=e,m=e,t.setChanged(!0))},t.getMarkMiddleOrient=function(){return v},t.setMarkMiddleOrient=function(e){v!=e&&(v=e,t.setChanged(!0))},t.registerProperties=function(e){EJSS_DRAWING2D.Arrow.registerProperties(t,e)},t.copyTo=function(e){EJSS_DRAWING2D.Arrow.copyTo(t,e)},t.setSize([.1,.1]),t.setRelativePosition("SOUTH_WEST"),t},EJSS_DRAWING2D.ArrowSet={},EJSS_DRAWING2D.arrowSet=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Axis={AXIS_VERTICAL:0,AXIS_HORIZONTAL:1,TICKS_UP:2,TICKS_DOWN:3,SCALE_NUM:0,SCALE_LOG:1,registerProperties:function(e,t){EJSS_DRAWING2D.Element.registerProperties(e,t),t.registerProperty("Step",e.setStep,e.getStep),t.registerProperty("TickStep",e.setTickStep,e.getTickStep),t.registerProperty("Ticks",e.setTicks,e.getTicks),t.registerProperty("AutoTicks",e.setAutoTicks,e.getAutoTicks),t.registerProperty("FixedTick",e.setFixedTick,e.getFixedTick),t.registerProperty("Orient",e.setOrient,e.getOrient),t.registerProperty("Scale",e.setScale,e.getScale),t.registerProperty("TicksMode",e.setTicksMode,e.getTicksMode),t.registerProperty("TicksSize",e.setTicksSize,e.getTicksSize),t.registerProperty("AutoStepMin",e.setAutoStepMin,e.getAutoStepMin),t.registerProperty("AutoTicksRange",e.setAutoTicksRange,e.getAutoTicksRange),t.registerProperty("TextPosition",e.setTextPosition,e.getTextPosition),t.registerProperty("ScalePrecision",e.setScalePrecision,e.getScalePrecision),t.registerProperty("Font",e.getFont().setFont),t.registerProperty("FontFamily",e.getFont().setFontFamily),t.registerProperty("FontSize",e.getFont().setFontSize),t.registerProperty("LetterSpacing",e.getFont().setLetterSpacing),t.registerProperty("FontOutlineColor",e.getFont().setOutlineColor),t.registerProperty("FontWeight",e.getFont().setFontWeight),t.registerProperty("FontFillColor",e.getFont().setFillColor),t.registerProperty("Show",e.setShow,e.getShow)}},EJSS_DRAWING2D.axis=function(e){var t=EJSS_DRAWING2D.segment(e),r=!0,n=0,i=20,o=0,a=Number.NaN,s=EJSS_DRAWING2D.Axis.AXIS_VERTICAL,l=[-1,1],u=!1,g=EJSS_DRAWING2D.Axis.SCALE_NUM,c=EJSS_DRAWING2D.Axis.TICKS_UP,S=10,d=1,f=EJSS_DRAWING2D.font(e),E=40,p=[5,10,20],h=!0;return t._23=function(){return"ElementAxis"},t.setShow=function(e){h!=e&&(h=e,t.setChanged(!0))},t.getShow=function(){return h},t.getFont=function(){return f},t.setAutoTicksRange=function(e){p!=e&&(p=e,t.setChanged(!0))},t.getAutoTicksRange=function(){return p},t.setAutoStepMin=function(e){E!=e&&(E=e,t.setChanged(!0))},t.getAutoStepMin=function(){return E},t.setFixedTick=function(e){a!=e&&(a=e,t.setChanged(!0))},t.getFixedTick=function(){return a},t.setAutoTicks=function(e){r!=e&&(r=e,t.setChanged(!0))},t.getAutoTicks=function(){return r},t.setStep=function(e){i!=e&&(i=e,t.setChanged(!0))},t.getStep=function(){return i},t.setTickStep=function(e){o!=e&&(o=e,t.setChanged(!0))},t.getTickStep=function(){return o},t.setTicks=function(e){n!=e&&(n=e,t.setChanged(!0))},t.getTicks=function(){return n},t.setTicksMode=function(e){"string"==typeof e&&(e=EJSS_DRAWING2D.Grid[e.toUpperCase()]),g!=e&&(g=e,t.setChanged(!0))},t.getTicksMode=function(){return g},t.setTextPosition=function(e){"string"==typeof e&&(e=EJSS_DRAWING2D.Axis[e.toUpperCase()]),c!=e&&(c=e,t.setChanged(!0))},t.getTextPosition=function(){return c},t.setOrient=function(e){"string"==typeof e&&(e=EJSS_DRAWING2D.Axis[e.toUpperCase()]),s!=e&&(s=e,t.setChanged(!0))},t.getOrient=function(){return s},t.setScale=function(e){l!=e&&(l=e,t.setChanged(!0))},t.getScale=function(){return l},t.setScalePrecision=function(e){d!=e&&(d=e,t.setChanged(!0))},t.getScalePrecision=function(){return d},t.setTicksSize=function(e){S!=e&&(S=e,t.setChanged(!0))},t.getTicksSize=function(){return S},t.setInvertedScaleY=function(e){u!=e&&(u=e,t.setChanged(!0))},t.getInvertedScaleY=function(){return u},t.registerProperties=function(e){EJSS_DRAWING2D.Axis.registerProperties(t,e)},f.setChangeListener(function(e){t.setChanged(!0)}),t};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.ByteRaster={},EJSS_DRAWING2D.byteRaster=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Canvas={copyTo:function(e,t){EJSS_DRAWING2D.Element.copyTo(e,t),t.setDimensions(e.getDimensions())},registerProperties:function(e,t){EJSS_DRAWING2D.Element.registerProperties(e,t),t.registerProperty("Dimensions",e.setDimensions,e.getDimensions)}},EJSS_DRAWING2D.canvas=function(e){var t=EJSS_DRAWING2D.element(e),r=[];return t._23=function(){return"ElementCanvas"},t.setDimensions=function(e){xMin=e[0],xMax=e[1],yMin=e[2],yMax=e[3],t.setChanged(!0)},t.getDimensions=function(){return[xMin,xMax,yMin,yMax]},t.addDrawable=function(e){r.push(e),t.setChanged(!0)},t.addImageField=function(e,r,n,i,o,a,s,l,u,g){var c=function(){function c(e,t,r){for(var n=[],i=(t-e)/(r-1),o=e,a=0;a<r;a++)n.push(o),o+=i;return n}var S={};return S.imageField=!0,S.data=e||void 0,S.xMin=void 0===r?-5:r,S.xMax=void 0===n?5:n,S.nx=i||128,S.yMin=void 0===o?-5:o,S.yMax=void 0===a?5:a,S.ny=s||128,S.autoscale=l||!0,S.lower=void 0===u?-1:u,S.upper=void 0===g?1:g,S.center=(S.lower+S.upper)/2,S.maskRadius=0,S.xPos=c(S.xMin,S.xMax,S.nx),S.yPos=c(S.yMin,S.yMax,S.ny),S.updateData=function(e){S.data=e||S.data,S.xPos=c(S.xMin,S.xMax,S.nx),S.yPos=c(S.yMin,S.yMax,S.ny),t.setChanged(!0)},S.setThreshold=function(e,r){S.lower=void 0===e?S.lower:e,S.upper=void 0===r?S.upper:r,t.setChanged(!0)},S.setCircularMask=function(e){S.maskRadius=e,t.setChanged(!0)},S}();return t.addDrawable(c),c},t.getDrawables=function(){return r},this.clearObjects=function(){r=[],t.setChanged(!0)},t.registerProperties=function(e){EJSS_DRAWING2D.Canvas.registerProperties(t,e)},t.copyTo=function(e){EJSS_DRAWING2D.Canvas.copyTo(t,e)},t};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.CellLattice={},EJSS_DRAWING2D.cellLattice=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Cursor={},EJSS_DRAWING2D.cursor=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Custom={},EJSS_DRAWING2D.custom=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.DrawingPanel={MOUSE_ENTERED:0,MOUSE_EXITED:1,MOUSE_PRESSED:2,MOUSE_DRAGGED:3,MOUSE_RELEASED:4,GRAPHICS2D_SVG:0,GRAPHICS2D_CANVAS:1,SCALE_NUM:0,SCALE_LOG:1,ENABLED_NONE:0,ENABLED_ANY:1,ENABLED_X:2,ENABLED_Y:3,ENABLED_NO_MOVE:4,registerProperties:function(e,t){e.setController(t),t.registerProperty("AutoScale",e.setAutoScale,e.getAutoScale),t.registerProperty("AutoScaleX",e.setAutoScaleX,e.getAutoScaleX),t.registerProperty("AutoScaleY",e.setAutoScaleY,e.getAutoScaleY),t.registerProperty("InvertedScaleY",e.setInvertedScaleY,e.getInvertedScaleY),t.registerProperty("MinimumX",e.setWorldXMin,e.getWorldXMin),t.registerProperty("MaximumX",e.setWorldXMax,e.getWorldXMax),t.registerProperty("MinimumY",e.setWorldYMin,e.getWorldYMin),t.registerProperty("MaximumY",e.setWorldYMax,e.getWorldYMax),t.registerProperty("Bounds",e.setWorldCoordinates,e.getWorldCoordinates),t.registerProperty("ScaleXType",function(t){e.setTypeScaleX(t),e.scale()},e.getTypeScaleX),t.registerProperty("ScaleYType",function(t){e.setTypeScaleY(t),e.scale()},e.getTypeScaleY),t.registerProperty("MarginX",e.setMarginX,e.getMarginX),t.registerProperty("MarginY",e.setMarginY,e.getMarginY),t.registerProperty("Parent",e.getGraphics().setParent,e.getGraphics().getParent),t.registerProperty("ClassName",e.getGraphics().setClassName),t.registerProperty("Width",function(t){e.getGraphics().setWidth(t)&&e.scale()},e.getGraphics().getBox().width),t.registerProperty("Height",function(t){e.getGraphics().setHeight(t)&&e.scale()},e.getGraphics().getBox().height),t.registerProperty("SquareAspect",e.setSquareAspect),t.registerProperty("GraphicsMode",e.setGraphicsMode),t.registerProperty("Enabled",e.getPanelInteraction().setEnabled),t.registerProperty("StopMoveEvents",e.getPanelInteraction().setStopMoveEvents),t.registerProperty("StopGestures",e.getPanelInteraction().setStopGestures),t.registerProperty("Gutters",e._25),t.registerProperty("GuttersLineColor",e.getGuttersStyle().setLineColor),t.registerProperty("GuttersLineWidth",e.getGuttersStyle().setLineWidth),t.registerProperty("GuttersDrawLines",e.getGuttersStyle().setDrawLines),t.registerProperty("GuttersColor",e.getGuttersStyle().setFillColor),t.registerProperty("GuttersFill",e.getGuttersStyle().setDrawFill),t.registerProperty("GuttersRendering",e.getStyle().setShapeRendering),t.registerProperty("Background",e.getStyle().setFillColor),t.registerProperty("Foreground",e.getStyle().setLineColor),t.registerProperty("LineColor",e.getStyle().setLineColor),t.registerProperty("LineWidth",e.getStyle().setLineWidth),t.registerProperty("DrawLines",e.getStyle().setDrawLines),t.registerProperty("FillColor",e.getStyle().setFillColor),t.registerProperty("DrawFill",e.getStyle().setDrawFill),t.registerProperty("ShapeRendering",e.getStyle().setShapeRendering),t.registerProperty("Visibility",e.getGraphics().getStyle().setVisibility),t.registerProperty("Display",e.getGraphics().getStyle().setDisplay),t.registerProperty("CSS",e.getGraphics().getStyle().setCSS),t.registerProperty("TRMessage",e.getMessageDecoration("TR").setText),t.registerProperty("TLMessage",e.getMessageDecoration("TL").setText),t.registerProperty("BRMessage",e.getMessageDecoration("BR").setText),t.registerProperty("BLMessage",e.getMessageDecoration("BL").setText),t.registerProperty("CoordinatesFormat",e.getCoordinates().setFormat),t.registerProperty("ShowCoordinates",e.setShowCoordinates),t.registerProperty("ShowAreaRectangle",e.setShowAreaRectangle),t.registerProperty("EnabledZooming",e.setEnabledZooming),t.registerProperty("EnabledDragging",e.setEnabledDragging),t.registerProperty("CursorTypeForMove",e.getInteraction().setCursorTypeForMove),t.registerAction("OnDoubleClick",e.getInteraction().getInteractionPoint),t.registerAction("OnMove",e.getInteraction().getInteractionPoint,e.getOnMoveHandler),t.registerAction("OnPress",e.getInteraction().getInteractionPoint,e.getOnPressHandler),t.registerAction("OnDrag",e.getInteraction().getInteractionPoint,e.getOnDragHandler),t.registerAction("OnRelease",e.getInteraction().getInteractionBounds,e.getOnReleaseHandler),t.registerAction("OnResize",e.getInteraction().getInteractionBounds,e.scale),t.registerAction("OnOrientationChange",e.getInteraction().getOrientation,e.scale),t.registerAction("OnZoom",e.getInteraction().getPinchDistance,e.getOnZoomHandler)}},EJSS_DRAWING2D.drawingPanel=function(e,t){var r,n={},i=EJSS_DRAWING2D.style(e),o=[],a=[],s=!1,l=!1,u=!1,g=!1,c=0,S=0,d=[],f=!0,E=!0,p=!1,h=!1,m=1.1,A=[],P=-1,v=1,y=-1,C=1,D={xminPreferred:NaN,xmaxPreferred:NaN,yminPreferred:NaN,ymaxPreferred:NaN,xminMeasured:NaN,xmaxMeasured:NaN,yminMeasured:NaN,ymaxMeasured:NaN,xmargin:0,ymargin:0,xmin:-1,xmax:1,ymin:-1,ymax:1,squareAspect:!1,xorigin:0,yorigin:0,xscale:1,yscale:1},I={left:0,right:0,top:0,bottom:0,visible:!1},R=EJSS_DRAWING2D.style(e+" gutters"),_=!0,T=!0,N=!0,O={propertiesChanged:function(){},invokeAction:function(){}};n.getName=function(){return e},n.getGraphics=function(){return r},n.importGraphics=function(e){return r.importSVG?r.importSVG(e):null},n.getStyle=function(){return i},n.getGraphicsMode=function(){return t},n.getGraphicsModeName=function(){switch(t){case EJSS_DRAWING2D.DrawingPanel.GRAPHICS2D_CANVAS:return"CANVAS";default:case EJSS_DRAWING2D.DrawingPanel.GRAPHICS2D_SVG:return"SVG"}},n.setGraphicsMode=function(n){if("string"==typeof n?(0!=n.indexOf("GRAPHICS2D_")&&(n="GRAPHICS2D_"+n),n=EJSS_DRAWING2D.DrawingPanel[n.toUpperCase()]|EJSS_DRAWING2D.DrawingPanel.GRAPHICS2D_SVG):void 0===n&&(n=EJSS_DRAWING2D.DrawingPanel.GRAPHICS2D_SVG),n!=t){t=n;var i=void 0!==r;if(i){var o=r.getParent(),a=r.getWidth(),l=r.getHeight(),u=r.getEventContext().getAttribute("style"),g=document.getElementById(e);g.parentNode.removeChild(g)}n==EJSS_DRAWING2D.DrawingPanel.GRAPHICS2D_SVG?r=EJSS_GRAPHICS.svgGraphics(e):n==EJSS_DRAWING2D.DrawingPanel.GRAPHICS2D_CANVAS?r=EJSS_GRAPHICS.canvasGraphics(e):console.log("WARNING: setGraphics() - Graphics not supported"),i&&(r.setParent(o),r.setWidth(a),r.setHeight(l),r.getEventContext().setAttribute("style",u),s=!0,w.reload())}},n.getAutoScale=function(){return l||u},n.setAutoScale=function(e){n.setAutoScaleX(e),n.setAutoScaleY(e)},n.setAutoScaleX=function(e){l=e},n.getAutoScaleX=function(){return l},n.setAutoScaleY=function(e){u=e},n.getAutoScaleY=function(){return u},n.setInvertedScaleY=function(e){if(g!=e){g=e,g&&(S=EJSS_DRAWING2D.DrawingPanel.SCALE_NUM);n.reportDecorations("bounds")&&(_=!0)}},n.getInvertedScaleY=function(){return g},n.setTypeScaleX=function(e){"string"==typeof e&&(e=EJSS_DRAWING2D.DrawingPanel[e.toUpperCase()]),c=e},n.getTypeScaleX=function(){return c},n.setTypeScaleY=function(e){"string"==typeof e&&(e=EJSS_DRAWING2D.DrawingPanel[e.toUpperCase()]),(S=e)==EJSS_DRAWING2D.DrawingPanel.SCALE_LOG&&(g=!1)},n.getTypeScaleY=function(){return S},n.setWorldXMin=function(e){e!==D.xminPreferred&&(D.xminPreferred=e)},n.getWorldXMin=function(){return D.xminPreferred},n.setWorldXMax=function(e){e!==D.xmaxPreferred&&(D.xmaxPreferred=e)},n.getWorldXMax=function(){return D.xmaxPreferred},n.setWorldYMin=function(e){e!==D.yminPreferred&&(D.yminPreferred=e)},n.getWorldYMin=function(){return D.yminPreferred},n.setWorldYMax=function(e){e!==D.ymaxPreferred&&(D.ymaxPreferred=e)},n.getWorldYMax=function(){return D.ymaxPreferred},n.setWorldCoordinates=function(e){n.setWorldXMin(e[0]),n.setWorldXMax(e[1]),n.setWorldYMin(e[2]),n.setWorldYMax(e[3])},n.getWorldCoordinates=function(){return[n.getWorldXMin(),n.getWorldXMax(),n.getWorldYMin(),n.getWorldYMax()]},n.getMeasuredCoordinates=function(){return[D.xminMeasured,D.xmaxMeasured,D.yminMeasured,D.ymaxMeasured]},n.getRealWorldCoordinates=function(){return[D.xmin,D.xmax,D.ymin,D.ymax]},n.getRealWorldXMin=function(){return D.xmin},n.getRealWorldXMax=function(){return D.xmax},n.getRealWorldYMin=function(){return D.ymin},n.getRealWorldYMax=function(){return D.ymax},n.setSquareAspect=function(e){e!==D.squareAspect&&(D.squareAspect=e,T=!0)},n.setMarginX=function(e){D.xmargin!=e&&(D.xmargin=e,T=!0)},n.getMarginX=function(){return D.xmargin},n.setMarginY=function(e){D.ymargin!=e&&(D.ymargin=e,T=!0)},n.getMarginY=function(){return D.ymargin},n.setEnabledDragging=function(e){"string"==typeof e?(value=EJSS_DRAWING2D.DrawingPanel[e.toUpperCase()],p="undefined"==typeof value?EJSS_DRAWING2D.DrawingPanel.ENABLED_NONE:value):p=e},n.getEnabledDragging=function(){return p},n.setEnabledZooming=function(e){h=e},n.getEnabledZooming=function(){return h},n.setZoomRate=function(e){m=e},n.getZoomRate=function(){return m},n.setShowCoordinates=function(e){f=e},n.getShowCoordinates=function(){return f},n.setShowAreaRectangle=function(e){E=e},n.getShowAreaRectangle=function(){return E},n.addDecoration=function(e,t,r){return r?EJSS_TOOLS.addToArray(d,e,t):EJSS_TOOLS.addToArray(o,e,t),e.setPanel&&e.setPanel(n),n},n.removeDecoration=function(e){return EJSS_TOOLS.removeFromArray(o,e),EJSS_TOOLS.removeFromArray(d,e),e.setPanel&&e.setPanel(null),n},n.addElement=function(e,t){if(void 0===t)EJSS_TOOLS.addToArray(a,e);else if("object"==typeof t){var r=EJSS_TOOLS.arrayObjectIndexOf(a,t);EJSS_TOOLS.addToArray(a,e,r)}else EJSS_TOOLS.addToArray(a,e,t);e.setPanel(n),e.dataCollected&&A.push(e),s=!0},n.removeElement=function(e){EJSS_TOOLS.removeFromArray(a,e),e.setPanel(null),e.dataCollected&&EJSS_TOOLS.removeFromArray(A,e),s=!0},n.getElements=function(){return a},n.indexOfElement=function(e){return a.indexOf(e)},n._25=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],o=!1;t!==I.left&&(I.left=t,o=!0),r!==I.top&&(I.top=r,o=!0),
n!==I.right&&(I.right=n,o=!0),i!==I.bottom&&(I.bottom=i,o=!0),o&&(I.visible=I.left>0||I.top>0||I.right>0||I.bottom>0,_=!0,T=!0)},n.getGutters=function(){return I},n.getGuttersStyle=function(){return R},n.toPixelAxisY=function(e){return D.yorigin-e-D.yscale*D.ymin},n.toPixelAxisX=function(e){return D.xorigin+e-D.xscale*D.xmin},n._26=function(e,t){var r=void 0!==t?t:c,i=void 0!==t?t:S,o=[];return r==EJSS_DRAWING2D.DrawingPanel.SCALE_LOG?o[0]=n.toPixelLogScale(e[0],D.xorigin,D.xmin,D.xmax,D.xscale):o[0]=D.xorigin+D.xscale*(e[0]-D.xmin),i==EJSS_DRAWING2D.DrawingPanel.SCALE_LOG?o[1]=n.toPixelLogScale(e[1],D.yorigin,D.ymin,D.ymax,D.yscale):o[1]=g?I.top+D.yscale*(D.ymin-e[1]):D.yorigin+D.yscale*(e[1]-D.ymin),o},n.toPixelMod=function(e){var t=[];return t[0]=e[0]*D.xscale,t[1]=e[1]*D.yscale,t},n.toPanelPosition=function(e,t){var r=void 0!==t?t:c,i=void 0!==t?t:S,o=[];return r==EJSS_DRAWING2D.DrawingPanel.SCALE_LOG?o[0]=n.toPanelLogScale(e[0],D.xorigin,D.xmin,D.xmax,D.xscale):o[0]=D.xmin+(e[0]-D.xorigin)/D.xscale,i==EJSS_DRAWING2D.DrawingPanel.SCALE_LOG?o[1]=n.toPanelLogScale(e[1],D.yorigin,D.ymin,D.ymax,D.yscale):o[1]=g?D.ymin-(e[1]-I.top)/D.yscale:D.ymin+(e[1]-D.yorigin)/D.yscale,o},n.toPanelMod=function(e){var t=[];return t[0]=0==D.xscale?0:e[0]/D.xscale,t[1]=0==D.yscale?0:e[1]/D.yscale,t},n.toPixelLogScale=function(e,t,r,n,i){var o=r<=0?1:Math.log(r)/Math.log(10);return t+(n-r)*i/((n<=0?1:Math.log(n)/Math.log(10))-o)*((e<=0?0:Math.log(e)/Math.log(10))-o)},n.toPanelLogScale=function(e,t,r,n,i){var o=r<0?0:Math.log(r)/Math.log(10),a=n<0?0:Math.log(n)/Math.log(10),s=(n-r)*i,l=a-o,u=s/l;return Math.pow(10,o+(e-t)/u)},n.getPixelPositionWorldOrigin=function(){return[D.xorigin,D.yorigin]},n.getInnerRect=function(){var e=n.getRealWorldCoordinates();if(n.getInvertedScaleY())var t=n._26([e[0],e[2]]);else var t=n._26([e[0],e[3]]);var r=n.toPixelMod([e[1]-e[0],e[3]-e[2]]);return{x:t[0],width:Math.abs(r[0]),y:t[1],height:Math.abs(r[1])}},n.scale=function(){T=!0,s=!0},n.touch=function(){T=!0,s=!0;for(var e=0,t=a.length;e<t;e++)a[e].setChanged(!0)},n._27=function(){var e,t,i=!1,o=(D.xmaxMeasured-D.xminMeasured)/2,s=(D.ymaxMeasured-D.yminMeasured)/2,l=D.xminMeasured-Math.abs(o*D.xmargin/100),u=D.xmaxMeasured+Math.abs(o*D.xmargin/100),g=D.yminMeasured-Math.abs(s*D.ymargin/100),c=D.ymaxMeasured+Math.abs(s*D.ymargin/100),S=r.getBox(),d=S.width-(I.left+I.right),f=S.height-(I.bottom+I.top),E=d/(u-l),p=f/(c-g);if(D.squareAspect&&(e=Math.abs(E/p),e>=1?(e=Math.min(e,d),t=(u-l)*(e-1)/2,l-=t,u+=t,E=d/(u-l)):(e=Math.max(e,1/f),t=(c-g)*(1/e-1)/2,g-=t,c+=t,p=f/(c-g))),i=D.xscale!=E||D.yscale!=-p,D.xscale=E,D.yscale=-p,D.xorigin=I.left+.5,D.yorigin=f+I.top+.5,T=!1,D.xmin!==l||D.xmax!==u||D.ymin!==g||D.ymax!==c){D.xmin=l,D.xmax=u,D.ymin=g,D.ymax=c;n.reportDecorations("bounds")&&(_=!0),i=!0}if(i)for(var h=0,m=a.length;h<m;h++)a[h].setMustProject(!0)},n.reportDecorations=function(e){var t,r,n=!1;for(t=0,r=o.length;t<r;t++)n|=o[t].panelChangeListener&&o[t].panelChangeListener("bounds");for(t=0,r=d.length;t<r;t++)d[t].panelChangeListener&&d[t].panelChangeListener("bounds");return n},n._28=function(){var e=Number.MAX_VALUE,t=-Number.MAX_VALUE,r=Number.MAX_VALUE,i=-Number.MAX_VALUE;if(n.getAutoScaleY()||n.getAutoScaleX())for(var o=0,s=a.length;o<s;o++)if(a[o].isMeasured()&&!a[o].isGroup()&&(null==a[o].getGroup()||a[o].getGroup().isMeasured()))if(a[o].isPixelSize()){var l=a[o].getPosition();e=Math.min(e,l[0]),t=Math.max(t,l[0]),r=Math.min(r,l[1]),i=Math.max(i,l[1])}else{var u=a[o].getAbsoluteBounds();e=Math.min(e,u.left),t=Math.max(t,u.right),r=Math.min(r,u.bottom),i=Math.max(i,u.top)}var g=!1;n.getAutoScaleX()?(isNaN(D.xminPreferred)||(e=Math.min(e,D.xminPreferred)),isNaN(D.xmaxPreferred)||(t=Math.max(t,D.xmaxPreferred)),t<=e?(g=D.xminMeasured!=P||D.xmaxMeasured!=v,D.xminMeasured=P,D.xmaxMeasured=v):(g=D.xminMeasured!=e||D.xmaxMeasured!=t,D.xminMeasured=e,D.xmaxMeasured=t)):isNaN(D.xminPreferred)||isNaN(D.xmaxPreferred)?(g=D.xminMeasured!=P||D.xmaxMeasured!=v,D.xminMeasured=P,D.xmaxMeasured=v):(g=D.xminMeasured!=D.xminPreferred||D.xmaxMeasured!=D.xmaxPreferred,D.xminMeasured=D.xminPreferred,D.xmaxMeasured=D.xmaxPreferred);var c=!1;return n.getAutoScaleY()?(isNaN(D.yminPreferred)||(r=Math.min(r,D.yminPreferred)),isNaN(D.ymaxPreferred)||(i=Math.max(i,D.ymaxPreferred)),i<=r?(c=D.yminMeasured!=y||D.ymaxMeasured!=C,D.yminMeasured=y,D.ymaxMeasured=C):(c=D.yminMeasured!=r||D.ymaxMeasured!=i,D.yminMeasured=r,D.ymaxMeasured=i)):isNaN(D.yminPreferred)||isNaN(D.ymaxPreferred)?(c=D.yminMeasured!=y||D.ymaxMeasured!=C,D.yminMeasured=y,D.ymaxMeasured=C):(c=D.yminMeasured!=D.yminPreferred||D.ymaxMeasured!=D.ymaxPreferred,D.yminMeasured=D.yminPreferred,D.ymaxMeasured=D.ymaxPreferred),g||c},n.reset=function(){r.reset()},n.disable=function(){N=!1},n.enable=function(){N=!0},n.render=function(){if(N){var e=!1;(r.setImageData||s)&&(r.reset(),e=!0,s=!1);for(var t=0,i=A.length;t<i;t++)A[t].dataCollected();var l=n._28();(T||l)&&n._27(),(_||e)&&r.drawPanel(n),r.draw(o),r.draw(a,e),(_||e)&&r._24(n),r.draw(d),_=!1;for(var t=0,i=a.length;t<i;t++)a[t].setChanged(!1)}},n.getPanelInteraction=function(){return w},n.getController=function(){return O},n.setController=function(e){O=e},n.getOnMoveHandler=null,n.getOnZoomHandler=function(){if(h){var e=w.getInteractionZoomDelta(),t=n.getWorldCoordinates();(isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3]))&&(t=n.getMeasuredCoordinates());var r=(1-m)*(t[1]-t[0])*e/2,i=(1-m)*(t[3]-t[2])*e/2;n.setWorldCoordinates([t[0]+r,t[1]-r,t[2]+i,t[3]-i])}},n.getOnPressHandler=function(){if(f){var e=w.getInteractionPoint(),t=n.getRealWorldCoordinates();t[0]<e[0]&&t[1]>e[0]&&t[3]>e[1]&&t[2]<e[1]&&(L.setText(e),L.setVisible(!0),L.getController().propertiesChanged("Visible","Text"))}},n.getOnDragHandler=function(){if(f){var e=w.getInteractionPoint(),t=n.getRealWorldCoordinates();t[0]<e[0]&&t[1]>e[0]&&t[3]>e[1]&&t[2]<e[1]&&(L.setText(e),L.setVisible(!0),L.getController().propertiesChanged("Visible","Text"))}if(E){var r=w.getInteractionBounds();r.length>0&&c==EJSS_DRAWING2D.DrawingPanel.SCALE_NUM&&S==EJSS_DRAWING2D.DrawingPanel.SCALE_NUM?(M.setBounds(r),M.setVisible(!0),M.getController().propertiesChanged("Position","X","Y","Size","SizeX","SizeY","Visible")):(M.setVisible(!1),M.getController().propertiesChanged("Visible"))}if(0!=p&&4!=p){var i=w.getInteractionDistance();if(i.length>0&&c==EJSS_DRAWING2D.DrawingPanel.SCALE_NUM&&S==EJSS_DRAWING2D.DrawingPanel.SCALE_NUM){var t=n.getWorldCoordinates();(isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3]))&&(t=n.getMeasuredCoordinates()),1==p?n.setWorldCoordinates([t[0]+i[0],t[1]+i[0],t[2]+i[1],t[3]+i[1]]):2==p?n.setWorldCoordinates([t[0]+i[0],t[1]+i[0],t[2],t[3]]):n.setWorldCoordinates([t[0],t[1],t[2]+i[1],t[3]+i[1]])}}},n.getOnReleaseHandler=function(){f&&(L.setVisible(!1),L.getController().propertiesChanged("Visible")),E&&(M.setVisible(!1),M.getController().propertiesChanged("Visible"))},n.getMessageDecoration=function(e){switch(e){case"TL":return b;case"BR":return x;case"BL":return G}return J},n.getCoordinates=function(){return L},n.getInteraction=function(){return w},n.registerProperties=function(e){EJSS_DRAWING2D.DrawingPanel.registerProperties(n,e)},n.serialize=function(){return{mStyle:i.serialize(),mTopDecorations:d,mBottomDecorations:o,mElements:a,mCollectersList:A,mAutoScaleX:l,mAutoScaleY:u,mInvertedScaleY:g,mTypeScaleX:c,mTypeScaleY:S,mShowCoordinates:f,xmindef:P,xmaxdef:v,ymindef:y,ymaxdef:C,mWorld:D,mGutters:I,mGuttersStyle:R.serialize()}},n.unserialize=function(e){i.unserialize(e.mStyle),l=e.mAutoScaleX,u=e.mAutoScaleY,g=e.mInvertedScaleY,c=e.mTypeScaleX,S=e.mTypeScaleY,f=e.mShowCoordinates,P=e.xmindef,v=e.xmaxdef,y=e.ymindef,C=e.ymaxdef,D=e.mWorld,I=e.mGutters,R.unserialize(e.mGuttersStyle),_=!0},n.setGraphicsMode(t),i.setLineColor("black"),i.setFillColor("rgb(239,239,255)"),i.setChangeListener(function(e){_=!0}),R.setChangeListener(function(e){_=!0});var M=EJSS_DRAWING2D.shape(e+"__cursorBox__");M.setShapeType(EJSS_DRAWING2D.Shape.RECTANGLE),M.getStyle().setDrawFill(!1),M.getStyle().setLineColor("black"),M.setRelativePosition("CENTER"),M.setVisible(!1),n.addDecoration(M,0,!0);var b=EJSS_DRAWING2D.text(e+"__tlmessage__");b.setRelativePosition("NORTH_WEST"),b.getStyle().setDrawLines(!0),b.getStyle().setDrawFill(!0),b.getStyle().setFillColor("yellow"),b.getStyle().setLineColor("black"),b.getFont().setFontSize(12),b.setPosition([D.xmin,D.ymax]),b.setFramed(!0),b.panelChangeListener=function(e){"bounds"==e&&(n.getInvertedScaleY()?b.setPosition([D.xmin,D.ymin]):b.setPosition([D.xmin,D.ymax]))},n.addDecoration(b,0,!0);var G=EJSS_DRAWING2D.text(e+"__blmessage__");G.setRelativePosition("SOUTH_WEST"),G.getStyle().setDrawLines(!0),G.getStyle().setDrawFill(!0),G.getStyle().setFillColor("yellow"),G.getStyle().setLineColor("black"),G.getFont().setFontSize(12),G.setPosition([D.xmin,D.ymin]),G.setFramed(!0),G.panelChangeListener=function(e){"bounds"==e&&(n.getInvertedScaleY()?G.setPosition([D.xmin,D.ymax]):G.setPosition([D.xmin,D.ymin]))},n.addDecoration(G,0,!0);var x=EJSS_DRAWING2D.text(e+"__brmessage__");x.setRelativePosition("SOUTH_EAST"),x.getStyle().setDrawLines(!0),x.getStyle().setDrawFill(!0),x.getStyle().setFillColor("yellow"),x.getStyle().setLineColor("black"),x.getFont().setFontSize(12),x.setPosition([D.xmax,D.ymin]),x.setFramed(!0),x.panelChangeListener=function(e){"bounds"==e&&(n.getInvertedScaleY()?x.setPosition([D.xmax,D.ymax]):x.setPosition([D.xmax,D.ymin]))},n.addDecoration(x,0,!0);var J=EJSS_DRAWING2D.text(e+"__trmessage__");J.setRelativePosition("NORTH_EAST"),J.getStyle().setDrawLines(!0),J.getStyle().setDrawFill(!0),J.getStyle().setFillColor("yellow"),J.getStyle().setLineColor("black"),J.getFont().setFontSize(12),J.setPosition([D.xmax,D.ymax]),J.setFramed(!0),J.panelChangeListener=function(e){"bounds"==e&&(n.getInvertedScaleY()?J.setPosition([D.xmax,D.ymin]):J.setPosition([D.xmax,D.ymax]))},n.addDecoration(J,0,!0);var L=EJSS_DRAWING2D.infoText(e+"__coor__");L.setRelativePosition("SOUTH_WEST"),L.getFont().setFontSize(12),L.getStyle().setFillColor("yellow"),L.setPosition([D.xmin,D.ymin]),L.setFormat("x:0.##,y:0.##"),L.setFramed(!0),L.setVisible(!1),L.panelChangeListener=function(e){"bounds"==e&&(n.getInvertedScaleY()?L.setPosition([D.xmin,D.ymax]):L.setPosition([D.xmin,D.ymin]))},n.addDecoration(L,0,!0),n.getGuttersStyle().setLineColor("black"),n.getGuttersStyle().setFillColor("rgb(239,239,255)"),n.getGuttersStyle().setShapeRendering("RENDER_CRISPEDGES");var w=EJSS_DRAWING2D.panelInteraction(n);return r.getEventContext().addEventListener("dblclick",function(e){return e.preventDefault(),e.stopPropagation(),!1},!0),n};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Element={CENTER:0,NORTH:1,SOUTH:2,EAST:3,WEST:4,NORTH_EAST:5,NORTH_WEST:6,SOUTH_EAST:7,SOUTH_WEST:8,registerProperties:function(e,t){var r=EJSS_DRAWING2D.PanelInteraction.TARGET_POSITION,n=EJSS_DRAWING2D.PanelInteraction.TARGET_SIZE,i=e.getStyle();e.setController(t),t.registerProperty("Parent",e.setParent,e.getParent),t.registerProperty("X",e.setX,e.getX),t.registerProperty("Y",e.setY,e.getY),t.registerProperty("Position",e.setPosition,e.getPosition),t.registerProperty("PixelPosition",e.setPixelPosition,e.getPixelPosition),t.registerProperty("Diameter",function(t){e.setSize([t,t])}),t.registerProperty("Radius",function(t){e.setSize([2*t,2*t])}),t.registerProperty("SizeX",e.setSizeX,e.getSizeX),t.registerProperty("SizeY",e.setSizeY,e.getSizeY),t.registerProperty("Size",e.setSize,e.getSize),t.registerProperty("PixelSize",e.setPixelSize,e.getPixelSize),t.registerProperty("Bounds",e.setBounds,e.getBounds),t.registerProperty("RelativePosition",e.setRelativePosition,e.getRelativePosition),t.registerProperty("Visibility",e.setVisible,e.isVisible),t.registerProperty("Measured",e.setMeasured,e.isMeasured),t.registerProperty("Transformation",e.setTransformation),t.registerProperty("LineColor",i.setLineColor,i.getLineColor),t.registerProperty("LineWidth",i.setLineWidth,i.getLineWidth),t.registerProperty("DrawLines",i.setDrawLines,i.getDrawLines),t.registerProperty("FillColor",i.setFillColor,i.getFillColor),t.registerProperty("DrawFill",i.setDrawFill,i.getDrawFill),t.registerProperty("ShapeRendering",i.setShapeRendering,i.getShapeRendering),t.registerProperty("Attributes",i.setAttributes,i.getAttributes),t.registerProperty("EnabledPosition",function(t){e.getInteractionTarget(r).setMotionEnabled(t)}),t.registerProperty("MovesGroup",function(t){e.getInteractionTarget(r).setAffectsGroup(t)}),t.registerProperty("EnabledSize",function(t){e.getInteractionTarget(n).setMotionEnabled(t)}),t.registerProperty("ResizesGroup",function(t){e.getInteractionTarget(n).setAffectsGroup(t)}),t.registerProperty("Sensitivity",function(t){e.getInteractionTarget(r).setSensitivity(t),e.getInteractionTarget(n).setSensitivity(t)}),t.registerAction("OnEnter",e.getOnEnterInformation),t.registerAction("OnExit",e.getOnExitInformation),t.registerAction("OnPress",e.getOnPressInformation),t.registerAction("OnDrag",e.getOnDragInformation),t.registerAction("OnRelease",e.getOnReleaseInformation)},copyTo:function(e,t){var r=EJSS_DRAWING2D.InteractionTarget,n=EJSS_DRAWING2D.PanelInteraction.TARGET_POSITION,i=EJSS_DRAWING2D.PanelInteraction.TARGET_SIZE;EJSS_DRAWING2D.Style.copyTo(e.getStyle(),t.getStyle()),t.setVisible(e.isVisible()),t.setMeasured(e.isMeasured()),t.setPosition(e.getPosition()),t.setPixelPosition(e.isPixelPosition()),t.setSize(e.getSize()),t.setPixelSize(e.isPixelSize()),t.setTransformation(e.getTransformation()),t.setRelativePosition(e.getRelativePosition()),r.copyTo(e.getInteractionTarget(n),t.getInteractionTarget(n)),r.copyTo(e.getInteractionTarget(i),t.getInteractionTarget(i)),t.setParent(e.getParent(),e)},getRelativePositionOffset:function(e,t,r,n){var i=0,o=0;switch(e){default:case EJSS_DRAWING2D.Element.CENTER:i=0,o=0;break;case EJSS_DRAWING2D.Element.NORTH:i=0,o=-r/2;break;case EJSS_DRAWING2D.Element.SOUTH:i=0,o=r/2;break;case EJSS_DRAWING2D.Element.EAST:i=-t/2,o=0;break;case EJSS_DRAWING2D.Element.WEST:i=t/2,o=0;break;case EJSS_DRAWING2D.Element.NORTH_EAST:i=-t/2,o=-r/2;break;case EJSS_DRAWING2D.Element.NORTH_WEST:i=t/2,o=-r/2;break;case EJSS_DRAWING2D.Element.SOUTH_EAST:i=-t/2,o=r/2;break;case EJSS_DRAWING2D.Element.SOUTH_WEST:i=t/2,o=r/2}return void 0!==n&&n&&(o=-o),[i,o]},getSWRelativePositionOffset:function(e,t,r,n){var i=0,o=0;switch(e){default:case EJSS_DRAWING2D.Element.CENTER:i=-t/2,o=r/2;break;case EJSS_DRAWING2D.Element.NORTH:i=-t/2,o=r;break;case EJSS_DRAWING2D.Element.SOUTH:i=-t/2,o=0;break;case EJSS_DRAWING2D.Element.EAST:i=-t,o=r/2;break;case EJSS_DRAWING2D.Element.WEST:i=0,o=r/2;break;case EJSS_DRAWING2D.Element.NORTH_EAST:i=-t,o=r;break;case EJSS_DRAWING2D.Element.NORTH_WEST:i=0,o=r;break;case EJSS_DRAWING2D.Element.SOUTH_EAST:i=-t,o=0;break;case EJSS_DRAWING2D.Element.SOUTH_WEST:i=0,o=0}return void 0!==n&&n&&(o=-o),[i,o]}},EJSS_DRAWING2D.element=function(e){var t={},r=EJSS_DRAWING2D.Element,n=EJSS_DRAWING2D.PanelInteraction,i=EJSS_DRAWING2D.style(e),o=!0,a=!0,s=r.CENTER,l=0,u=0,g=!1,c=1,S=1,d=!1,f=0,E={positionTarget:EJSS_DRAWING2D.interactionTarget(t,n.TARGET_POSITION,r.CENTER),sizeTarget:EJSS_DRAWING2D.interactionTarget(t,n.TARGET_SIZE,r.NORTH_EAST)},p=null,h=null,m=null,A=-1,P=[],v=[],y=!0,C=!0,D={propertiesChanged:function(){},invokeAction:function(){}},I=null;return t.getName=function(){return e},t.setParent=function(e,r){e.render?(t.setGroup(null),e.addElement(t),t.setPanel(e)):"ElementGroup"==e._23()?(t.setGroup(e),t.getGroupPanel().addElement(t,r),t.setPanel(t.getGroupPanel())):console.log("WARNING: setParent() - Parent not valid : "+e.getName())},t.getParent=function(){return null!==h?t.getGroup():t.getPanel()},t.isGroup=function(){return!1},t.getStyle=function(){return i},t.setCustomObject=function(e){I=e},t.getCustomObject=function(){return I},t.setX=function(e,t){l!=e&&(l=e,C=!0)},t.getX=function(){return l},t.setY=function(e){u!=e&&(u=e,C=!0)},t.getY=function(){return u},t.setPosition=function(e){t.setX(e[0]),t.setY(e[1])},t.getPosition=function(){return[l,u]},t.setPixelPosition=function(e){g!=e&&(g=e,C=!0)},t.isPixelPosition=function(){return g},t.setSizeX=function(e){c!=e&&(c=e,C=!0)},t.getSizeX=function(){return c},t.setSizeY=function(e){S!=e&&(S=e,C=!0)},t.getSizeY=function(){return S},t.setSize=function(e){t.setSizeX(e[0]),t.setSizeY(e[1])},t.getSize=function(){return[t.getSizeX(),t.getSizeY()]},t.setPixelSize=function(e){d!=e&&(d=e,C=!0)},t.isPixelSize=function(){return d},t.setBounds=function(e){var r,n,i,o;e.left?(r=e.left,n=e.right,i=e.top,o=e.bottom):(r=e[0],n=e[1],i=e[2],o=e[3]);var a=n-r,s=o-i,l=t.getRelativePositionOffset(a,s),u=a/2,g=s/2,c=r+u-l[0],S=i+g-l[1];t.setX(c),t.setY(S),t.setSizeX(a),t.setSizeY(s)},t.getBounds=function(){var e=d?p.toPanelMod([c,-S]):[c,S],r=e[0]/2,n=e[1]/2,i=t.getRelativePositionOffset(e[0],e[1]);return{left:l+i[0]-r,right:l+i[0]+r,top:u+i[1]+n,bottom:u+i[1]-n}},t.getAbsoluteBounds=function(e){var r=t.getBounds(),n=t.toGroupSpace([r.left,r.top],e),i=t.toGroupSpace([r.right,r.bottom],e);return{left:n[0],top:n[1],right:i[0],bottom:i[1]}},t.setRelativePosition=function(e){"string"==typeof e&&(e=r[e.toUpperCase()]),s!=e&&(s=e,C=!0)},t.getRelativePosition=function(){return s},t.getRelativePositionOffset=function(e,t){var n,i;Array.isArray(e)?(n=e[0],i=e[1]):(n=e,i=t);var o=!!p.getInvertedScaleY&&p.getInvertedScaleY();return r.getRelativePositionOffset(s,n,i,o)},t.setVisible=function(e){e!=o&&(o=e,C=!0)},t.isVisible=function(){return o},t.isGroupVisible=function(){for(var e=h;void 0!==e&&null!==e;){if(!e.isVisible())return!1;e=e.getGroup()}return o},t.setMeasured=function(e){a=e},t.isMeasured=function(){return a},t.setTransformation=function(e){void 0===e||null===e?f=0:Array.isArray(e)&&e.length>5?EJSS_TOOLS.compareArrays(f,e)||(f=e,C=!0):f!=e&&(f=e,C=!0)},t.getTransformation=function(){return f},t.getInfo=function(){return"x="+l.toFixed(2)+" y="+u.toFixed(2)},t.setPanel=function(e){p=e,y=!0},t.getPanel=function(){return p},t.getGroupPanel=function(){for(var e=t;e.getGroup();)e=e.getGroup();return e.getPanel()},t.setGroup=function(e){h=e,C=!0},t.getGroup=function(){return h},t.setSet=function(e,t){m=e,A=t},t.getSet=function(){return m},t.getSetIndex=function(){return A},t.isChanged=function(){return C},t.setChanged=function(e){C=e},t.isGroupChanged=function(){for(var e=t.getGroup();void 0!==e&&null!==e;){if(e.isChanged())return!0;e=e.getGroup()}return!1},t.setMustProject=function(e){y=e},t.isMustProject=function(){return y},t.getPixelPosition=function(e){return(t.isChanged()||t.isGroupChanged()||t.isMustProject()||e)&&(P=t.getPixelPositionOf(l,u,e),v=t.getPixelSizeOf(c,S),t.setMustProject(e)),P},t.getPixelSizes=function(e){return(t.isChanged()||t.isGroupChanged()||t.isMustProject())&&(P=t.getPixelPositionOf(l,u,e),v=t.getPixelSizeOf(c,S),t.setMustProject(e)),v},t.getAbsoluteSize=function(){var e=d?p.toPanelMod([c,-S]):[c,S];return t.toGroupSpaceMod(e)},t.getAbsolutePosition=function(e){var r;return r=g?null===h?p.toPanelPosition([l,u]):p.toPanelPosition([l,u],EJSS_DRAWING2D.DrawingPanel.SCALE_NUM):[l,u],t.toGroupSpace(r,e)},t.setAbsolutePosition=function(e){g?console.log("setAbsolutePosition not supported!"):t.setPosition(t.toElementSpace(e))},t.setAbsoluteX=function(e){g?console.log("setAbsoluteX not supported!"):t.setX(t.toElementSpace([e,0])[0])},t.setAbsoluteY=function(e){g?console.log("setAbsoluteY not supported!"):t.setY(t.toElementSpace([0,e])[1])},t.getPixelSizeOf=function(e,r){return d?[e,-r]:t.getGroupPanel().toPixelMod(t.toGroupSpaceMod([e,r]))},t.getPixelPositionOf=function(e,r,n){return g?[t.getGroupPanel().toPixelAxisX(e),t.getGroupPanel().toPixelAxisY(r)]:null===h?t.getGroupPanel()._26(t.toGroupSpace([e,r])):t.getGroupPanel()._26(t.toGroupSpace([e,r],n),EJSS_DRAWING2D.DrawingPanel.SCALE_NUM)},t.toGroupSpaceMod=function(e){for(var t=h;void 0!==t&&null!==t;)e[0]*=t.getSizeX(),e[1]*=t.getSizeY(),t=t.getGroup();return e},t.toGroupSpace=function(e,t){for(var r=h;void 0!==r&&null!==r;)e[0]*=r.getSizeX(),e[1]*=r.getSizeY(),e[0]+=r.getX(),e[1]+=r.getY(),r=r.getGroup();if(t)for(r=h;void 0!==r&&null!==r;){var n=r.getTransformation();if(Array.isArray(n))e[0]=matrix.a*e[0]+matrix.c*e[1]+matrix.e,e[1]=matrix.b*e[0]+matrix.d*e[1]+matrix.f;else if("number"==typeof n){var i=r.getAbsolutePosition();e=EJSS_TOOLS.Mathematics.rotate(i,e,-n)}r=r.getGroup()}return e},t.toElementSpace=function(e){for(var t=[],r=h;void 0!==r&&null!==r;)t.push(r),r=r.getGroup();t=t.reverse();for(var n=t.length,i=0;i<n;i++){var r=t[i];e[0]-=r.getX(),e[1]-=r.getY(),0==r.getSizeX()?e[0]=0:e[0]/=r.getSizeX(),0==r.getSizeY()?e[1]=0:e[1]/=r.getSizeY()}return e},t.getController=function(){return D},t.setController=function(e){D=e},t.getInteractionTarget=function(e){switch(e){case n.TARGET_POSITION:return E.positionTarget;case n.TARGET_SIZE:return E.sizeTarget}return null},t.getInteractionTargets=function(){return[E.positionTarget,E.sizeTarget]},t.getInteractionInformation=function(){return{info:t.getPosition(),element:t,point:t.getGroupPanel().getPanelInteraction().getInteractionPoint()}},t.getOnEnterInformation=function(){var e=t.getInteractionInformation();return e.action="OnEnter",e},t.getOnExitInformation=function(){var e=t.getInteractionInformation();return e.action="OnExit",e},t.getOnPressInformation=function(){var e=t.getInteractionInformation();return e.action="OnPress",e},t.getOnDragInformation=function(){var e=t.getInteractionInformation();return e.action="OnDrag",e},t.getOnReleaseInformation=function(){var e=t.getInteractionInformation();return e.action="OnRelease",e},t.registerProperties=function(e){EJSS_DRAWING2D.Element.registerProperties(t,e)},t.copyTo=function(e){EJSS_DRAWING2D.Element.copyTo(t,e)},t.serialize=function(){return{mStyle:i.serialize(),mVisible:o,mMeasured:a,mRelativePosition:s,mX:l,mY:u,mPixelPosition:g,mSizeX:c,mSizeY:S,mPixelSize:d,mTransformation:f,mInteraction:{},mPanel:p?p.getName():p,mGroup:h?h.getName():h,mSet:m?m.getName():m,mIndexInSet:A,mProjectedPosition:P,mProjectedSize:v}},t.unserialize=function(e){i.unserialize(e.mStyle),o=e.mVisible,a=e.mMeasured,s=e.mRelativePosition,l=e.mX,u=e.mY,g=e.mPixelPosition,c=e.mSizeX,S=e.mSizeY,d=e.mPixelSize,f=e.mTransformation,A=e.mIndexInSet,P=e.mProjectedPosition,v=e.mProjectedSize,C=!0},i.setChangeListener(function(e){C=!0}),t};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.ElementSet={registerProperties:function(e,t){var r=EJSS_DRAWING2D.PanelInteraction.TARGET_POSITION,n=EJSS_DRAWING2D.PanelInteraction.TARGET_SIZE;e.setController(t),e.setToEach(function(e,t){e.setController(t)},t),t.registerProperty("Parent",function(t){e.setParent(t),e.setToEach(function(e,t){e.setParent(t)},e)}),t.registerProperty("NumberOfElements",e.setNumberOfElements),t.registerProperty("ElementInteracted",e.setElementInteracted,e.getElementInteracted),t.registerProperty("X",function(t){e.setToEach(function(e,t){e.setX(t)},t)},function(){return e.getFromEach(function(e){return e.getX()})}),t.registerProperty("Y",function(t){e.setToEach(function(e,t){e.setY(t)},t)},function(){return e.getFromEach(function(e){return e.getY()})}),t.registerProperty("Position",function(t){e.setToEach(function(e,t){e.setPosition(t)},t)},function(){return e.getFromEach(function(e){return e.getPosition()})}),t.registerProperty("PixelPosition",function(t){e.setToEach(function(e,t){e.setPixelPosition(t)},t)}),t.registerProperty("Diameter",function(t){e.setToEach(function(e,t){e.setSize([t,t])},t)}),t.registerProperty("Radius",function(t){e.setToEach(function(e,t){e.setSize([2*t,2*t])},t)}),t.registerProperty("SizeX",function(t){e.setToEach(function(e,t){e.setSizeX(t)},t)},function(){return e.getFromEach(function(e){return e.getSizeX()})}),t.registerProperty("SizeY",function(t){e.setToEach(function(e,t){e.setSizeY(t)},t)},function(){return e.getFromEach(function(e){return e.getSizeY()})}),t.registerProperty("Size",function(t){e.setToEach(function(e,t){e.setSize(t)},t)},function(){return e.getFromEach(function(e){return e.getSize()})}),t.registerProperty("PixelSize",function(t){e.setToEach(function(e,t){e.setPixelSize(t)},t)}),t.registerProperty("Bounds",function(t){var r=function(e,t){e.setX(t[0]),e.setY(t[2]),e.setSizeX(t[1]-t[0]),e.setSizeY(t[3]-t[2])};e.setToEach(r,t)},function(){var t=function(e){return[e.getX(),e.getX()+e.getSizeX(),e.getY(),e.getY()+e.getSizeY()]};return e.getFromEach(t)}),t.registerProperty("Visibility",function(t){e.setToEach(function(e,t){e.setVisible(t)},t)}),t.registerProperty("Measured",function(t){e.setToEach(function(e,t){e.setMeasured(t)},t)}),t.registerProperty("Transformation",function(t){e.setToEach(function(e,t){e.setTransformation(t)},t)}),t.registerProperty("RelativePosition",function(t){e.setToEach(function(e,t){e.setRelativePosition(t)},t)}),t.registerProperty("LineColor",function(t){e.setToEach(function(e,t){e.getStyle().setLineColor(t)},t)}),t.registerProperty("LineWidth",function(t){e.setToEach(function(e,t){e.getStyle().setLineWidth(t)},t)}),t.registerProperty("DrawLines",function(t){e.setToEach(function(e,t){e.getStyle().setDrawLines(t)},t)}),t.registerProperty("FillColor",function(t){e.setToEach(function(e,t){e.getStyle().setFillColor(t)},t)}),t.registerProperty("DrawFill",function(t){e.setToEach(function(e,t){e.getStyle().setDrawFill(t)},t)}),t.registerProperty("Attributes",function(t){e.setToEach(function(e,t){e.getStyle().setAttributes(t)},t)}),t.registerProperty("ShapeRendering",function(t){e.setToEach(function(e,t){e.getStyle().setShapeRendering(t)},t)}),t.registerProperty("EnabledPosition",function(t){e.setToEach(function(e,t){e.getInteractionTarget(r).setMotionEnabled(t)},t)}),t.registerProperty("MovesGroup",function(t){e.setToEach(function(e,t){e.getInteractionTarget(r).setAffectsGroup(t)},t)}),t.registerProperty("EnabledSize",function(t){e.setToEach(function(e,t){e.getInteractionTarget(n).setMotionEnabled(t)},t)}),t.registerProperty("ResizesGroup",function(t){e.setToEach(function(e,t){e.getInteractionTarget(n).setAffectsGroup(t)},t)}),t.registerProperty("Sensitivity",function(t){e.setToEach(function(e,t){e.getInteractionTarget(r).setSensitivity(t),e.getInteractionTarget(n).setSensitivity(t)},t)});var i=function(){var r=e.getGroupPanel(),n=r.getPanelInteraction().getIndexElement(),i=r.getElements()[n],o=i.getSetIndex();return e.setElementInteracted(o),t.propertiesChanged("ElementInteracted"),{index:o,position:i.getPosition()}};t.registerAction("OnEnter",i),t.registerAction("OnExit",i),t.registerAction("OnPress",i),t.registerAction("OnDrag",i),t.registerAction("OnRelease",i)}},EJSS_DRAWING2D.elementSet=function(e,t){function r(t){var r=n.getName?n.getName():"unnamed";t=Math.max(1,t);var i=o.length-t;if(i>0){l=o.splice(t,i);for(var a=0;a<l.length;a++){var s=l[a].getPanel();s&&s.removeElement(l[a])}}else if(i<0){l=[];for(var u=n.getController(),g=o[o.length-1],c=o.length;c<t;c++){var S=e(r+"["+c+"]");S.setSet(n,c),g.copyTo(S),S.setController(u),o.push(S)}}}var n=EJSS_DRAWING2D.group(t),i=EJSS_DRAWING2D.ElementSet,o=[],a=!1,s=-1,l=[];n.setNumberOfElements=function(e){a=!0,r(e)},n.getElements=function(){return o},n.getElement=function(e){return o[e]},n.getLastElements=function(){var e=l.slice();return l=[],e},n.setElementInteracted=function(e){s=e},n.getElementInteracted=function(){return s};var u=n.setPanel;n.setPanel=function(e){u(e);for(var t=0,r=o.length;t<r;t++)o[t].setPanel(e)},n.setToEach=function(e,t){if(Array.isArray(t)){a||o.length<t.length&&r(t.length);for(var n=0,i=Math.min(o.length,t.length);n<i;n++)e(o[n],t[n])}else for(var n=0,i=o.length;n<i;n++)e(o[n],t)},n.getFromEach=function(e){for(var t=[],r=0,n=o.length;r<n;r++)t[r]=e(o[r]);return t},n.registerProperties=function(e){i.registerProperties(n,e)};var g=e(t+"[0]");return g.setController(n.getController()),g.setSet(n,0),o.push(g),n};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Grid={SCALE_NUM:0,SCALE_LOG:1,registerProperties:function(e,t){EJSS_DRAWING2D.Element.registerProperties(e,t),t.registerProperty("StepX",e.setStepX,e.getStepX),t.registerProperty("StepY",e.setStepY,e.getStepY),t.registerProperty("TicksX",e.setTicksX,e.getTicksX),t.registerProperty("TicksY",e.setTicksY,e.getTicksY),t.registerProperty("TickStepX",e.setTickStepX,e.getTickStepX),t.registerProperty("TickStepY",e.setTickStepY,e.getTickStepY),t.registerProperty("TicksXMode",e.setTicksXMode,e.getTicksXMode),t.registerProperty("TicksYMode",e.setTicksYMode,e.getTicksYMode),t.registerProperty("ShowX",e.setShowX,e.getShowX),t.registerProperty("ShowY",e.setShowY,e.getShowY),t.registerProperty("FixedTickX",e.setFixedTickX,e.getFixedTickX),t.registerProperty("FixedTickY",e.setFixedTickY,e.getFixedTickY),t.registerProperty("ScaleX",e.setScaleX,e.getScaleX),t.registerProperty("ScaleY",e.setScaleY,e.getScaleY),t.registerProperty("ScalePrecisionX",e.setScalePrecisionX,e.getScalePrecisionX),t.registerProperty("ScalePrecisionY",e.setScalePrecisionY,e.getScalePrecisionY),t.registerProperty("AutoTicksX",e.setAutoTicksX,e.getAutoTicksX),t.registerProperty("AutoTicksY",e.setAutoTicksY,e.getAutoTicksY),t.registerProperty("AutoStepXMin",e.setAutoStepXMin,e.getAutoStepXMin),t.registerProperty("AutoStepYMin",e.setAutoStepYMin,e.getAutoStepYMin),t.registerProperty("AutoTicksXRange",e.setAutoTicksXRange,e.getAutoTicksXRange),t.registerProperty("AutoTicksYRange",e.setAutoTicksYRange,e.getAutoTicksYRange),t.registerProperty("LineColorX",e.setLineColorX,e.getLineColorX),t.registerProperty("LineWidthX",e.setLineWidthX,e.getLineWidthX),t.registerProperty("ShapeRenderingX",e.setShapeRenderingX,e.getShapeRenderingX),t.registerProperty("LineColorY",e.setLineColorY,e.getLineColorY),t.registerProperty("LineWidthY",e.setLineWidthY,e.getLineWidthY),t.registerProperty("ShapeRenderingY",e.setShapeRenderingY,e.getShapeRenderingY)}},EJSS_DRAWING2D.grid=function(e){var t=EJSS_DRAWING2D.element(e),r=!0,n=!0,i=0,o=0,a=0,s=0,l=0,u=0,g=!0,c=!0,S=Number.NaN,d=Number.NaN,f=[-1,1],E=[-1,1],p=1,h=1,m=EJSS_DRAWING2D.Grid.SCALE_NUM,A=EJSS_DRAWING2D.Grid.SCALE_NUM,P=40,v=40,y=[5,10,20],C=[5,10,20],D="black",I=.5,R=EJSS_DRAWING2D.Style.RENDER_AUTO,_="black",T=.5,N=EJSS_DRAWING2D.Style.RENDER_AUTO;return t._23=function(){return"ElementGrid"},t.setAutoTicksRangeY=function(e){C!=e&&(C=e,t.setChanged(!0))},t.getAutoTicksRangeY=function(){return C},t.setAutoTicksRangeX=function(e){y!=e&&(y=e,t.setChanged(!0))},t.getAutoTicksRangeX=function(){return y},t.setAutoStepYMin=function(e){v!=e&&(v=e,t.setChanged(!0))},t.getAutoStepYMin=function(){return v},t.setAutoStepXMin=function(e){P!=e&&(P=e,t.setChanged(!0))},t.getAutoStepXMin=function(){return P},t.setScaleY=function(e){E!=e&&(E=e,t.setChanged(!0))},t.getScaleY=function(){return E},t.setScaleX=function(e){f!=e&&(f=e,t.setChanged(!0))},t.getScaleX=function(){return f},t.setScalePrecisionX=function(e){p!=e&&(p=e,t.setChanged(!0))},t.getScalePrecisionX=function(){return p},t.setScalePrecisionY=function(e){h!=e&&(h=e,t.setChanged(!0))},t.getScalePrecisionY=function(){return h},t.setFixedTickX=function(e){S!=e&&(S=e,t.setChanged(!0))},t.getFixedTickX=function(){return S},t.setFixedTickY=function(e){d!=e&&(d=e,t.setChanged(!0))},t.getFixedTickY=function(){return d},t.setAutoTicksX=function(e){r!=e&&(r=e,t.setChanged(!0))},t.getAutoTicksX=function(){return r},t.setAutoTicksY=function(e){n!=e&&(n=e,t.setChanged(!0))},t.getAutoTicksY=function(){return n},t.setStepX=function(e){a!=e&&(a=e,t.setChanged(!0))},t.getStepX=function(){return a},t.setStepY=function(e){s!=e&&(s=e,t.setChanged(!0))},t.getStepY=function(){return s},t.setTickStepX=function(e){l!=e&&(l=e,t.setChanged(!0))},t.getTickStepX=function(){return l},t.setTickStepY=function(e){u!=e&&(u=e,t.setChanged(!0))},t.getTickStepY=function(){return u},t.setTicksX=function(e){i!=e&&(i=e,t.setChanged(!0))},t.getTicksX=function(){return i},t.setTicksY=function(e){o!=e&&(o=e,t.setChanged(!0))},t.getTicksY=function(){return o},
t.setTicksXMode=function(e){"string"==typeof e&&(e=EJSS_DRAWING2D.Grid[e.toUpperCase()]),m!=e&&(m=e,t.setChanged(!0))},t.getTicksXMode=function(){return m},t.setTicksYMode=function(e){"string"==typeof e&&(ticksXMode=EJSS_DRAWING2D.Grid[e.toUpperCase()]),A!=e&&(A=e,t.setChanged(!0))},t.setShowX=function(e){g!=e&&(g=e,t.setChanged(!0))},t.getShowX=function(){return g},t.setShowY=function(e){c!=e&&(c=e,t.setChanged(!0))},t.getShowY=function(){return c},t.getTicksYMode=function(){return A},t.setLineColorX=function(e){return"string"!=typeof e&&(e=EJSS_TOOLS.DisplayColors.getLineColor(e)),e!=D&&(D=e,t.setChanged(!0)),t},t.getLineColorX=function(){return D},t.setLineWidthX=function(e){e!=I&&(I=e,t.setChanged(!0))},t.getLineWidthX=function(){return I},t.setShapeRenderingX=function(e){"RENDER"==e.substring(0,6)&&(e=EJSS_DRAWING2D.Style[e.toUpperCase()]),R!=e&&(R=e,t.setChanged(!0))},t.getShapeRenderingX=function(){return R},t.setLineColorY=function(e){return"string"!=typeof e&&(e=EJSS_TOOLS.DisplayColors.getLineColor(e)),e!=_&&(_=e,t.setChanged(!0)),t},t.getLineColorY=function(){return _},t.setLineWidthY=function(e){e!=T&&(T=e,t.setChanged(!0))},t.getLineWidthY=function(){return T},t.setShapeRenderingY=function(e){"RENDER"==e.substring(0,6)&&(e=EJSS_DRAWING2D.Style[e.toUpperCase()]),N!=e&&(N=e,t.setChanged(!0))},t.getShapeRenderingY=function(){return N},t.registerProperties=function(e){EJSS_DRAWING2D.Grid.registerProperties(t,e)},t};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Group={},EJSS_DRAWING2D.group=function(e){var t=EJSS_DRAWING2D.element(e);return t._23=function(){return"ElementGroup"},t.isGroup=function(){return!0},t},EJSS_DRAWING2D.GroupSet={},EJSS_DRAWING2D.groupSet=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Histogram={},EJSS_DRAWING2D.histogram=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Image={},EJSS_DRAWING2D.image=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.ImageSet={},EJSS_DRAWING2D.imageSet=function(e){};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.analyticCurve=function(e,t){var r,n,i=t.getPixelPosition(),o=t.getPixelSizes(),a=t.getRelativePositionOffset(o),s=i[0]+a[0],l=i[1]+a[1],u=o[0]/2,g=o[1]/2,c=t.getNumPoints(),S=t.getMinimun(),d=t.getMaximun(),f=void 0===S||null===S?t.getPanel().getRealWorldXMin():S,E=void 0===d||null===d?t.getPanel().getRealWorldXMax():d,p=t.getVariable(),h=t.getFunctionX(),m=t.getFunctionY(),A=EJSS_DRAWING2D.functionsParser(),P=!1;try{r=A.parse(h)}catch(e){console.log("Analytic curve error parsing FunctionX: "+h),P=!0}if(!P)try{n=A.parse(m)}catch(e){console.log("Analytic curve error parsing FunctionY: "+m),P=!0}if(P)return void t.getController().invokeAction("OnError");var v=(E-f)/(c-1),y=[],C={},D=t.getParameters();for(var I in D)C[I]=D[I];try{for(var R=0,_=f;_<=E;_+=v){C[p]=_;var T=r.evaluate(C),N=n.evaluate(C);isNaN(T)||isNaN(N)||(y[R]=[],y[R][0]=T,y[R++][1]=N)}}catch(e){t.getController().invokeAction("OnError")}!function(t,r,n,i,o){e.beginPath();for(var a=0;a<t.length;a++){var s=t[a],l=r+s[0]*i,u=n+s[1]*o,g=s[2];0==a||0==g?e.moveTo(l,u):e.lineTo(l,u)}}(y,s-u,l-g,o[0],o[1]);var O=t.getStyle();O.getDrawFill()&&"none"!=O.getFillColor()&&(e.fillStyle=O.getFillColor(),e.fill()),O.getDrawLines()&&(e.lineWidth=O.getLineWidth(),e.strokeStyle=O.getLineColor(),e.stroke())};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.arrow=function(e,t){function r(t,r,i,o,a,s,l,u,g){e.save(),o/=2,a/=2;var c=0==u?Math.PI/2:Math.atan(g/u);switch(c+=u<0?-Math.PI/2:Math.PI/2,i){case n.TRIANGLE:e.beginPath(),e.translate(t,r),e.rotate(c),e.moveTo(0,a/2),e.lineTo(o,a/2),e.lineTo(0,-a/2),e.lineTo(-o,a/2),e.closePath();break;case n.ANGLE:e.beginPath(),e.translate(t,r),e.rotate(c),e.moveTo(o,a),e.lineTo(0,0),e.lineTo(-o,a);break;case n.LINE:e.beginPath(),e.translate(t,r),e.rotate(c),e.moveTo(o,0),e.lineTo(-o,0);break;case n.RECTANGLE:e.beginPath(),e.translate(t,r),e.rotate(c),e.moveTo(0,-a),e.lineTo(o,-a),e.lineTo(o,a),e.lineTo(-o,a),e.lineTo(-o,-a),e.closePath();break;case n.POINTED:e.beginPath(),e.translate(t,r),e.rotate(c),e.moveTo(0,a/4),e.lineTo(o,a),e.lineTo(0,-a/4),e.lineTo(-o,a),e.closePath();break;case n.CIRCLE:var S=o<a?o:a;e.beginPath(),e.translate(t,r),e.arc(0,0,S,0,2*Math.PI,!1);break;case n.DIAMOND:e.beginPath(),e.translate(t,r),e.rotate(c),e.moveTo(0,-a),e.lineTo(o,0),e.lineTo(0,a),e.lineTo(-o,0),e.closePath();break;case n.INVTRIANGLE:e.beginPath(),e.translate(t,r),e.rotate(c),e.moveTo(0,-a/2),e.lineTo(-o,-a/2),e.lineTo(0,a/2),e.lineTo(o,-a/2),e.closePath();break;case n.INVANGLE:e.beginPath(),e.translate(t,r),e.rotate(c),e.moveTo(-o,-a),e.lineTo(0,0),e.lineTo(o,-a);break;case n.WEDGE:case n.CURVE:console.log("Type of Arrow: not supported")}"none"!=l&&(i!=n.ANGLE&&i!=n.INVANGLE&&(e.fillStyle=l,e.fill()),i!=n.POINTED&&(e.lineWidth=s,e.strokeStyle=l,e.stroke())),e.restore()}var n=EJSS_DRAWING2D.Arrow,i=t.getPixelPosition(),o=t.getPixelSizes(),a=t.getRelativePositionOffset(o),s=i[0]+a[0],l=i[1]+a[1],u=o[0]/2,g=o[1]/2;if(0!=o[0]||0!=o[1]){e.beginPath(),e.moveTo(s-u,l-g),e.lineTo(s+u,l+g);var c=t.getStyle();if(c.getDrawFill()&&"none"!=c.getFillColor()&&(e.fillStyle=c.getFillColor(),e.fill()),c.getDrawLines()&&(e.lineWidth=c.getLineWidth(),e.strokeStyle=c.getLineColor(),e.stroke()),t.getMarkEnd()!=n.NONE){var S=t.getMarkProportion()*EJSS_TOOLS.Mathematics.norm([o[0],o[1]]),d=0!=S&&S<t.getMarkEndWidth()?S:t.getMarkEndWidth(),f=0!=S&&S<t.getMarkEndHeight()?S:t.getMarkEndHeight(),E="none"==t.getMarkEndColor()?t.getStyle().getLineColor():t.getMarkEndColor(),p=t.getMarkEndStroke()<0?t.getStyle().getLineWidth():t.getMarkEndStroke();r(s+u,l+g,t.getMarkEnd(),d,f,p,E,u,g)}if(t.getMarkMiddle()!=n.NONE){var h=t.getMarkProportion()*EJSS_TOOLS.Mathematics.norm([o[0],o[1]]),m=0!=h&&h<t.getMarkMiddleWidth()?h:t.getMarkMiddleWidth(),A=0!=h&&h<t.getMarkMiddleHeight()?h:t.getMarkMiddleHeight(),E="none"==t.getMarkMiddleColor()?t.getStyle().getLineColor():t.getMarkMiddleColor(),p=t.getMarkMiddleStroke()<0?t.getStyle().getLineWidth():t.getMarkMiddleStroke();r(s,l,t.getMarkMiddle(),m,A,p,E,u,g)}if(t.getMarkStart()!=n.NONE){var P=t.getMarkProportion()*EJSS_TOOLS.Mathematics.norm([o[0],o[1]]),v=0!=P&&P<t.getMarkStartWidth()?P:t.getMarkStartWidth(),y=0!=P&&P<t.getMarkStartHeight()?P:t.getMarkStartHeight(),E="none"==t.getMarkStartColor()?t.getStyle().getLineColor():t.getMarkStartColor(),p=t.getMarkStartStroke()<0?t.getStyle().getLineWidth():t.getMarkStartStroke();r(s-u,l-g,t.getMarkStart(),v,y,p,E,u,g)}}};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.axis=function(e,t){function r(t,r,n,i){i==EJSS_DRAWING2D.Axis.AXIS_VERTICAL?(e.moveTo(t-n/2,r),e.lineTo(t+n/2,r)):(e.moveTo(t,r-n/2),e.lineTo(t,r+n/2))}function n(r,n,i,o,a){e.save();var o=t.getFont(),s="";s+="none"!=o.getFontStyle()?o.getFontStyle()+" ":"",s+="none"!=o.getFontWeight()?o.getFontWeight()+" ":"",s+=o.getFontSizeString()+"px ",s+=o.getFontFamily(),e.font=s,e.fillStyle=o.getFillColor(),a?r-=e.measureText(i).width/2+.5:n+=o.getFontSize()/2,e.fillText(i,r,n),e.restore()}if(t.getShow()){var i=t.getPixelPosition(),o=t.getPixelSizes(),a=t.getRelativePositionOffset(o),s=i[0]+a[0],l=i[1]+a[1],u=o[0]/2,g=o[1]/2,c=t.getStyle(),S=t.getOrient(),d=t.getInvertedScaleY();e.beginPath(),function(t,r,n,i,o,a){o==EJSS_DRAWING2D.Axis.AXIS_VERTICAL?(a&&(i=-i,r=-r),e.moveTo(t,r-i),e.lineTo(t,r+i)):(e.moveTo(t-n,r),e.lineTo(t+n,r))}(s,l,u,g,S,d);var f=S==EJSS_DRAWING2D.Axis.AXIS_VERTICAL?Math.abs(o[1]):Math.abs(o[0]),E=t.getTicksMode();if(E==EJSS_DRAWING2D.Axis.SCALE_LOG){var p=t.getScale();if(p[0]>0&&p[1]>0){var h=t.getTicks(),m=t.getScalePrecision(),A=t.getTicksSize();EJSS_GRAPHICS.GraphicsUtils.drawLogTicks(s,l,u,g,f,A,p,h,S,r);var P=t.getFont(),v=t.getTextPosition();EJSS_GRAPHICS.GraphicsUtils.drawLogTicksText(s,l,u,g,h,A,p,m,P,v,S,n)}}else if(E==EJSS_DRAWING2D.Axis.SCALE_NUM){var y=0,C=0;if(t.getAutoTicks())for(var D=t.getAutoStepMin(),I=t.getAutoTicksRange(),R=I.length-1;R>=0&&!(1.001*(y=Math.abs(f/I[R]))>=D);R--);else{var h=t.getTicks();0!=h?y=f/h:(y=t.getStep(),C=t.getTickStep())}var m=t.getScalePrecision(),p=t.getScale();if(0==C)var _=Math.abs((p[1]-p[0])*y/f);else{var _=C;y=Math.abs(_*f/(p[1]-p[0]))}var T=Math.pow(10,m),N=Math.round(_*T)/T;N>0&&(_=N,y=Math.abs(N*f/(p[1]-p[0])));var O=t.getFixedTick(),M=p[1];isNaN(O)||(M=O<p[0]?O+(Math.floor((p[0]-O)/_)+1)*_:O>p[1]?O-(Math.floor((O-p[1])/_)+1)*_:O);var b=Math.abs((p[0]-M)%_),G=Math.abs(b-_);(b<.001||G<.001)&&(b=0);var x=f*b/Math.abs(p[1]-p[0]),A=t.getTicksSize();EJSS_GRAPHICS.GraphicsUtils.drawDecTicks(s,l,u,g,A,y,x,S,d,r);var P=t.getFont(),v=t.getTextPosition();EJSS_GRAPHICS.GraphicsUtils.drawDecTicksText(s,l,u,g,A,y,x,p,m,_,b,P,v,S,d,n)}var c=t.getStyle();c.getDrawFill()&&"none"!=c.getFillColor()&&(e.fillStyle=c.getFillColor(),e.fill()),c.getDrawLines()&&(e.lineWidth=c.getLineWidth(),e.strokeStyle=c.getLineColor(),e.stroke())}};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.byteRaster=function(e,t){if(t.getDataChanged()){var r=t.getData(),n=t.getColorMapper().getColors(),i=r.length,o=r[0].length,a=t.getColorMapper().getNumberOfColors(),s=t.getPixelPosition(),l=t.getPixelSizes(),u=t.getRelativePositionOffset(l),g=s[0]+u[0],c=s[1]+u[1],S=Math.abs(l[0]/2),d=Math.abs(l[1]/2),f=e.canvas.id;EJSS_SVGGRAPHICS.Utils.ImageDataCanvas(i,o,a,r,n,function(t){var r=document.getElementById(f);e=r.getContext("2d"),e.putImageData(t,g-S,c-d)}),t.setDataChanged(!1)}};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.canvas=function(e,t){for(var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1],s=t.getDimensions(),l=s[1]-s[0],u=s[3]-s[2],g=Math.abs(n[0]),c=Math.abs(n[1]),S=g/l,d=c/u,f=o-g/2,E=a+c/2,p=t.getDrawables(),h=0;h<p.length;h++)void 0!==p[h].imageField?EJSS_GRAPHICS.GraphicsUtils.drawImageField(e,f,E,xMin,yMin,g,c,S,d,p[h]):void 0!==p[h].run&&p[h].draw(e,f,E,xMin,yMin,g,c,S,d)};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.cellLattice=function(e,t){function r(t,r,n,i,o,a){e.beginPath(),0==o&&(o=Math.abs(n-t));for(var s=t;s<=n;s+=o)e.moveTo(s,r),e.lineTo(s,i);0==a&&(a=Math.abs(r-i));for(var s=i;s>=r;s-=a)e.moveTo(t,s),e.lineTo(n,s)}for(var n=t.getPixelPosition(),i=t.getPixelSizes(),o=t.getRelativePositionOffset(i),a=n[0]+o[0],s=n[1]+o[1],l=i[0]/2,u=i[1]/2,g=t.getStyle(),c=t.getData(),S=t.getColorMapper().getColors(),d=c.length,f=c[0].length,E=Math.abs(i[0]/d),p=Math.abs(i[1]/f),h=a-l+E/2,m=s-u-p/2,A=0;A<f;A++)for(var P=0;P<d;P++)!function(t,r,n,i,o){e.beginPath();var a=n/2,s=i/2;e.moveTo(t-a,r+s),e.lineTo(t+a,r+s),e.lineTo(t+a,r-s),e.lineTo(t-a,r-s),e.lineTo(t-a,r+s),e.fillStyle=o,e.fill(),e.lineWidth=1,e.strokeStyle=o,e.stroke()}(h+E*P,m-p*A,E,p,S[c[P][A]]);t.getShowGrid()&&function(t,n,i,o,a,s,l){var u=i/2,g=o/2;r(t-u,n+g,t+u,n-g,a,s),l.getDrawFill()&&"none"!=l.getFillColor()&&(e.fillStyle=l.getFillColor(),e.fill()),l.getDrawLines()&&(e.lineWidth=l.getLineWidth(),e.strokeStyle=l.getLineColor(),e.stroke())}(a,s,i[0],i[1],E,p,g)};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.cursor=function(e,t){var r=t.getPixelPosition(),n=t.getCursorType(),i=t.getGroupPanel(),o=i.getRealWorldCoordinates(),a=i._26([o[0],o[2]]),s=i._26([o[1],o[3]]);if(e.beginPath(),n!=EJSS_DRAWING2D.Cursor.VERTICAL){var l=a[0],u=s[0],g=r[1];g>a[1]?g=a[1]:g<s[1]&&(g=s[1]),e.moveTo(l,g),e.lineTo(u,g)}if(n!=EJSS_DRAWING2D.Cursor.HORIZONTAL){var c=r[0],S=a[1],d=s[1];c<a[0]?c=a[0]:c>s[0]&&(c=s[0]),e.moveTo(c,S),e.lineTo(c,d)}var f=t.getStyle();f.getDrawFill()&&"none"!=f.getFillColor()&&(e.fillStyle=f.getFillColor(),e.fill()),f.getDrawLines()&&(e.lineWidth=f.getLineWidth(),e.strokeStyle=f.getLineColor(),e.stroke())};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.ellipse=function(e,t){var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1],s=Math.abs(n[0]),l=Math.abs(n[1]),u=o-s/2,g=a-l/2;ox=s/2*.5522848,oy=l/2*.5522848,xe=u+s,ye=g+l,e.beginPath(),e.moveTo(u,a),e.bezierCurveTo(u,a-oy,o-ox,g,o,g),e.bezierCurveTo(o+ox,g,xe,a-oy,xe,a),e.bezierCurveTo(xe,a+oy,o+ox,ye,o,ye),e.bezierCurveTo(o-ox,ye,u,a+oy,u,a);var c=t.getStyle();c.getDrawFill()&&"none"!=c.getFillColor()&&(e.fillStyle=c.getFillColor(),e.fill()),c.getDrawLines()&&(e.lineWidth=c.getLineWidth(),e.strokeStyle=c.getLineColor(),e.stroke())};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.grid=function(e,t){var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1],s=n[0]/2,l=n[1]/2,u=t.getShowX(),g=t.getShowY();if(u){e.beginPath();var c=t.getTicksXMode();if(c==EJSS_DRAWING2D.Grid.SCALE_LOG){var S=t.getScaleX();if(S[0]>0&&S[1]>0){var d=t.getTicksX(),f=o-s,E=o+s,p=a+l,h=a-l;EJSS_GRAPHICS.GraphicsUtils.drawLogGrid(f,p,E,h,d,S,1,function(t,r){e.moveTo(t,r)},function(t,r){e.lineTo(t,r)})}}else if(c==EJSS_DRAWING2D.Grid.SCALE_NUM){var m=0,A=0;if(t.getAutoTicksX())for(var P=t.getAutoStepXMin(),v=t.getAutoTicksRangeX(),y=v.length-1;y>=0&&!((m=Math.abs(n[0]/v[y]))>=P);y--);else{var d=t.getTicksX();0!=d?m=Math.abs(n[0]/d):(m=t.getStepX(),A=t.getTickStepX())}var C=t.getScalePrecisionX(),S=t.getScaleX();if(0==A)var D=Math.abs((S[1]-S[0])*m/n[0]);else{var D=A;m=Math.abs(D*n[0]/(S[1]-S[0]))}var I=Math.pow(10,C),R=Math.round(D*I)/I;R>0&&(D=R,m=Math.abs(R*n[0]/(S[1]-S[0])));var _=t.getFixedTickX(),T=S[1];isNaN(_)||(T=_<S[0]?_+(Math.floor((S[0]-_)/D)+1)*D:_>S[1]?_-(Math.floor((_-S[1])/D)+1)*D:_);var N=Math.abs((S[0]-T)%D),O=Math.abs(N-D);(N<.001||O<.001)&&(N=0);var M=Math.abs(n[0]*N/(S[1]-S[0])),f=o-s,E=o+s,p=a+l,h=a-l;EJSS_GRAPHICS.GraphicsUtils.drawDecGrid(f,p,E,h,M,m,1,function(t,r){e.moveTo(t,r)},function(t,r){e.lineTo(t,r)})}e.lineWidth=t.getLineWidthX(),e.strokeStyle=t.getLineColorX(),e.stroke()}if(g){e.beginPath();var b=t.getTicksYMode();if(b==EJSS_DRAWING2D.Grid.SCALE_LOG){var G=t.getScaleY();if(G[0]>0&&G[1]>0){var x=t.getTicksY(),f=o-s,E=o+s,p=a+l,h=a-l;EJSS_GRAPHICS.GraphicsUtils.drawLogGrid(f,p,E,h,x,G,-1,function(t,r){e.moveTo(t,r)},function(t,r){e.lineTo(t,r)})}}else if(b==EJSS_DRAWING2D.Grid.SCALE_NUM){var J=0,L=0;if(t.getAutoTicksY())for(var w=t.getAutoStepYMin(),W=t.getAutoTicksRangeY(),y=W.length-1;y>=0&&!((J=Math.abs(n[1]/W[y]))>=w);y--);else{var x=t.getTicksY();0!=x?J=Math.abs(n[1]/x):(J=t.getStepY(),L=t.getTickStepY())}var k=t.getScalePrecisionY(),G=t.getScaleY();if(0==L)var F=Math.abs((G[1]-G[0])*J/n[1]);else{var F=L;J=Math.abs(F*n[1]/(G[1]-G[0]))}var V=Math.pow(10,k),B=Math.round(F*V)/V;B>0&&(F=B,J=Math.abs(B*n[1]/(G[1]-G[0])));var _=t.getFixedTickY(),T=G[1];isNaN(_)||(T=_<G[0]?_+(Math.floor((G[0]-_)/F)+1)*F:_>G[1]?_-(Math.floor((_-G[1])/F)+1)*F:_);var N=Math.abs((G[0]-T)%F),O=Math.abs(N-F);(N<.001||O<.001)&&(N=0);var z=Math.abs(n[1]*N/(G[1]-G[0])),f=o-s,E=o+s,p=a+l,h=a-l;EJSS_GRAPHICS.GraphicsUtils.drawDecGrid(f,p,E,h,z,J,-1,function(t,r){e.moveTo(t,r)},function(t,r){e.lineTo(t,r)})}e.lineWidth=t.getLineWidthY(),e.strokeStyle=t.getLineColorY(),e.stroke()}};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.histogram=function(e,t){for(var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1],s=n[0]/2,l=n[1]/2,u=t.getStyle(),g=t.getDiscrete(),c=t.getBinWidth()/2,S=t.getBars(),d=t.getGroupPanel().getPixelPositionWorldOrigin()[1],f=0;f<S.length;f++){var E,p,h=S[f][0];g?E=p=o-s+h*n[0]:(E=o-s+(h-c)*n[0],p=o-s+(h+c)*n[0]);var m=a-l+S[f][1]*n[1];!function(t,r,n,i,o){e.beginPath(),e.moveTo(t,i),e.lineTo(t,n),e.lineTo(r,n),e.lineTo(r,i),o.getDrawFill()&&"none"!=o.getFillColor()&&(e.fillStyle=o.getFillColor(),e.fill()),o.getDrawLines()&&(e.lineWidth=o.getLineWidth(),e.strokeStyle=o.getLineColor(),e.stroke())}(E,p,m,d,u)}};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.image=function(e,t,r){var n,i=t.getPixelPosition(),o=t.getPixelSizes(),a=t.getRelativePositionOffset(o),s=i[0]+a[0],l=i[1]+a[1],u=Math.abs(o[0]/2),g=Math.abs(o[1]/2);if(t.getChangedImage()||(n=t.getCustomObject()),n)e.save(),r(t),e.drawImage(n,s-u,l-g,Math.abs(o[0]),Math.abs(o[1])),e.restore();else{n=new Image,t.setCustomObject(n),n.onload=function(){e.save(),r(t),e.drawImage(n,s-u,l-g,Math.abs(o[0]),Math.abs(o[1])),e.restore()};var c=t.getEncode();c.length>0?n.src="data:png;base64,"+c:n.src=t.getImageUrl()}t.setChangedImage(!1)};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.mesh=function(e,t){function r(t,r,n,i,o){e.beginPath();for(var a=0;a<n;a++)0==a?e.moveTo(t[0],r[0]):e.lineTo(t[a],r[a]);e.lineTo(t[0],r[0]);var s=i.indexToColor(o);e.fillStyle=s,e.fill(),e.lineWidth=1.25,e.strokeStyle=s,e.stroke()}function n(t,r,n,i){e.beginPath();for(var o=t.length,a=0;a<o;a++)0==a?e.moveTo(t[0],r[0]):e.lineTo(t[a],r[a]);e.lineTo(t[0],r[0]),n&&i.getDrawFill()&&"none"!=i.getFillColor()&&(e.fillStyle=i.getFillColor(),e.fill()),i.getDrawLines()&&(e.lineWidth=i.getLineWidth(),e.strokeStyle=i.getLineColor(),e.stroke())}function i(t,r,n,i){e.beginPath();for(var o=t.length,a=0;a<o;a++)0==a?e.moveTo(t[0],r[0]):e.lineTo(t[a],r[a]);e.lineTo(t[0],r[0]),e.lineWidth=i+.5,e.strokeStyle=n,e.stroke()}var o,a,s,l,u=t.getPixelPosition(),g=t.getPixelSizes(),c=t.getRelativePositionOffset(g),S=u[0]+c[0],d=u[1]+c[1],f=g[0]/2,E=g[1]/2,p=t.getPoints();if(null!=p){var h=p.length;o=new Array(h),a=new Array(h);for(var m=0;m<h;m++)o[m]=S-f+p[m][0]*g[0],a[m]=d-E+p[m][1]*g[1];var A=t.getCells(),P=t.getFieldAtPoints();if(P?s=EJSS_GRAPHICS.GraphicsUtils.buildCells(o,a,A,P,!1):(P=t.getFieldAtCells(),s=EJSS_GRAPHICS.GraphicsUtils.buildCells(o,a,A,P,!0)),null!=A){var v=t.getStyle();if(null!=P){var y=t.getColorCoded();EJSS_GRAPHICS.GraphicsUtils.drawPolygons(s,y,function(e,t){n(e,t,!1,v)},function(e,t,n,i,o){r(e,t,n,i,o)})}else EJSS_GRAPHICS.GraphicsUtils.drawPolygons(s,y,function(e,t){n(e,t,!0,v)},function(e,t,r,n,i){})}var C=t.getBoundary();if(t.getDrawBoundary()&&null!=C){var D=t.getBoundaryLabels(),I=t.getBoundaryColors(),R=t.getBoundaryLineWidth();l=EJSS_GRAPHICS.GraphicsUtils.buildBoundary(o,a,C),EJSS_GRAPHICS.GraphicsUtils.drawBoundary(l,D,I,function(e,t,r){i(e,t,r,R)})}if(t.getDataType()>=4&&null!=P)for(var _=t.getVectorLength()*g[0],m=0,T=A.length;m<T;m++)!function(t,r,n,i){for(var o=0;o<t.length;o++){var a=t[o],s=r[o],l=n[o][0],u=n[o][1],g=EJSS_TOOLS.Mathematics.norm([l,u]),c=l*i/g,S=u*i/g;if(0!=c||0!=S){var f=.3*EJSS_TOOLS.Mathematics.norm([c,S]),p=0!=f&&f<12?f:12,h=Math.atan2(c,S);e.beginPath(),e.moveTo(a,s),e.lineTo(a+c-p*Math.cos(h),s+S-p*Math.sin(h)),e.lineTo(a+c-p*Math.cos(h-Math.PI/6),s+S-p*Math.sin(h-Math.PI/6)),e.lineTo(a+c,d+E),e.lineTo(a+c-p*Math.cos(h+Math.PI/6),s+S-p*Math.sin(h+Math.PI/6)),e.lineTo(a+c-p*Math.cos(h),s+S-p*Math.sin(h)),e.lineWidth=1,e.strokeStyle="black",e.stroke()}}}(mCellA[m],mCellB[m],P[m],_)}};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.pipe=function(e,t){var r=t.getPoints();if(r&&!(r.length<=0)){var n=t.getPixelPosition(),i=t.getPixelSizes(),o=t.getRelativePositionOffset(i),a=n[0]+o[0],s=n[1]+o[1],l=Math.abs(i[0]),u=Math.abs(i[1]),g=a-l/2,c=s+u/2,S=t.getStyle();e.beginPath(),e.moveTo(g,c);for(var a=g,s=c,d=0,f=r.length;d<f;d++){var E=r[d];a+=Math.round(E[0]*l),s+=Math.round(-E[1]*u),e.lineTo(a,s)}S.getDrawLines()&&(e.lineWidth=2*S.getLineWidth()+t.getPipeWidth(),e.strokeStyle=S.getLineColor(),e.stroke()),e.beginPath(),e.moveTo(g,c);for(var a=g,s=c,d=0,f=r.length;d<f;d++){var E=r[d];a+=Math.round(E[0]*l),s+=Math.round(-E[1]*u),e.lineTo(a,s)}S.getDrawLines()&&(e.lineWidth=t.getPipeWidth(),e.strokeStyle=S.getFillColor(),e.stroke())}};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.point=function(e,t){var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1];e.beginPath(),e.arc(o,a,2,0,2*Math.PI);var s=t.getStyle();e.fillStyle=s.getFillColor(),e.fill()};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.polygon=function(e,t){var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1],s=n[0]/2,l=n[1]/2;e.beginPath();for(var u=t.getPoints(),g=0;g<u.length;g++){var c=u[g],S=o-s+c[0]*n[0],d=a-l+c[1]*n[1],f=c[2];0==g||0==f?e.moveTo(S,d):e.lineTo(S,d)}var E=t.getStyle();E.getDrawFill()&&"none"!=E.getFillColor()&&(e.fillStyle=E.getFillColor(),e.fill()),E.getDrawLines()&&(e.lineWidth=E.getLineWidth(),e.strokeStyle=E.getLineColor(),e.stroke())};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.rectangle=function(e,t){var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1],s=n[0]/2,l=n[1]/2;e.beginPath(),e.moveTo(o-s,a+l),e.lineTo(o+s,a+l),e.lineTo(o+s,a-l),e.lineTo(o-s,a-l),e.lineTo(o-s,a+l);var u=t.getStyle();u.getDrawFill()&&"none"!=u.getFillColor()&&(e.fillStyle=u.getFillColor(),e.fill()),u.getDrawLines()&&(e.lineWidth=u.getLineWidth(),e.strokeStyle=u.getLineColor(),e.stroke())};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.roundRectangle=function(e,t){var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1],s=Math.abs(n[0]),l=Math.abs(n[1]),u=o-s/2,g=a-l/2,c=Math.abs(t.getCornerRadius());e.beginPath(),e.moveTo(u+c,g),e.lineTo(u+s-c,g),e.quadraticCurveTo(u+s,g,u+s,g+c),e.lineTo(u+s,g+l-c),e.quadraticCurveTo(u+s,g+l,u+s-c,g+l),e.lineTo(u+c,g+l),e.quadraticCurveTo(u,g+l,u,g+l-c),e.lineTo(u,g+c),e.quadraticCurveTo(u,g,u+c,g),e.closePath();var S=t.getStyle();S.getDrawFill()&&"none"!=S.getFillColor()&&(e.fillStyle=S.getFillColor(),e.fill()),S.getDrawLines()&&(e.lineWidth=S.getLineWidth(),e.strokeStyle=S.getLineColor(),e.stroke())};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.canvas=function(e,t){var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1],s=t.getMaximumX()-t.getMinimumX(),l=t.getMaximumY()-t.getMinimumY(),u=Math.abs(n[0]),g=Math.abs(n[1]),c=u/s,S=g/l,d=o-u/2,f=a+g/2;EJSS_GRAPHICS.GraphicsUtils.drawImageField(context,d,f,t.getMinimumX(),t.getMinimumY(),u,g,c,S,{data:t.getData()})};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.segment=function(e,t){var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1],s=n[0]/2,l=n[1]/2;e.beginPath(),e.moveTo(o-s,a-l),e.lineTo(o+s,a+l);var u=t.getStyle();u.getDrawFill()&&"none"!=u.getFillColor()&&(e.fillStyle=u.getFillColor(),e.fill()),u.getDrawLines()&&(e.lineWidth=u.getLineWidth(),e.strokeStyle=u.getLineColor(),e.stroke())};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.spring=function(e,t){var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1],s=n[0]/2,l=n[1]/2,u=t.getGroupPanel().toPixelMod([t.getRadius(),0])[0];e.beginPath(),EJSS_GRAPHICS.GraphicsUtils.drawSpring(t.getLoops(),t.getPointsPerLoop(),u,t.getSolenoid(),t.getThinExtremes(),o-s,a-l,n[0],n[1],function(t,r){e.moveTo(t,r)},function(t,r){e.lineTo(t,r)});var g=t.getStyle();g.getDrawFill()&&"none"!=g.getFillColor()&&(e.fillStyle=g.getFillColor(),e.fill()),g.getDrawLines()&&(e.lineWidth=g.getLineWidth(),e.strokeStyle=g.getLineColor(),e.stroke())};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.tank=function(e,t){var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1],s=Math.abs(n[0]/2),l=Math.abs(n[1]/2),u=t.getPixelSizeOf(0,t.getLevel()),g=o-s,c=o+s,S=a+l,d=a-l,f=S+u[1],E=t.getStyle();e.beginPath(),e.moveTo(g+u[0],f),e.lineTo(g,S),e.lineTo(c,S),e.lineTo(c+u[0],f),e.fillStyle=t.getLevelColor(),e.fill(),e.beginPath(),e.moveTo(g,d),e.lineTo(g,S),e.lineTo(c,S),e.lineTo(c,d),E.getDrawFill()&&"none"!=E.getFillColor()&&(e.fillStyle=E.getFillColor(),e.fill()),e.lineWidth=E.getLineWidth(),e.strokeStyle=E.getLineColor(),e.stroke()};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.text=function(e,t){var r=t.getFont(),n="";n+="none"!=r.getFontStyle()?r.getFontStyle()+" ":"",n+="none"!=r.getFontWeight()?r.getFontWeight()+" ":"",n+=r.getFontSizeString()+(r.getFontSizeString().toString().indexOf("px")>-1?" ":"px "),n+=r.getFontFamily(),e.font=n;var i=t.getText(),o=t.getPixelPosition(),a=t.getFramed()?4:0,s=[e.measureText(i).width+2*a,r.getFontSize()+2*a],l=EJSS_DRAWING2D.Element.getSWRelativePositionOffset(t.getRelativePosition(),s[0],s[1]),u=t.getMarginX(),g=t.getMarginY(),c=o[0]+l[0]+u+a,S=o[1]+l[1]+g-a;if(t.getFramed()){var d=a,f=a,E=s[0]-2*a,p=s[1]-2*a;if(E>0){var h=S+d,m=S-p-d,A=c-f,P=c+E+d;e.save(),e.beginPath(),e.moveTo(A,h),e.lineTo(P,h),e.lineTo(P,m),e.lineTo(A,m),e.lineTo(A,h);var v=t.getStyle();v.getDrawFill()&&"none"!=v.getFillColor()&&(e.fillStyle=v.getFillColor(),e.fill()),v.getDrawLines()&&(e.lineWidth=v.getLineWidth(),e.strokeStyle=v.getLineColor(),e.stroke()),e.restore()}}var y=0;switch(t.getWritingMode()){case EJSS_DRAWING2D.Text.MODE_TOPDOWN:y=Math.PI/2;break;case EJSS_DRAWING2D.Text.MODE_RIGTHLEFT:y=Math.PI;break;case EJSS_DRAWING2D.Text.MODE_DOWNTOP:y=3*Math.PI/2;break;case EJSS_DRAWING2D.Text.MODE_LEFTRIGHT:y=0}e.translate(o[0]+u,o[1]+g),e.rotate(y),e.translate(-(o[0]+u),-(o[1]+g)),e.fillStyle=r.getFillColor(),e.fillText(t.getText(),c,S)};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.trace=function(e,t){function r(t,r,n,i){var o=t,a=r,s=Math.abs(n[0]),l=Math.abs(n[1]);e.beginPath(),e.rect(o-s/2,a-l/2,s,l),i.getDrawFill()&&"none"!=i.getFillColor()&&(e.fillStyle=i.getFillColor(),e.fill()),i.getDrawLines()&&(e.lineWidth=i.getLineWidth(),e.strokeStyle=i.getLineColor(),e.stroke())}var n=t.getPixelPosition(),i=t.getPixelSizes(),o=t.getRelativePositionOffset(i),a=n[0]+o[0],s=n[1]+o[1],l=i[0]/2,u=i[1]/2;!function(t,r,n,i,o){e.beginPath();for(var a=0;a<t.length;a++){var s=t[a],l=r+s[0]*i,u=n+s[1]*o,g=s[2];0==a||0==g?e.moveTo(l,u):e.lineTo(l,u)}}(t.getPoints(),a-l,s-u,i[0],i[1]);var g=t.getStyle();g.getDrawFill()&&"none"!=g.getFillColor()&&(e.fillStyle=g.getFillColor(),e.fill()),g.getDrawLines()&&(e.lineWidth=g.getLineWidth(),e.strokeStyle=g.getLineColor(),e.stroke());for(var c,S,d=t.getPoints(),f=0;f<d.length;f++){var E=d[f],p=a-l+E[0]*i[0],h=s-u+E[1]*i[1],m=E[3],A=E[4],P=[E[5],E[6]];if(m==EJSS_DRAWING2D.Trace.ELLIPSE)!function(t,r,n,i){var o=t,a=r,s=Math.abs(n[0]),l=Math.abs(n[1]),u=o-s/2,g=a-l/2;ox=s/2*.5522848,oy=l/2*.5522848,xe=u+s,ye=g+l,e.beginPath(),e.moveTo(u,a),e.bezierCurveTo(u,a-oy,o-ox,g,o,g),e.bezierCurveTo(o+ox,g,xe,a-oy,xe,a),e.bezierCurveTo(xe,a+oy,o+ox,ye,o,ye),e.bezierCurveTo(o-ox,ye,u,a+oy,u,a),i.getDrawFill()&&"none"!=i.getFillColor()&&(e.fillStyle=i.getFillColor(),e.fill()),i.getDrawLines()&&(e.lineWidth=i.getLineWidth(),e.strokeStyle=i.getLineColor(),e.stroke())}(p,h,P,A);else if(m==EJSS_DRAWING2D.Trace.RECTANGLE)r(p,h,P,A);else if(m==EJSS_DRAWING2D.Trace.BAR){var v=t.getGroupPanel()._26([0,0])[1];P[1]=v-h,h+=P[1]/2,r(p,h,P,A)}else if(m==EJSS_DRAWING2D.Trace.AREA){if(0!=f){var v=t.getGroupPanel()._26([0,0])[1],y=a-l+c*i[0],C=s-u+S*i[1];!function(t,r,n,i,o,a){e.beginPath(),e.moveTo(t,o),e.lineTo(t,r),e.lineTo(n,i),e.lineTo(n,o),a.getDrawFill()&&"none"!=a.getFillColor()&&(e.fillStyle=a.getFillColor(),e.fill()),
a.getDrawLines()&&(e.lineWidth=a.getLineWidth(),e.strokeStyle=a.getLineColor(),e.stroke())}(mMark,y,C,p,h,v)}c=E[0],S=E[1]}}};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.trail=function(e,t){function r(t,r,n,i,o,a,s){if(!(r<=0)){e.beginPath();for(var l=0;l<r;l++){var u=t[l],g=i+u[0]*a,c=o+u[1]*s,S=u[2];0==l||0==S?e.moveTo(g,c):e.lineTo(g,c)}n.getDrawLines()&&(e.lineWidth=n.getLineWidth(),e.strokeStyle=n.getLineColor(),e.stroke())}}var n=t.getPixelPosition(),i=t.getPixelSizes(),o=t.getRelativePositionOffset(i),a=n[0]+o[0],s=n[1]+o[1],l=i[0]/2,u=i[1]/2,g=a-l,c=s-u,S=i[0],d=i[1],f=t.getSegmentsCount();if(f>0)for(var E=0;E<f;E++){var p=t.getSegmentPoints(E).length;r(t.getSegmentPoints(E),p,t.getSegmentStyle(E),g,c,S,d)}var p=t.getCurrentPoints().length;r(t.getCurrentPoints(),p,t.getStyle(),g,c,S,d)};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.wheel=function(e,t){var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1],s=Math.abs(n[0]),l=Math.abs(n[1]),u=n[0]/2,g=n[1]/2,c=o-s/2,S=a-l/2;ox=s/2*.5522848,oy=l/2*.5522848,xe=c+s,ye=S+l,e.beginPath(),e.moveTo(c,a),e.bezierCurveTo(c,a-oy,o-ox,S,o,S),e.bezierCurveTo(o+ox,S,xe,a-oy,xe,a),e.bezierCurveTo(xe,a+oy,o+ox,ye,o,ye),e.bezierCurveTo(o-ox,ye,c,a+oy,c,a),e.moveTo(o-u,a),e.lineTo(o+u,a),e.moveTo(o,a-g),e.lineTo(o,a+g);var d=t.getStyle();d.getDrawFill()&&"none"!=d.getFillColor()&&(e.fillStyle=d.getFillColor(),e.fill()),d.getDrawLines()&&(e.lineWidth=d.getLineWidth(),e.strokeStyle=d.getLineColor(),e.stroke())};var EJSS_GRAPHICS=EJSS_GRAPHICS||{};EJSS_GRAPHICS.CanvasGraphics={getOffsetRect:function(e){return EJSS_GRAPHICS.GraphicsUtils.getOffsetRect(e)}},EJSS_GRAPHICS.canvasGraphics=function(e){var t=EJSS_INTERFACE.canvas(e),r=t.getDOMElement(),n=t.getContext();return t.getEventContext=function(){return r},t.getBox=function(){var e=EJSS_GRAPHICS.CanvasGraphics.getOffsetRect(t);return e.width-=1,e.height-=1,e},t.reset=function(){var e=EJSS_GRAPHICS.CanvasGraphics.getOffsetRect(t);n.clearRect(0,0,e.width,e.height)},t.draw=function(e,r){for(var n=0,i=e.length;n<i;n++){var o=e[n];o.isGroupVisible()&&t.drawElement(o,t.transformElement)}},t.drawElement=function(e,t){var r=EJSS_DRAWING2D.Shape,i=e._23();if("ElementImage"===i)EJSS_CANVASGRAPHICS.image(n,e,t);else{switch(n.save(),t(e),i){case"ElementCustom":var o=e.getFunction();o&&o(n,e);break;case"ElementShape":switch(e.getShapeType()){default:case r.ELLIPSE:EJSS_CANVASGRAPHICS.ellipse(n,e);break;case r.RECTANGLE:EJSS_CANVASGRAPHICS.rectangle(n,e);break;case r.ROUND_RECTANGLE:EJSS_CANVASGRAPHICS.roundRectangle(n,e);break;case r.WHEEL:EJSS_CANVASGRAPHICS.wheel(n,e);break;case r.NONE:case r.POINT:EJSS_CANVASGRAPHICS.point(n,e)}break;case"ElementSegment":EJSS_CANVASGRAPHICS.segment(n,e);break;case"ElementArrow":EJSS_CANVASGRAPHICS.arrow(n,e);break;case"ElementText":EJSS_CANVASGRAPHICS.text(n,e);break;case"ElementSpring":EJSS_CANVASGRAPHICS.spring(n,e);break;case"ElementTrail":EJSS_CANVASGRAPHICS.trail(n,e);break;case"ElementTrace":EJSS_CANVASGRAPHICS.trace(n,e);break;case"ElementGrid":EJSS_CANVASGRAPHICS.grid(n,e);break;case"ElementAxis":EJSS_CANVASGRAPHICS.axis(n,e);break;case"ElementCursor":EJSS_CANVASGRAPHICS.cursor(n,e);break;case"ElementPolygon":EJSS_CANVASGRAPHICS.polygon(n,e);break;case"ElementAnalyticCurve":EJSS_CANVASGRAPHICS.analyticCurve(n,e);break;case"ElementCellLattice":EJSS_CANVASGRAPHICS.cellLattice(n,e);break;case"ElementByteRaster":EJSS_CANVASGRAPHICS.byteRaster(n,e);break;case"ElementMesh":EJSS_CANVASGRAPHICS.mesh(n,e);break;case"ElementTank":EJSS_CANVASGRAPHICS.tank(n,e);break;case"ElementPipe":EJSS_CANVASGRAPHICS.pipe(n,e);break;case"ElementHistogram":EJSS_CANVASGRAPHICS.histogram(n,e);break;case"ElementScalarField":EJSS_CANVASGRAPHICS.scalarField(n,e);break;case"ElementCanvas":EJSS_CANVASGRAPHICS.canvas(n,e);break;case"ElementVideo":Console.log("Not supported ElementVideo in Canvas!")}n.restore()}},t.transformElement=function(e){null!=e.getGroup()&&t.transformElement(e.getGroup());var r=e.getTransformation();if(Array.isArray(r))console.log("Array transformations are not supported in Canvas!");else if("string"==typeof r)console.log("SVG-based transformations are not supported in Canvas!");else if("number"==typeof r){var i=e.getPixelPosition();n.translate(i[0],i[1]),n.rotate(-r),n.translate(-i[0],-i[1])}},t._24=function(e){if(e.getGutters().visible){var r=e.getInnerRect(),i=.5,o=.5,a=t.getBox(),s=a.width,l=a.height,u=e.getGuttersStyle(),g=e.getStyle();u.getDrawFill()&&(n.beginPath(),n.moveTo(i,o),n.lineTo(i,o+l),n.lineTo(i+s,o+l),n.lineTo(i+s,o),n.lineTo(i,o),n.moveTo(r.x,r.y),n.lineTo(r.x+r.width,r.y),n.lineTo(r.x+r.width,r.y+r.height),n.lineTo(r.x,r.y+r.height),n.lineTo(r.x,r.y),n.moveTo(i,o),n.closePath(),n.fillStyle=u.getFillColor(),n.fill()),u.getDrawLines()&&(n.beginPath(),n.moveTo(i,o),n.lineTo(i,o+l),n.lineTo(i+s,o+l),n.lineTo(i+s,o),n.lineTo(i,o),n.closePath(),n.lineWidth=u.getLineWidth(),n.strokeStyle=u.getLineColor(),n.stroke()),u.getDrawLines()&&(n.beginPath(),n.moveTo(r.x,r.y),n.lineTo(r.x+r.width,r.y),n.lineTo(r.x+r.width,r.y+r.height),n.lineTo(r.x,r.y+r.height),n.lineTo(r.x,r.y),n.closePath(),n.lineWidth=g.getLineWidth(),n.strokeStyle=g.getLineColor(),n.stroke())}},t.drawPanel=function(e){var r=t.getBox();n.beginPath(),n.rect(.5,.5,r.width,r.height);var i=e.getStyle();n.fillStyle=i.getFillColor(),n.fill(),i.getDrawLines()&&(n.lineWidth=i.getLineWidth(),n.strokeStyle=i.getLineColor(),n.stroke())},t};var EJSS_GRAPHICS=EJSS_GRAPHICS||{};EJSS_GRAPHICS.GraphicsUtils={getOffsetRect:function(e){var t,r,n,i,o=e.getDOMElement(),a=e.getWidth(),s=e.getHeight();t=parseFloat(a);var l=!isNaN(t)&&isFinite(a);r=parseFloat(s);var u=!isNaN(r)&&isFinite(s);if(o.getBoundingClientRect){var g=o.getElementById?o.getElementById(".myPanel"):null;if(g&&g.childElementCount>0)var c=g.getBoundingClientRect();else var c=o.getBoundingClientRect();n=c.top,i=c.left,l||(t=c.width),u||(r=c.height)}else if(void 0!==o.offsetTop)n=o.offsetTop,i=o.offsetLeft,l||(t=o.offsetWidth),u||(r=o.offsetHeight);else{for(var S=o.parentNode||document.getElementById(o.id).parentNode;S&&!S.offsetTop&&S&&!S.previousElementSibling&&!S.nextElementSibling;)S=S.parentNode;n=S.offsetTop,i=S.offsetLeft,l||(t=S.offsetWidth),u||(r=S.offsetHeight)}var d=document.body,f=document.documentElement,E=f.clientTop||d.clientTop||0,p=f.clientLeft||d.clientLeft||0;return n-=E,i-=p,{top:n,left:i,width:t,height:r,bottom:n+r,right:i+t}},drawSpring:function(e,t,r,n,i,o,a,s,l,u,g){var c=e*t,S=2*Math.PI/t;r<0&&(S*=-1);for(var d=t/2,f=[s,l,0],E=EJSS_TOOLS.Mathematics.normalTo(f),p=EJSS_TOOLS.Mathematics.normalize(EJSS_TOOLS.Mathematics.crossProduct(f,E)),h=0;h<=c;h++){var m;m=i?h<d?0:h<t?h-d:h>c-d?0:h>c-t?c-h-d:d:d;var A=Math.PI/2+h*S,P=Math.cos(A),v=Math.sin(A),y=o+h*s/c+m*r*(P*E[0]+v*p[0])/d,C=a+h*l/c+m*r*(P*E[1]+v*p[1])/d;if(0!=n){var D=m*Math.cos(2*h*Math.PI/t)/d;y+=n*D*s,C+=n*D*l}0==h?u(y,C):g(y,C)}},drawDecTicks:function(e,t,r,n,i,o,a,s,l,u){var g=EJSS_SVGGRAPHICS.Utils,c=e-r,S=e+r,d=t+n,f=t-n,E=g.crispValue(S),p=g.crispValue(f);if(s==EJSS_DRAWING2D.Axis.AXIS_VERTICAL)for(var h=p-a;h>=d-.5;h-=o)u(e,h,i,s);else for(var h=c+a;h<=E+.5;h+=o)u(h,t,i,s)},drawDecTicksText:function(e,t,r,n,i,o,a,s,l,u,g,c,S,d,f,E){var p=EJSS_SVGGRAPHICS.Utils,h=e-r,m=e+r,A=t+n,P=t-n,v=p.crispValue(m),y=p.crispValue(P);if(d==EJSS_DRAWING2D.Axis.AXIS_VERTICAL)for(var C=0,D=y-a;D>=A-.5;D-=o,C++){if(f)var I=s[1]-g-u*C;else var I=s[0]+g+u*C;var R=parseFloat(I.toFixed(l)).toFixed(l);if(S==EJSS_DRAWING2D.Axis.TICKS_DOWN){var _=i/2;E(mGroup,e+_,D,R,c,!1)}else{var _=R.length*Math.floor(c.getFontSize()/2);_+=R.length*c.getNumberLetterSpacing(),_+=Math.floor(i/2),E(e-_,D,R,c,!1)}}else for(var C=0,D=h+a;D<=v+.5;D+=o,C++){var I=s[0]+g+u*C,R=parseFloat(I.toFixed(l)).toFixed(l);if(S==EJSS_DRAWING2D.Axis.TICKS_DOWN){var T=Math.floor(i/2)+2;E(D,t-i,R,c,!0)}else{var T=c.getFontSize()+Math.floor(i/2);E(D,t+T,R,c,!0)}}},drawLogTicks:function(e,t,r,n,i,o,a,s,l,u){var g=EJSS_SVGGRAPHICS.Utils,c=e-r,S=t-n,d=g.crispValue(S);if(l==EJSS_DRAWING2D.Axis.AXIS_VERTICAL)for(var f=Math.log(a[0])/Math.log(10),E=Math.log(a[1])/Math.log(10),p=E-f,h=Math.ceil(p),m=i/p,A=0;A<=h;A++)for(var P=Math.pow(10,A+f),v=Math.pow(10,A+f+1),y=v/s,C=0;C<s-1;C++){var D=P+C*y;if(0!=D&&D>=a[0]&&D<=a[1]){var I=Math.log(D)/Math.log(10),R=d-(I-f)*m;u(e,R,o,l)}}else for(var f=Math.log(a[0])/Math.log(10),E=Math.log(a[1])/Math.log(10),p=E-f,h=Math.ceil(p),m=i/p,A=0;A<=h;A++)for(var P=Math.pow(10,A+f),v=Math.pow(10,A+f+1),y=v/s,C=0;C<s-1;C++){var D=P+C*y;if(0!=D&&D>=a[0]&&D<=a[1]){var I=Math.log(D)/Math.log(10),R=c+(I-f)*m;u(R,t,o,l)}}},drawLogTicksText:function(e,t,r,n,i,o,a,s,l,u,g,c){var S=EJSS_SVGGRAPHICS.Utils,d=e-r,f=t-n,E=S.crispValue(f);if(g==EJSS_DRAWING2D.Axis.AXIS_VERTICAL)for(var p=Math.log(a[0])/Math.log(10),h=Math.log(a[1])/Math.log(10),m=h-p,A=Math.ceil(m),P=segsize/m,v=0;v<=A;v++)for(var y=Math.pow(10,v+p),C=Math.pow(10,v+p+1),D=C/i,I=0;I<i-1;I++){var R=y+I*D;if(0!=R&&R>=a[0]&&R<=a[1]){var _=Math.log(R)/Math.log(10),T=E-(_-p)*P;if(0==I)var N=R.toExponential(s);else var N=parseFloat((R/y).toFixed(s)).toFixed(s);if(u==EJSS_DRAWING2D.Axis.TICKS_DOWN){var O=o/2;c(e+O,T,N,l,!1)}else{var O=N.length*Math.floor(l.getFontSize()/2);O+=N.length*l.getNumberLetterSpacing(),O+=Math.floor(o/2),c(e-O,T,N,l,!1)}}}else for(var p=Math.log(a[0])/Math.log(10),h=Math.log(a[1])/Math.log(10),m=h-p,A=Math.ceil(m),P=segsize/m,v=0;v<=A;v++)for(var y=Math.pow(10,v+p),C=Math.pow(10,v+p+1),D=C/i,I=0;I<i-1;I++){var R=y+I*D;if(0!=R&&R>=a[0]&&R<=a[1]){var _=Math.log(R)/Math.log(10),T=d+(_-p)*P;if(0==I)var N=R.toExponential(s);else var N=parseFloat((R/y).toFixed(s)).toFixed(s);if(u==EJSS_DRAWING2D.Axis.TICKS_DOWN){var M=Math.floor(o/2)+2;c(T,t-o,N,l,!0)}else{var M=l.getFontSize()+Math.floor(o/2);c(T,t+M,N,l,!0)}}}},drawDecGrid:function(e,t,r,n,i,o,a,s,l){var u=EJSS_SVGGRAPHICS.Utils,g=u.crispValue(e),c=u.crispValue(r),S=u.crispValue(t),d=u.crispValue(n);if(-1==a){0==o&&(o=Math.abs(S-d));for(var f=d-i;f>=t-.5;f-=o)s(e,f),l(r,f)}else{0==o&&(o=Math.abs(c-g));for(var f=e+i;f<=c+.5;f+=o)s(f,t),l(f,n)}},drawLogGrid:function(e,t,r,n,i,o,a,s,l){var u=EJSS_SVGGRAPHICS.Utils,g=u.crispValue(e),c=u.crispValue(r),S=u.crispValue(t),d=u.crispValue(n),f=Math.log(o[0])/Math.log(10),E=Math.log(o[1])/Math.log(10),p=E-f,h=Math.ceil(p);if(-1==a)var m=(d-S)/p;else var m=(c-g)/p;for(var A=0;A<=h;A++)for(var P=Math.pow(10,A+f),v=Math.pow(10,A+f+1),y=v/i,C=0;C<i-1;C++){var D=P+C*y;if(0!=D&&D>=o[0]&&D<=o[1]){var I=Math.log(D)/Math.log(10);if(-1==a){var R=d-(I-f)*m;s(g,R),l(c,R)}else{var R=g+(I-f)*m;s(R,S),l(R,d)}}}return""},buildCells:function(e,t,r,n,i){var o,a,s,l;if(null!=r&&r.length>0){var u=r.length;o=new Array(u),a=new Array(u),s=new Array(u),l=new Array(u);var g=1;null!=n&&(g=i?n[0][0].length:n[0].length);for(var c=0;c<u;c++){var S=r[c],d=S.length;o[c]=new Array(d),a[c]=new Array(d);for(var f=0;f<d;f++){var E=S[f];o[c][f]=e[E],a[c][f]=t[E]}if(null!=n)if(s[c]=new Array(d),l[c]=new Array(d),i)for(var p=n[c],f=0;f<d;f++){s[c][f]=g<=1?p[f][0]:EJSS_TOOLS.Mathematics.norm(p[f]),l[c][f]=new Array(g);for(var h=0;h<g;h++)l[c][f][h]=p[f][h]}else for(var f=0;f<d;f++){var E=S[f];s[c][f]=g<=1?n[E][0]:EJSS_TOOLS.Mathematics.norm(n[E]),l[c][f]=new Array(g);for(var h=0;h<g;h++)l[c][f][h]=n[E][h]}}}return{cellA:o,cellB:a,cellZ:s,cellVector:l}},drawPolygons:function(e,t,r,n){for(var i=e.cellA,o=e.cellB,a=e.cellZ,s=0,l=i.length;s<l;s++){var u=i[s],g=o[s],c=a[s];if(void 0!==c){for(var S=u.length,d=new Array(S),f=Number.MAX_VALUE,E=Number.MIN_VALUE,p=0;p<S;p++){var h=t.doubleToIndex(c[p]);f=Math.min(h,f),E=Math.max(h,E),d[p]=h}for(var m=t.getColorThresholds(),A=new Array(2*S),P=new Array(2*S),v=f;v<=E;v++){for(var y=0,C=0;C<S;C++){var D=(C+1)%S;if(d[C]<=v&&d[D]>=v){if(d[C]==v)A[y]=u[C],P[y]=g[C],y++;else{var I=(m[v]-c[C])/(c[D]-c[C]);A[y]=Math.round(u[C]+I*(u[D]-u[C])),P[y]=Math.round(g[C]+I*(g[D]-g[C])),y++}if(d[D]>v){var I=(m[v+1]-c[C])/(c[D]-c[C]);A[y]=Math.round(u[C]+I*(u[D]-u[C])),P[y]=Math.round(g[C]+I*(g[D]-g[C])),y++}}else if(d[C]>=v&&d[D]<=v){if(d[C]==v)A[y]=u[C],P[y]=g[C],y++;else{var I=(m[v+1]-c[C])/(c[D]-c[C]);A[y]=Math.round(u[C]+I*(u[D]-u[C])),P[y]=Math.round(g[C]+I*(g[D]-g[C])),y++}if(d[D]<v){var I=(m[v]-c[C])/(c[D]-c[C]);A[y]=Math.round(u[C]+I*(u[D]-u[C])),P[y]=Math.round(g[C]+I*(g[D]-g[C])),y++}}}y>0&&n(A,P,y,t,v)}}r(u,g)}},buildBoundary:function(e,t,r){var n,i;if(null!=r&&r.length>0){var o=r.length;n=new Array(o),i=new Array(o);for(var a=0;a<o;a++){var s=r[a],l=s.length;n[a]=new Array(l),i[a]=new Array(l);for(var u=0;u<l;u++){var g=s[u];n[a][u]=e[g],i[a][u]=t[g]}}}return{boundaryA:n,boundaryB:i}},drawBoundary:function(e,t,r,n){for(var i=e.boundaryA,o=e.boundaryB,a="black",s=0,l=i.length;s<l;s++){if(null!=t){var u=t[s];null!=r&&u<r.length&&(a=r[u])}n(i[s],o[s],a)}},drawImageField:function(e,t,r,n,i,o,a,s,l,u){for(var g=Math.round(function(e){return t+(e-n)*s}(u.xMin)),c=Math.round(function(e){return r-(e-i)*l}(u.yMax)),S=Math.round(o),d=Math.round(a),f=e.getImageData(g,c,S,d),E=this.maskRadius*s,p=0,h=0,m=0,A=0;A<S;A++)for(var P=Math.floor(A*u.nx/S),v=0;v<d;v++){var y=Math.floor(v*u.ny/d);h=0,u.data[P][y]<u.lower?(m=255,p=0):u.data[P][y]<u.center?(m=255*(u.center-u.data[P][y])/(u.center-u.lower),p=0):u.data[P][y]<u.upper?(m=0,p=255*(u.data[P][y]-u.center)/(u.upper-u.center)):(m=0,p=255),u.maskRadius>0&&Math.sqrt((A-S/2)*(A-S/2)+(v-d/2)*(v-d/2))>E&&(p=h=224,m=255);var C=4*A+4*S*v;f.data[C+0]=p,f.data[C+1]=h,f.data[C+2]=m}e.putImageData(f,g,c)}};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.analyticCurve=function(e,t){var r,n=t.getGroup();r=null!==n?e.getElementById(n.getName()):e;var i=e.getElementById(t.getName());null===i&&(i=document.createElementNS("http://www.w3.org/2000/svg","path"),i.setAttribute("id",t.getName()),r.appendChild(i));var o,a,s=t.getPixelPosition(),l=t.getPixelSizes(),u=t.getRelativePositionOffset(l),g=s[0]+u[0],c=s[1]+u[1],S=l[0]/2,d=l[1]/2,f=t.getNumPoints(),E=t.getMinimun(),p=t.getMaximun(),h=void 0===E||null===E?t.getPanel().getRealWorldXMin():E,m=void 0===p||null===p?t.getPanel().getRealWorldXMax():p,A=t.getVariable(),P=t.getFunctionX(),v=t.getFunctionY(),y=EJSS_DRAWING2D.functionsParser(),C=!1;try{o=y.parse(P)}catch(e){console.log("Analytic curve error parsing FunctionX: "+P),C=!0}if(!C)try{a=y.parse(v)}catch(e){console.log("Analytic curve error parsing FunctionY: "+v),C=!0}if(C)return void t.getController().invokeAction("OnError");var D=(m-h)/(f-1),I=[],R={},_=t.getParameters();for(var T in _)R[T]=_[T];try{for(var N=0,O=h;O<=m;O+=D){R[A]=O;var M=o.evaluate(R),b=a.evaluate(R);isNaN(M)||isNaN(b)||(I[N]=[],I[N][0]=M,I[N++][1]=b)}}catch(e){t.getController().invokeAction("OnError")}var G=function(e,t,r,n,i){for(var o="",a=0;a<e.length;a++){var s=e[a],l=t+s[0]*n,u=r+s[1]*i,g=s[2];o+=0==a||0==g?" M "+l+" "+u:" L "+l+" "+u}return o}(I,g-S,c-d,l[0],l[1]);if(""!==G){i.setAttribute("d",G);var x=t.getStyle();x.getDrawFill()?i.setAttribute("fill",x.getFillColor()):i.setAttribute("fill","none"),x.getDrawLines()?(i.setAttribute("stroke",x.getLineColor()),i.setAttribute("stroke-width",x.getLineWidth())):(i.setAttribute("stroke","none"),i.setAttribute("stroke-width",0)),i.setAttribute("shapeRendering",x.getShapeRendering());var J=x.getAttributes();for(var L in J)i.setAttribute(L,J[L])}return i};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.arrow=function(e,t){function r(t,r,n,i,a,s,l,u,g,c){var S,d,f=e.getElementById(t);null===f?(f=document.createElementNS("http://www.w3.org/2000/svg","marker"),f.setAttribute("id",t),S=document.createElementNS("http://www.w3.org/2000/svg","path"),S.setAttribute("id",t+".markpath"),f.appendChild(S),d=document.createElementNS("http://www.w3.org/2000/svg","path"),d.setAttribute("id",t+".markpath2"),f.appendChild(d),e.getElementsByTagName("defs")[0].appendChild(f)):(S=e.getElementById(t+".markpath"),d=e.getElementById(t+".markpath2"),e.getElementsByTagName("defs")[0].insertBefore(f,f));var E=i+2*s,p=a+2*s;switch(f.setAttribute("viewBox",-s+" "+-s+" "+E+" "+p),f.setAttribute("refX",i/2),f.setAttribute("refY",a/2),f.setAttribute("markerUnits","userSpaceOnUse"),f.setAttribute("markerWidth",E),f.setAttribute("markerHeight",p),f.setAttribute("orient",n),S.setAttribute("fill",l),S.setAttribute("stroke",l),S.setAttribute("stroke-width",s),S.setAttribute("style","  marker-start :none;   marker-end :none; "),d.setAttribute("fill",u),d.setAttribute("stroke",u),d.setAttribute("stroke-width",s),d.setAttribute("style","  marker-start :none;   marker-end :none; "),r){case o.TRIANGLE:var h="M 0 0 L "+i+" "+a/2+" L 0 "+a+" z";S.setAttribute("d",h);break;case o.INVTRIANGLE:var h="M "+i+" 0 L 0 "+a/2+" L "+i+" "+a+" z";S.setAttribute("d",h);break;case o.ANGLE:f.setAttribute("markerHeight",a),f.setAttribute("refX",i);var m=-(s-1),A=a+(s-1),h="M 0 "+m+" L "+i+" "+a/2+" L 0 "+A;S.setAttribute("d",h),S.setAttribute("fill","none");break;case o.INVANGLE:f.setAttribute("markerHeight",a),f.setAttribute("refX",1);var m=-(s-1),A=a+(s-1),h="M "+i+" "+m+" L 0 "+a/2+" L "+i+" "+A;S.setAttribute("d",h),S.setAttribute("fill","none");break;case o.LINE:var h="M "+i/2+" 0 L "+i/2+" "+a+" z";S.setAttribute("d",h);break;case o.RECTANGLE:var h="M 0 0 L "+i+" 0 L "+i+" "+a+" L 0 "+a+" z";S.setAttribute("d",h);break;case o.DIAMOND:var h="M "+i/2+" 0 L "+i+" "+a/2+" L "+i/2+" "+a+" L 0 "+a/2+" z";S.setAttribute("d",h);break;case o.CIRCLE:var P=i<a?i:a;P/=2;var h="M "+i/2+" "+a/2+" m "+-P+", 0 a "+P+","+P+" 0 1,0 "+2*P+",0 a "+P+","+P+" 0 1,0 "+2*-P+",0";S.setAttribute("d",h);break;case o.WEDGE:S.setAttribute("stroke-width",0),d.setAttribute("stroke-width",.5);var v=void 0===c||0===c?0:Math.atan(g/c),P=i<a?i:a;P/=2;var y=i/2,C=a/2,D=y+P*Math.cos(v),I=C-P*Math.sin(v),R=y+P*Math.cos(Math.PI/3.25-v),_=C+P*Math.sin(Math.PI/3.25-v),T=" M "+y+" "+C+" L "+D+","+I+" A "+P+","+P+" 0 0,1 "+R+","+_,N="M "+y+" "+C+" m "+-P+", 0 a "+P+","+P+" 0 1,0 "+2*P+",0 a "+P+","+P+" 0 1,0 "+2*-P+",0 ";S.setAttribute("d",N),d.setAttribute("d",T);break;case o.POINTED:f.setAttribute("refX",i),S.setAttribute("stroke-width",0);var h="M 0 0 L "+i+" "+a/2+" L 0 "+a+" L "+i/2+" "+a/2+" L 0 0 z";S.setAttribute("d",h);break;case o.CURVE:f.setAttribute("refX",i),S.setAttribute("stroke-width",0);var O=3*i,M=a/2.5,h="M 0 0  A "+O+","+O+" 1 0,0 "+i+","+a/2+" A "+O+","+O+" 1 0,0  0,"+a+" A "+M+","+M+" 1 0,0  0,"+a/2+" A "+M+","+M+" 1 0,0  0,0 z";S.setAttribute("d",h)}}var n,i=EJSS_SVGGRAPHICS.Utils,o=EJSS_DRAWING2D.Arrow,a=t.getGroup();n=null!==a?e.getElementById(a.getName()):e;var s=e.getElementById(t.getName());null===s&&(s=document.createElementNS("http://www.w3.org/2000/svg","path"),s.setAttribute("id",t.getName()),n.appendChild(s));var l=t.getPixelPosition(),u=t.getPixelSizes(),g=t.getRelativePositionOffset(u),c=l[0]+g[0],S=l[1]+g[1],d=u[0]/2,f=u[1]/2;if(0!=u[0]||0!=u[1]){if(t.getMarkEnd()!=o.NONE){var E=t.getMarkProportion()*EJSS_TOOLS.Mathematics.norm([u[0],u[1]]),p=0!=E&&E<t.getMarkEndWidth()?E:t.getMarkEndWidth(),h=0!=E&&E<t.getMarkEndHeight()?E:t.getMarkEndHeight(),m="none"==t.getMarkEndColor()?t.getStyle().getLineColor():t.getMarkEndColor(),A=t.getMarkEndStroke()<0?t.getStyle().getLineWidth():t.getMarkEndStroke();r(t.getName()+".end",t.getMarkEnd(),t.getMarkEndOrient(),p,h,A,m),s.setAttribute("marker-end","url(#"+t.getName()+".end)")}else s.removeAttribute("marker-end");if(t.getMarkMiddle()!=o.NONE){var P=t.getMarkProportion()*EJSS_TOOLS.Mathematics.norm([u[0],u[1]]),v=0!=P&&P<t.getMarkMiddleWidth()?P:t.getMarkMiddleWidth(),y=0!=P&&P<t.getMarkMiddleHeight()?P:t.getMarkMiddleHeight(),m="none"==t.getMarkMiddleColor()?t.getStyle().getLineColor():t.getMarkMiddleColor(),C="none"==t.getMarkMiddleColorSnd()?t.getStyle().getLineColor():t.getMarkMiddleColorSnd(),A=t.getMarkMiddleStroke()<0?t.getStyle().getLineWidth():t.getMarkMiddleStroke();r(t.getName()+".mid",t.getMarkMiddle(),t.getMarkMiddleOrient(),v,y,A,m,C,u[0],u[1]),s.setAttribute("marker-mid","url(#"+t.getName()+".mid)")}else s.removeAttribute("marker-mid");if(t.getMarkStart()!=o.NONE){var D=t.getMarkProportion()*EJSS_TOOLS.Mathematics.norm([u[0],u[1]]),I=0!=D&&D<t.getMarkStartWidth()?D:t.getMarkStartWidth(),R=0!=D&&D<t.getMarkStartHeight()?D:t.getMarkStartHeight(),m="none"==t.getMarkStartColor()?t.getStyle().getLineColor():t.getMarkStartColor(),A=t.getMarkStartStroke()<0?t.getStyle().getLineWidth():t.getMarkStartStroke();r(t.getName()+".start",t.getMarkStart(),t.getMarkStartOrient(),I,R,A,m),s.setAttribute("marker-start","url(#"+t.getName()+".start)")}else s.removeAttribute("marker-start")}else s.removeAttribute("marker-end"),s.removeAttribute("marker-mid"),s.removeAttribute("marker-start");var _=t.getStyle();"crispEdges"==_.getShapeRendering()?t.getMarkMiddle()!=o.NONE?s.setAttribute("d","M "+i.crispValue(c-d)+" "+i.crispValue(S-f)+" L "+i.crispValue(c)+" "+i.crispValue(S)+" L "+i.crispValue(c+d)+" "+i.crispValue(S+f)):s.setAttribute("d","M "+i.crispValue(c-d)+" "+i.crispValue(S-f)+" L "+i.crispValue(c+d)+" "+i.crispValue(S+f)):t.getMarkMiddle()!=o.NONE?s.setAttribute("d","M "+(c-d)+" "+(S-f)+" L "+c+" "+S+" L "+(c+d)+" "+(S+f)):s.setAttribute("d","M "+(c-d)+" "+(S-f)+" L "+(c+d)+" "+(S+f)),_.getDrawFill()?s.setAttribute("fill",_.getFillColor()):s.setAttribute("fill","none"),_.getDrawLines()?(s.setAttribute("stroke",_.getLineColor()),s.setAttribute("stroke-width",_.getLineWidth())):(s.setAttribute("stroke","none"),s.setAttribute("stroke-width",0)),s.setAttribute("shapeRendering",_.getShapeRendering());var T=_.getAttributes();for(var N in T)s.setAttribute(N,T[N]);return s};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.axis=function(e,t){function r(e,t,r,n,i,a){if(a==EJSS_DRAWING2D.Axis.AXIS_VERTICAL){var s=document.createElementNS("http://www.w3.org/2000/svg","path");e.appendChild(s),"crispEdges"==i.getShapeRendering()?s.setAttribute("d","M "+o.crispValue(t-n/2)+" "+o.crispValue(r)+" L "+o.crispValue(t+n/2)+" "+o.crispValue(r)):s.setAttribute("d","M "+(t-n/2)+" "+r+" L "+(t+n/2)+" "+r)}else{var s=document.createElementNS("http://www.w3.org/2000/svg","path");e.appendChild(s),"crispEdges"==i.getShapeRendering()?s.setAttribute("d","M "+o.crispValue(t)+" "+o.crispValue(r-n/2)+" L "+o.crispValue(t)+" "+o.crispValue(r+n/2)):s.setAttribute("d","M "+t+" "+(r-n/2)+" L "+t+" "+(r+n/2))}}function n(e,t,r,n,i,o){var a=document.createElementNS("http://www.w3.org/2000/svg","g");e.appendChild(a);var s=document.createElementNS("http://www.w3.org/2000/svg","text");a.appendChild(s),s.setAttribute("font-family",i.getFontFamily()),s.setAttribute("font-size",i.getFontSizeString()),s.setAttribute("fill",i.getFillColor()),s.setAttribute("stroke",i.getOutlineColor()),s.setAttribute("stroke-width",i.getFontWeight()),s.setAttribute("letterSpacing",i.getLetterSpacing()),s.textContent=n,o?t-=s.getComputedTextLength()/2+.5:r+=i.getFontSize()/2,s.setAttribute("x",t),s.setAttribute("y",r)}var i,o=EJSS_SVGGRAPHICS.Utils,a=t.getGroup();i=null!==a?e.getElementById(a.getName()):e;var s=e.getElementById(t.getName());if(null!==s&&i.removeChild(s),t.getShow()){s=document.createElementNS("http://www.w3.org/2000/svg","g"),s.setAttribute("id",t.getName()),i.appendChild(s);var l=t.getPixelPosition(),u=t.getPixelSizes(),g=t.getRelativePositionOffset(u),c=l[0]+g[0],S=l[1]+g[1],d=u[0]/2,f=u[1]/2,E=t.getStyle(),p=t.getOrient(),h=t.getInvertedScaleY();!function(e,t,r,n,i,a,s,l){var u=document.createElementNS("http://www.w3.org/2000/svg","path");e.appendChild(u),s==EJSS_DRAWING2D.Axis.AXIS_VERTICAL?(l&&(i=-i,r=-r),"crispEdges"==a.getShapeRendering()?u.setAttribute("d","M "+o.crispValue(t)+" "+o.crispValue(r-.5-i)+" L "+o.crispValue(t)+" "+o.crispValue(r-.5+i)):u.setAttribute("d","M "+t+" "+(r-i)+" L "+t+" "+(r+i))):"crispEdges"==a.getShapeRendering()?u.setAttribute("d","M "+o.crispValue(t+.5-n)+" "+o.crispValue(r)+" L "+o.crispValue(t+.5+n)+" "+o.crispValue(r)):u.setAttribute("d","M "+(t-n)+" "+r+" L "+(t+n)+" "+r)}(s,c,S,d,f,E,p,h);var m=p==EJSS_DRAWING2D.Axis.AXIS_VERTICAL?Math.abs(u[1]):Math.abs(u[0]),A=t.getTicksMode();if(A==EJSS_DRAWING2D.Axis.SCALE_LOG){var P=t.getScale();if(P[0]>0&&P[1]>0){var v=t.getTicks(),y=t.getScalePrecision(),C=t.getTicksSize();EJSS_GRAPHICS.GraphicsUtils.drawLogTicks(c,S,d,f,m,C,P,v,p,function(e,t,n,i){r(s,e,t,n,E,i)});var D=t.getFont(),I=t.getTextPosition();EJSS_GRAPHICS.GraphicsUtils.drawLogTicksText(c,S,d,f,v,C,P,y,D,I,p,function(e,t,r,i,o){n(s,e,t,r,i,o)})}}else if(A==EJSS_DRAWING2D.Axis.SCALE_NUM){var R=0,_=0;if(t.getAutoTicks())for(var T=t.getAutoStepMin(),N=t.getAutoTicksRange(),O=N.length-1;O>=0&&!(1.001*(R=Math.abs(m/N[O]))>=T);O--);else{var v=t.getTicks();0!=v?R=m/v:(R=t.getStep(),_=t.getTickStep())}var y=t.getScalePrecision(),P=t.getScale();if(0==_)var M=Math.abs((P[1]-P[0])*R/m);else{var M=_;R=Math.abs(M*m/(P[1]-P[0]))}var b=Math.pow(10,y),G=Math.round(M*b)/b;G>0&&(M=G,R=Math.abs(G*m/(P[1]-P[0])));var x=t.getFixedTick(),J=P[1];isNaN(x)||(J=x<P[0]?x+(Math.floor((P[0]-x)/M)+1)*M:x>P[1]?x-(Math.floor((x-P[1])/M)+1)*M:x);var L=Math.abs((P[0]-J)%M),w=Math.abs(L-M);(L<.001||w<.001)&&(L=0);var W=m*L/Math.abs(P[1]-P[0]),C=t.getTicksSize();EJSS_GRAPHICS.GraphicsUtils.drawDecTicks(c,S,d,f,C,R,W,p,h,function(e,t,n,i){r(s,e,t,n,E,i)});var D=t.getFont(),I=t.getTextPosition();EJSS_GRAPHICS.GraphicsUtils.drawDecTicksText(c,S,d,f,C,R,W,P,y,M,L,D,I,p,h,function(e,t,r,i,o){n(s,e,t,r,i,o)})}E.getDrawFill()?s.setAttribute("fill",E.getFillColor()):s.setAttribute("fill","none"),E.getDrawLines()?(s.setAttribute("stroke",E.getLineColor()),s.setAttribute("stroke-width",E.getLineWidth())):(s.setAttribute("stroke","none"),s.setAttribute("stroke-width",0)),s.setAttribute("shapeRendering",E.getShapeRendering());var k=E.getAttributes();for(var F in k)s.setAttribute(F,k[F])}return s};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.byteRaster=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.canvas=function(e,t){var r,n=t.getGroup();r=null!==n?e.getElementById(n.getName()):e;var i,o=e.getElementById(t.getName());null===o?(o=document.createElementNS("http://www.w3.org/2000/svg","foreignObject"),o.setAttribute("id",t.getName()),r.appendChild(o),i=document.createElement("canvas"),i.setAttribute("id",t.getName()+".canvas"),o.appendChild(i)):i=document.getElementById(t.getName()+".canvas");var a=t.getPixelPosition(),s=t.getPixelSizes(),l=t.getRelativePositionOffset(s),u=a[0]+l[0],g=a[1]+l[1];i.width=Math.abs(s[0]),i.height=Math.abs(s[1]),o.width=Math.abs(s[0]),o.height=Math.abs(s[1]);var c=Math.abs(s[0]/2),S=Math.abs(s[1]/2);o.setAttribute("x",u-c),o.setAttribute("y",g-S);var d=t.getDimensions(),f=d[1]-d[0],E=d[3]-d[2],p=Math.abs(s[0]),h=Math.abs(s[1]),m=p/f,A=h/E,P=u-p/2,v=g+h/2,y=t.getDrawables(),C=i.getContext("2d");C.fillRect(0,0,i.width-.5,i.height-.5);for(var D=0;D<y.length;D++)void 0!==y[D].imageField?EJSS_GRAPHICS.GraphicsUtils.drawImageField(C,P,v,xMin,yMin,p,h,m,A,y[D]):void 0!==y[D].run&&y[D].draw(C,P,v,xMin,yMin,p,h,m,A);var I=t.getStyle().getAttributes();for(var R in I)o.setAttribute(R,I[R]);return o};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.cellLattice=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.cursor=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.ellipse=function(e,t){var r,n=t.getGroup();r=null!==n?e.getElementById(n.getName()):e;var i=e.getElementById(t.getName());null===i&&(i=document.createElementNS("http://www.w3.org/2000/svg","ellipse"),i.setAttribute("id",t.getName()),r.appendChild(i));var o=t.getPixelPosition(),a=t.getPixelSizes(),s=t.getRelativePositionOffset(a),l=o[0]+s[0],u=o[1]+s[1],g=Math.abs(a[0]/2),c=Math.abs(a[1]/2);i.setAttribute("cx",l),i.setAttribute("cy",u),i.setAttribute("rx",g),i.setAttribute("ry",c);var S=t.getStyle();S.getDrawFill()?i.setAttribute("fill",S.getFillColor()):i.setAttribute("fill","none"),S.getDrawLines()?(i.setAttribute("stroke",S.getLineColor()),i.setAttribute("stroke-width",S.getLineWidth())):(i.setAttribute("stroke","none"),i.setAttribute("stroke-width",0)),i.setAttribute("shapeRendering",S.getShapeRendering());var d=S.getAttributes();for(var f in d)i.setAttribute(f,d[f]);return i};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.grid=function(e,t){var r,n=t.getGroup();r=null!==n?e.getElementById(n.getName()):e;var i=e.getElementById(t.getName());null!==i&&r.removeChild(i),i=document.createElementNS("http://www.w3.org/2000/svg","g"),i.setAttribute("id",t.getName()),r.appendChild(i);var o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("id",t.getName()+"X"),i.appendChild(o);var a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("id",t.getName()+"Y"),i.appendChild(a);var s=t.getPixelPosition(),l=t.getPixelSizes(),u=t.getRelativePositionOffset(l),g=s[0]+u[0],c=s[1]+u[1],S=l[0]/2,d=l[1]/2,f=t.getShowX(),E=t.getShowY(),p="",h="";if(f){var m=t.getTicksXMode();if(m==EJSS_DRAWING2D.Grid.SCALE_LOG){var A=t.getScaleX();if(A[0]>0&&A[1]>0){var P=t.getTicksX(),v=g-S,y=g+S,C=c+d,D=c-d;EJSS_GRAPHICS.GraphicsUtils.drawLogGrid(v,C,y,D,P,A,1,function(e,t){p+=" M "+e+" "+t},function(e,t){p+=" L "+e+" "+t})}}else if(m==EJSS_DRAWING2D.Grid.SCALE_NUM){var I=0,R=0;if(t.getAutoTicksX())for(var _=t.getAutoStepXMin(),T=t.getAutoTicksRangeX(),N=T.length-1;N>=0&&!((I=Math.abs(l[0]/T[N]))>=_);N--);else{var P=t.getTicksX();0!=P?I=Math.abs(l[0]/P):(I=t.getStepX(),R=t.getTickStepX())}var O=t.getScalePrecisionX(),A=t.getScaleX();if(0==R)var M=Math.abs((A[1]-A[0])*I/l[0]);else{var M=R;I=Math.abs(M*l[0]/(A[1]-A[0]))}var b=Math.pow(10,O),G=Math.round(M*b)/b;G>0&&(M=G,I=Math.abs(G*l[0]/(A[1]-A[0])));var x=t.getFixedTickX(),J=A[1];isNaN(x)||(J=x<A[0]?x+(Math.floor((A[0]-x)/M)+1)*M:x>A[1]?x-(Math.floor((x-A[1])/M)+1)*M:x);var L=Math.abs((A[0]-J)%M),w=Math.abs(L-M);(L<.001||w<.001)&&(L=0);var W=Math.abs(l[0]*L/(A[1]-A[0])),v=g-S,y=g+S,C=c+d,D=c-d;EJSS_GRAPHICS.GraphicsUtils.drawDecGrid(v,C,y,D,W,I,1,function(e,t){p+=" M "+e+" "+t},function(e,t){p+=" L "+e+" "+t})}}if(E){var k=t.getTicksYMode();if(k==EJSS_DRAWING2D.Grid.SCALE_LOG){var F=t.getScaleY();if(F[0]>0&&F[1]>0){var V=t.getTicksY(),v=g-S,y=g+S,C=c+d,D=c-d;EJSS_GRAPHICS.GraphicsUtils.drawLogGrid(v,C,y,D,V,F,-1,function(e,t){h+=" M "+e+" "+t},function(e,t){h+=" L "+e+" "+t})}}else if(k==EJSS_DRAWING2D.Grid.SCALE_NUM){var B=0,z=0;if(t.getAutoTicksY())for(var H=t.getAutoStepYMin(),Y=t.getAutoTicksRangeY(),N=Y.length-1;N>=0&&!((B=Math.abs(l[1]/Y[N]))>=H);N--);else{var V=t.getTicksY();0!=V?B=Math.abs(l[1]/V):(B=t.getStepY(),z=t.getTickStepY())}var U=t.getScalePrecisionY(),F=t.getScaleY();if(0==z)var X=Math.abs((F[1]-F[0])*B/l[1]);else{var X=z;B=Math.abs(X*l[1]/(F[1]-F[0]))}var Z=Math.pow(10,U),j=Math.round(X*Z)/Z;j>0&&(X=j,B=Math.abs(j*l[1]/(F[1]-F[0])));var x=t.getFixedTickY(),J=F[1];isNaN(x)||(J=x<F[0]?x+(Math.floor((F[0]-x)/X)+1)*X:x>F[1]?x-(Math.floor((x-F[1])/X)+1)*X:x);var L=Math.abs((F[0]-J)%X),w=Math.abs(L-X);(L<.001||w<.001)&&(L=0);var K=Math.abs(l[1]*L/(F[1]-F[0])),v=g-S,y=g+S,C=c+d,D=c-d;EJSS_GRAPHICS.GraphicsUtils.drawDecGrid(v,C,y,D,K,B,-1,function(e,t){h+=" M "+e+" "+t},function(e,t){h+=" L "+e+" "+t})}}p.length>0&&(o.setAttribute("d",p),o.setAttribute("shapeRendering",t.getShapeRenderingX()),o.setAttribute("stroke",t.getLineColorX()),o.setAttribute("stroke-width",t.getLineWidthX())),h.length>0&&(a.setAttribute("d",h),a.setAttribute("shapeRendering",t.getShapeRenderingY()),a.setAttribute("stroke",t.getLineColorY()),a.setAttribute("stroke-width",t.getLineWidthY()));var q=t.getStyle().getAttributes();for(var Q in q)o.setAttribute(Q,q[Q]),a.setAttribute(Q,q[Q]);return i};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.group=function(e,t){var r,n=t.getGroup();r=null!==n?e.getElementById(n.getName()):e;var i=e.getElementById(t.getName());return null===i&&(i=document.createElementNS("http://www.w3.org/2000/svg","g"),i.setAttribute("id",t.getName()),r.appendChild(i)),i};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.histogram=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.image=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.mesh=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.pipe=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.point=function(e,t){var r,n=t.getGroup();r=null!==n?e.getElementById(n.getName()):e;var i=e.getElementById(t.getName());null===i&&(i=document.createElementNS("http://www.w3.org/2000/svg","ellipse"),i.setAttribute("id",t.getName()),r.appendChild(i));var o=t.getPixelPosition(),a=t.getPixelSizes(),s=t.getRelativePositionOffset(a),l=o[0]+s[0],u=o[1]+s[1];i.setAttribute("cx",l),i.setAttribute("cy",u),i.setAttribute("rx",2),i.setAttribute("ry",2);var g=t.getStyle();i.setAttribute("fill",g.getFillColor());var c=g.getAttributes();for(var S in c)i.setAttribute(S,c[S]);return i};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.polygon=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.rectangle=function(e,t){var r,n=EJSS_SVGGRAPHICS.Utils,i=t.getGroup();r=null!==i?e.getElementById(i.getName()):e;var o=e.getElementById(t.getName());null===o&&(o=document.createElementNS("http://www.w3.org/2000/svg","path"),o.setAttribute("id",t.getName()),r.appendChild(o));var a=t.getPixelPosition(),s=t.getPixelSizes(),l=t.getRelativePositionOffset(s),u=a[0]+l[0],g=a[1]+l[1],c=s[0]/2,S=s[1]/2,d=t.getStyle();"crispEdges"==d.getShapeRendering()?o.setAttribute("d","M "+n.crispValue(u-c)+" "+n.crispValue(g+S)+" L "+n.crispValue(u+c)+" "+n.crispValue(g+S)+" L "+n.crispValue(u+c)+" "+n.crispValue(g-S)+" L "+n.crispValue(u-c)+" "+n.crispValue(g-S)+" z"):o.setAttribute("d","M "+(u-c)+" "+(g+S)+" L "+(u+c)+" "+(g+S)+" L "+(u+c)+" "+(g-S)+" L "+(u-c)+" "+(g-S)+" z"),d.getDrawFill()?o.setAttribute("fill",d.getFillColor()):o.setAttribute("fill","none"),d.getDrawLines()?(o.setAttribute("stroke",d.getLineColor()),o.setAttribute("stroke-width",d.getLineWidth())):(o.setAttribute("stroke","none"),o.setAttribute("stroke-width",0)),o.setAttribute("shapeRendering",d.getShapeRendering());var f=d.getAttributes();for(var E in f)o.setAttribute(E,f[E]);return o};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.roundRectangle=function(e,t){var r,n=t.getGroup();r=null!==n?e.getElementById(n.getName()):e;var i=e.getElementById(t.getName());null===i&&(i=document.createElementNS("http://www.w3.org/2000/svg","rect"),i.setAttribute("id",t.getName()),r.appendChild(i));var o=t.getPixelPosition(),a=t.getPixelSizes(),s=t.getRelativePositionOffset(a),l=o[0]+s[0],u=o[1]+s[1],g=Math.abs(a[0]/2),c=Math.abs(a[1]/2),S=Math.abs(t.getCornerRadius());i.setAttribute("x",l-g),i.setAttribute("y",u-c),i.setAttribute("width",Math.abs(a[0])),i.setAttribute("height",Math.abs(a[1])),i.setAttribute("rx",S),i.setAttribute("ry",S);var d=t.getStyle();d.getDrawFill()?i.setAttribute("fill",d.getFillColor()):i.setAttribute("fill","none"),d.getDrawLines()?(i.setAttribute("stroke",d.getLineColor()),i.setAttribute("stroke-width",d.getLineWidth())):(i.setAttribute("stroke","none"),i.setAttribute("stroke-width",0)),i.setAttribute("shapeRendering",d.getShapeRendering());var f=d.getAttributes();for(var E in f)i.setAttribute(E,f[E]);return i};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.scalarField=function(e,t){var r,n=t.getGroup();r=null!==n?e.getElementById(n.getName()):e;var i,o=e.getElementById(t.getName());null===o?(o=document.createElementNS("http://www.w3.org/2000/svg","foreignObject"),o.setAttribute("id",t.getName()),r.appendChild(o),i=document.createElement("scalarField"),i.setAttribute("id",t.getName()+".scalarField"),o.appendChild(i)):i=document.getElementById(t.getName()+".scalarField");var a=t.getPixelPosition(),s=t.getPixelSizes(),l=t.getRelativePositionOffset(s),u=a[0]+l[0],g=a[1]+l[1];i.width=Math.abs(s[0]),i.height=Math.abs(s[1]),o.width=Math.abs(s[0]),o.height=Math.abs(s[1]);var c=Math.abs(s[0]/2),S=Math.abs(s[1]/2);o.setAttribute("x",u-c),o.setAttribute("y",g-S);var d=t.getMaximumX()-t.getMinimumX(),f=t.getMaximumY()-t.getMinimumY(),E=Math.abs(s[0]),p=Math.abs(s[1]),h=E/d,m=p/f,A=u-E/2,P=g+p/2,v=i.getContext("2d");v.fillRect(0,0,i.width-.5,i.height-.5),EJSS_GRAPHICS.GraphicsUtils.drawImageField(v,A,P,t.getMinimumX(),t.getMinimumY(),E,p,h,m,{data:t.getData()});var y=t.getStyle().getAttributes();for(var C in y)o.setAttribute(C,y[C]);return o};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.segment=function(e,t){var r,n=EJSS_SVGGRAPHICS.Utils,i=t.getGroup();r=null!==i?e.getElementById(i.getName()):e;var o=e.getElementById(t.getName());null===o&&(o=document.createElementNS("http://www.w3.org/2000/svg","path"),o.setAttribute("id",t.getName()),r.appendChild(o));var a=t.getPixelPosition(),s=t.getPixelSizes(),l=t.getRelativePositionOffset(s),u=a[0]+l[0],g=a[1]+l[1],c=s[0]/2,S=s[1]/2,d=t.getStyle();"crispEdges"==d.getShapeRendering()?o.setAttribute("d","M "+n.crispValue(u-c)+" "+n.crispValue(g-S)+" L "+n.crispValue(u+c)+" "+n.crispValue(g+S)):o.setAttribute("d","M "+(u-c)+" "+(g-S)+" L "+(u+c)+" "+(g+S)),d.getDrawFill()?o.setAttribute("fill",d.getFillColor()):o.setAttribute("fill","none"),d.getDrawLines()?(o.setAttribute("stroke",d.getLineColor()),o.setAttribute("stroke-width",d.getLineWidth())):(o.setAttribute("stroke","none"),o.setAttribute("stroke-width",0)),o.setAttribute("shapeRendering",d.getShapeRendering());var f=d.getAttributes();for(var E in f)o.setAttribute(E,f[E]);return o};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.spring=function(e,t){var r,n=t.getGroup();r=null!==n?e.getElementById(n.getName()):e;var i=e.getElementById(t.getName());null===i&&(i=document.createElementNS("http://www.w3.org/2000/svg","path"),i.setAttribute("id",t.getName()),r.appendChild(i));var o=t.getPixelPosition(),a=t.getPixelSizes(),s=t.getRelativePositionOffset(a),l=o[0]+s[0],u=o[1]+s[1],g=a[0]/2,c=a[1]/2,S=t.getGroupPanel().toPixelMod([t.getRadius(),0])[0],d="";if(EJSS_GRAPHICS.GraphicsUtils.drawSpring(t.getLoops(),t.getPointsPerLoop(),S,t.getSolenoid(),t.getThinExtremes(),l-g,u-c,a[0],a[1],function(e,t){d+=" M "+e+" "+t},function(e,t){d+=" L "+e+" "+t}),""!==d){i.setAttribute("d",d);var f=t.getStyle();f.getDrawFill()?i.setAttribute("fill",f.getFillColor()):i.setAttribute("fill","none"),f.getDrawLines()?(i.setAttribute("stroke",f.getLineColor()),i.setAttribute("stroke-width",f.getLineWidth())):(i.setAttribute("stroke","none"),i.setAttribute("stroke-width",0)),i.setAttribute("shapeRendering",f.getShapeRendering());var E=f.getAttributes();for(var p in E)i.setAttribute(p,E[p])}return i};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.tank=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.text=function(e,t){var r,n=t.getGroup();r=null!==n?e.getElementById(n.getName()):e;var o,a,s,l=e.getElementById(t.getName());null===l?(l=document.createElementNS("http://www.w3.org/2000/svg","g"),l.setAttribute("id",t.getName()),r.appendChild(l),o=document.createElementNS("http://www.w3.org/2000/svg","g"),o.setAttribute("id",t.getName()+".inner"),l.appendChild(o),s=document.createElementNS("http://www.w3.org/2000/svg","path"),s.setAttribute("id",t.getName()+".box"),o.appendChild(s),a=document.createElementNS("http://www.w3.org/2000/svg","text"),a.setAttribute("id",t.getName()+".text"),o.appendChild(a)):(o=e.getElementById(t.getName()+".inner"),a=e.getElementById(t.getName()+".text"),s=e.getElementById(t.getName()+".box"));var u=t.getFont();a.setAttribute("font-style",u.getFontStyle()),a.setAttribute("font-weight",u.getFontWeight()),a.setAttribute("font-size",u.getFontSizeString()),a.setAttribute("font-family",u.getFontFamily()),a.setAttribute("fill",u.getFillColor()),a.setAttribute("stroke",u.getOutlineColor()),a.setAttribute("stroke-width",u.getOutlineWidth()),a.setAttribute("letterSpacing",u.getLetterSpacing());var g=t.getText();void 0!==g&&null!=g||(g="");var c=g.split("\n"),S=0,d=u.getFontSize();for(a.textContent="",a.setAttribute("visibility","hidden"),i=0;i<c.length;i++){a.textContent=c[i];var f=a.getComputedTextLength();f>S&&(S=f),i>0&&(d+=1.8*u.getFontSize())}a.setAttribute("visibility","inherit"),a.textContent="";var E=t.getPixelPosition(),p=t.getFramed()?4:0,h=[S+2*p,d/1.5+2*p],m=EJSS_DRAWING2D.Element.getSWRelativePositionOffset(t.getRelativePosition(),h[0],h[1]),A=t.getMarginX(),P=t.getMarginY(),v=E[0]+m[0]+A+p,y=E[1]+m[1]+P-p;for(a.setAttribute("x",v),a.setAttribute("y",y),i=c.length-1;i>=0;i--){var C=document.createElementNS("http://www.w3.org/2000/svg","tspan");i==c.length-1?C.setAttribute("y",y):C.setAttribute("dy","-1.2em"),C.setAttribute("x",v),C.textContent=c[i],a.appendChild(C)}if(t.getFramed()){var D=p,I=p,R=h[0]-2*p,_=h[1]-2*p;if(R>0){var T=y+D,N=y-_-D,O=v-I,M=v+R+D;s.setAttribute("d","M "+O+" "+T+" L "+M+" "+T+" L "+M+" "+N+" L "+O+" "+N+" z");var b=t.getStyle();b.getDrawFill()?s.setAttribute("fill",b.getFillColor()):s.setAttribute("fill","none"),b.getDrawLines()?(s.setAttribute("stroke",b.getLineColor()),s.setAttribute("stroke-width",b.getLineWidth())):(s.setAttribute("stroke","none"),s.setAttribute("stroke-width",0));var G=b.getAttributes();for(var x in G)mShape.setAttribute(x,G[x])}else s.setAttribute("stroke","none"),s.setAttribute("fill","none")}var J=0;switch(t.getWritingMode()){case EJSS_DRAWING2D.Text.MODE_TOPDOWN:J=90;break;case EJSS_DRAWING2D.Text.MODE_RIGTHLEFT:J=180;break;case EJSS_DRAWING2D.Text.MODE_DOWNTOP:J=270;break;case EJSS_DRAWING2D.Text.MODE_LEFTRIGHT:J=0}return o.setAttribute("transform","rotate("+J+" "+(E[0]+A)+" "+(E[1]+P)+")"),l};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.trace=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.trail=function(e,t){function r(e,t,r,n,i,o,a,s){if(!(r<=0)){var l=document.createElementNS("http://www.w3.org/2000/svg","path");e.appendChild(l);for(var u="",g=0;g<r;g++){var c=t[g],S=i+c[0]*a,d=o+c[1]*s,f=c[2];u+=0==g||0==f?" M "+S+" "+d:" L "+S+" "+d}l.setAttribute("d",u),n.getDrawFill()?l.setAttribute("fill",n.getFillColor()):l.setAttribute("fill","none"),n.getDrawLines()?(l.setAttribute("stroke",n.getLineColor()),l.setAttribute("stroke-width",n.getLineWidth())):(l.setAttribute("stroke","none"),l.setAttribute("stroke-width",0)),l.setAttribute("shapeRendering",n.getShapeRendering());var E=n.getAttributes();for(var p in E)l.setAttribute(p,E[p])}}var n,i=t.getGroup();n=null!==i?e.getElementById(i.getName()):e;var o=document.createElementNS("http://www.w3.org/2000/svg","g");n.appendChild(o);var a=e.getElementById(t.getName());null!==a&&(n.insertBefore(o,a),n.removeChild(a)),o.setAttribute("id",t.getName());var s=t.getPixelPosition(),l=t.getPixelSizes(),u=t.getRelativePositionOffset(l),g=s[0]+u[0],c=s[1]+u[1],S=l[0]/2,d=l[1]/2,f=g-S,E=c-d,p=l[0],h=l[1],m=t.getSegmentsCount();if(m>0)for(var A=0;A<m;A++){var P=t.getSegmentPoints(A).length;r(o,t.getSegmentPoints(A),P,t.getSegmentStyle(A),f,E,p,h)}var P=t.getCurrentPoints().length;return r(o,t.getCurrentPoints(),P,t.getStyle(),f,E,p,h),o};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.Utils={},EJSS_SVGGRAPHICS.Utils.crispValue=function(e){return Math.round(+e.toFixed(4)+.5)-.5},EJSS_SVGGRAPHICS.Utils.crispTop=function(e){return Math.round(+e.toFixed(4)+.5)-.5},EJSS_SVGGRAPHICS.Utils.round=function(e){return+e.toFixed(4)},EJSS_SVGGRAPHICS.Utils.hsl2rgb=function(e){var t,r,n,i=e[0],o=e[1],a=e[2],s=(1-Math.abs(2*a-1))*o,l=i/60,u=s*(1-Math.abs(l%2-1));void 0===i||isNaN(i)||null===i?t=r=n=0:l>=0&&l<1?(t=s,r=u,n=0):l>=1&&l<2?(t=u,r=s,n=0):l>=2&&l<3?(t=0,r=s,n=u):l>=3&&l<4?(t=0,r=u,n=s):l>=4&&l<5?(t=u,r=0,n=s):l>=5&&l<6&&(t=s,r=0,n=u);var g,c,S,d=a-s/2;return g=255*(t+d),c=255*(r+d),S=255*(n+d),g=Math.round(g),c=Math.round(c),S=Math.round(S),{r:g,g:c,b:S}},EJSS_SVGGRAPHICS.Utils.PNGCanvasWorker=function(e){for(var t=e.data.params.imageData,r=e.data.params.width,n=e.data.params.height,i=(e.data.params.depth,e.data.params.data),o=e.data.params.colors,a=e.data.id,s=o[0],l=o[o.length-1],u=0;u<r;u++)for(var g=0;g<n;g++){var a=i[u][n-g-1],c=a<0?s:a<o.length?o[a]:l;void 0===c&&(c=s),"rgb"==c.substring(0,3)?rgb=function(e){
var e=e.substring(4,e.length-1).replace(/ /g,"").split(",");return{r:e[0],g:e[1],b:e[2]}}(c):"hsl"==c.substring(0,3)&&(rgb=EJSS_SVGGRAPHICS.Utils.hsl2rgb(function(e){var e=e.substring(4,e.length-1).replace(/ /g,"").replace(/%/g,"").split(",");return{h:e[0],s:e[1]/100,l:e[2]/100}}(c))),function(e,t,r,n,i,o,s){a=4*(t+r*e.width),e.data[a+0]=n,e.data[a+1]=i,e.data[a+2]=o,e.data[a+3]=s}(t,u,g,rgb.r,rgb.g,rgb.b,255)}self.postMessage({result:t,id:a})},EJSS_SVGGRAPHICS.Utils.PNGCanvasNoWorker=function(e,t,r,n,i,o){for(var a=o[0],s=o[o.length-1],l=0;l<t;l++)for(var u=0;u<r;u++){var g=i[l][r-u-1],c=g<0?a:g<o.length?o[g]:s;void 0===c&&(c=a),"rgb"==c.substring(0,3)?rgb=function(e){var e=e.substring(4,e.length-1).replace(/ /g,"").split(",");return{r:e[0],g:e[1],b:e[2]}}(c):"hsl"==c.substring(0,3)&&(rgb=EJSS_SVGGRAPHICS.Utils.hsl2rgb(function(e){var e=e.substring(4,e.length-1).replace(/ /g,"").replace(/%/g,"").split(",");return{h:e[0],s:e[1]/100,l:e[2]/100}}(c))),function(e,t,r,n,i,o,a){g=4*(t+r*e.width),e.data[g+0]=n,e.data[g+1]=i,e.data[g+2]=o,e.data[g+3]=a}(e,l,u,rgb.r,rgb.g,rgb.b,255)}},EJSS_SVGGRAPHICS.Utils.PNGCanvas=function(e,t,r,n,i,o){var a=document.createElement("canvas");a.setAttribute("width",e),a.setAttribute("height",t);var s=a.getContext("2d"),l=s.createImageData(e,t);EJSS_TOOLS.Worker.runFunction?EJSS_TOOLS.Worker.runFunction("PNGCanvasWorker",EJSS_SVGGRAPHICS.Utils.PNGCanvasWorker,{imageData:l,width:e,height:t,depth:r,data:n,colors:i},function(e){s.putImageData(e.result,0,0),o(a.toDataURL())}):(EJSS_SVGGRAPHICS.Utils.PNGCanvasNoWorker(l,e,t,r,n,i),s.putImageData(l,0,0),o(a.toDataURL()))},EJSS_SVGGRAPHICS.Utils.ImageDataCanvas=function(e,t,r,n,i,o){var a=document.createElement("canvas");a.setAttribute("width",e),a.setAttribute("height",t);var s=a.getContext("2d"),l=s.createImageData(e,t);EJSS_TOOLS.Worker.runFunction("PNGCanvasWorker",EJSS_SVGGRAPHICS.Utils.PNGCanvasWorker,{imageData:l,width:e,height:t,depth:r,data:n,colors:i},function(e){o(e)})};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.video=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.wheel=function(e,t){var r,n=t.getGroup();r=null!==n?e.getElementById(n.getName()):e;var i,o,a=e.getElementById(t.getName());null===a?(a=document.createElementNS("http://www.w3.org/2000/svg","g"),a.setAttribute("id",t.getName()),r.appendChild(a),i=document.createElementNS("http://www.w3.org/2000/svg","ellipse"),i.setAttribute("id",t.getName()+".circle"),a.appendChild(i),o=document.createElementNS("http://www.w3.org/2000/svg","path"),o.setAttribute("id",t.getName()+".cross"),a.appendChild(o)):(i=e.getElementById(t.getName()+".circle"),o=e.getElementById(t.getName()+".cross"));var s=t.getPixelPosition(),l=t.getPixelSizes(),u=t.getRelativePositionOffset(l),g=s[0]+u[0],c=s[1]+u[1],S=l[0]/2,d=l[1]/2;i.setAttribute("cx",g),i.setAttribute("cy",c),i.setAttribute("rx",Math.abs(S)),i.setAttribute("ry",Math.abs(d)),o.setAttribute("d","M "+(g-S)+" "+c+" L "+(g+S)+" "+c+" M "+g+" "+(c-d)+" L "+g+" "+(c+d));var f=t.getStyle();f.getDrawFill()?a.setAttribute("fill",f.getFillColor()):a.setAttribute("fill","none"),f.getDrawLines()?(a.setAttribute("stroke",f.getLineColor()),a.setAttribute("stroke-width",f.getLineWidth())):(a.setAttribute("stroke","none"),a.setAttribute("stroke-width",0)),a.setAttribute("shapeRendering",f.getShapeRendering());var E=f.getAttributes();for(var p in E)a.setAttribute(p,E[p]);return a};var EJSS_GRAPHICS=EJSS_GRAPHICS||{};EJSS_GRAPHICS.SvgGraphics={getOffsetRect:function(e){return EJSS_GRAPHICS.GraphicsUtils.getOffsetRect(e)}},EJSS_GRAPHICS.svgGraphics=function(e){var t=EJSS_INTERFACE.svgGraphics(e),r=t.getDOMElement(),n=document.createElementNS("http://www.w3.org/2000/svg","defs");return r.appendChild(n),t.getEventContext=function(){return r},t.getBox=function(){var e=EJSS_GRAPHICS.CanvasGraphics.getOffsetRect(t);return e.width-=1,e.height-=1,e},t.remove=function(e){var t=r.getElementById(e);return null!==t&&(r.removeChild(t),!0)},t.reset=function(){for(;r.firstChild;)r.removeChild(r.firstChild);r.appendChild(n)},t.getDefs=function(){return n},t.draw=function(e,n){for(var i=0,o=e.length;i<o;i++){var a=e[i];if(a.getElements)for(var s=a.getLastElements(),l=0,u=s.length;l<u;l++){var g=r.getElementById(s[l].getName());g&&g.parentNode.removeChild(g)}if(n||a.isChanged()||a.isGroupChanged()||a.isMustProject()){var c=t.drawElement(a);void 0!==c&&null!=c&&t.transformElement(a,c)}}},t.drawElement=function(e){var t=EJSS_DRAWING2D.Shape,n=null;switch(e._23()){case"ElementCustom":var i=e.getFunction();i&&(n=i(r,e));break;case"ElementGroup":n=EJSS_SVGGRAPHICS.group(r,e);break;case"ElementShape":switch(e.getShapeType()){default:case t.ELLIPSE:n=EJSS_SVGGRAPHICS.ellipse(r,e);break;case t.RECTANGLE:n=EJSS_SVGGRAPHICS.rectangle(r,e);break;case t.ROUND_RECTANGLE:n=EJSS_SVGGRAPHICS.roundRectangle(r,e);break;case t.WHEEL:n=EJSS_SVGGRAPHICS.wheel(r,e);break;case t.NONE:case t.POINT:n=EJSS_SVGGRAPHICS.point(r,e)}break;case"ElementSegment":n=EJSS_SVGGRAPHICS.segment(r,e);break;case"ElementImage":n=EJSS_SVGGRAPHICS.image(r,e);break;case"ElementVideo":n=EJSS_SVGGRAPHICS.video(r,e);break;case"ElementArrow":n=EJSS_SVGGRAPHICS.arrow(r,e);break;case"ElementText":n=EJSS_SVGGRAPHICS.text(r,e);break;case"ElementSpring":n=EJSS_SVGGRAPHICS.spring(r,e);break;case"ElementTrail":n=EJSS_SVGGRAPHICS.trail(r,e);break;case"ElementTrace":n=EJSS_SVGGRAPHICS.trace(r,e);break;case"ElementGrid":n=EJSS_SVGGRAPHICS.grid(r,e);break;case"ElementAxis":n=EJSS_SVGGRAPHICS.axis(r,e);break;case"ElementCursor":n=EJSS_SVGGRAPHICS.cursor(r,e);break;case"ElementPolygon":n=EJSS_SVGGRAPHICS.polygon(r,e);break;case"ElementAnalyticCurve":n=EJSS_SVGGRAPHICS.analyticCurve(r,e);break;case"ElementCellLattice":n=EJSS_SVGGRAPHICS.cellLattice(r,e);break;case"ElementByteRaster":n=EJSS_SVGGRAPHICS.byteRaster(r,e);break;case"ElementMesh":n=EJSS_SVGGRAPHICS.mesh(r,e);break;case"ElementTank":n=EJSS_SVGGRAPHICS.tank(r,e);break;case"ElementPipe":n=EJSS_SVGGRAPHICS.pipe(r,e);break;case"ElementHistogram":n=EJSS_SVGGRAPHICS.histogram(r,e);break;case"ElementScalarField":n=EJSS_SVGGRAPHICS.scalarField(r,e);break;case"ElementCanvas":n=EJSS_SVGGRAPHICS.canvas(r,e)}return n&&(e.isGroupVisible()?n.setAttribute("visibility","visible"):n.setAttribute("visibility","hidden")),n},t.transformElement=function(e,t){var r,n=e.getTransformation();if(Array.isArray(n))r="matrix("+n[0]+" "+n[1]+" "+n[2]+" "+n[3]+" "+n[4]+" "+n[5]+")";else if("string"==typeof n)r=n;else if("number"==typeof n){var i=e.getPixelPosition(),o=EJSS_TOOLS.Mathematics.degrees(-n);r="rotate("+o+" "+i[0]+" "+i[1]+")"}r&&t.setAttribute("transform",r)},t._24=function(e){if(e.getGutters().visible){var n=EJSS_SVGGRAPHICS.Utils,i=r.getElementById(".myGutters"),o=r.getElementById(".myOuterBorder"),a=r.getElementById(".myInnerBorder");null===i&&(i=document.createElementNS("http://www.w3.org/2000/svg","path"),i.setAttribute("id",".myGutters"),i.setAttribute("stroke","none"),i.setAttribute("stroke-width",0),r.appendChild(i),o=document.createElementNS("http://www.w3.org/2000/svg","path"),o.setAttribute("id",".myOuterBorder"),o.setAttribute("fill","none"),r.appendChild(o),a=document.createElementNS("http://www.w3.org/2000/svg","path"),a.setAttribute("id",".myInnerBorder"),a.setAttribute("fill","none"),r.appendChild(a));var s=e.getInnerRect(),l=.5,u=.5,g=t.getBox(),c=g.width,S=g.height,d=e.getGuttersStyle(),f=e.getStyle();"crispEdges"==f.getShapeRendering()?(i.setAttribute("d","M "+n.crispValue(l)+" "+n.crispValue(u)+" L "+n.crispValue(l)+" "+n.crispValue(u+S)+" L "+n.crispValue(l+c)+" "+n.crispValue(u+S)+" L "+n.crispValue(l+c)+" "+n.crispValue(u)+" L "+n.crispValue(l)+" "+n.crispValue(u)+" M "+n.crispValue(s.x)+" "+n.crispValue(s.y)+" L "+n.crispValue(s.x+s.width)+" "+n.crispValue(s.y)+" L "+n.crispValue(s.x+s.width)+" "+n.crispValue(s.y+s.height)+" L "+n.crispValue(s.x)+" "+n.crispValue(s.y+s.height)+" L "+n.crispValue(s.x)+" "+n.crispValue(s.y)+" z"),o.setAttribute("d","M "+n.crispValue(l)+" "+n.crispValue(u)+" L "+n.crispValue(l)+" "+n.crispValue(u+S)+" L "+n.crispValue(l+c)+" "+n.crispValue(u+S)+" L "+n.crispValue(l+c)+" "+n.crispValue(u)+" L "+n.crispValue(l)+" "+n.crispValue(u)+" z"),a.setAttribute("d","M "+n.crispValue(s.x)+" "+n.crispValue(s.y)+" L "+n.crispValue(s.x+s.width)+" "+n.crispValue(s.y)+" L "+n.crispValue(s.x+s.width)+" "+n.crispValue(s.y+s.height)+" L "+n.crispValue(s.x)+" "+n.crispValue(s.y+s.height)+" L "+n.crispValue(s.x)+" "+n.crispValue(s.y)+" z")):(i.setAttribute("d","M 0.5 0.5 L 0.5 "+(u+S)+" L "+(l+c)+" "+(u+S)+" L "+(l+c)+" "+u+" L "+l+" "+u+" M "+s.x+" "+s.y+" L "+(s.x+s.width)+" "+s.y+" L "+(s.x+s.width)+" "+(s.y+s.height)+" L "+s.x+" "+(s.y+s.height)+" L "+s.x+" "+s.y+" z"),o.setAttribute("d","M 0.5 0.5 L 0.5 "+(u+S)+" L "+(l+c)+" "+(u+S)+" L "+(l+c)+" "+u+" L "+l+" "+u+" z"),a.setAttribute("d","M "+s.x+" "+s.y+" L "+(s.x+s.width)+" "+s.y+" L "+(s.x+s.width)+" "+(s.y+s.height)+" L "+s.x+" "+(s.y+s.height)+" L "+s.x+" "+s.y+" z")),d.getDrawFill()?i.setAttribute("fill",d.getFillColor()):i.setAttribute("fill","none"),d.getDrawLines()?(o.setAttribute("stroke",d.getLineColor()),o.setAttribute("stroke-width",d.getLineWidth())):(o.setAttribute("stroke","none"),o.setAttribute("stroke-width",0)),f.getDrawLines()?(a.setAttribute("stroke",f.getLineColor()),a.setAttribute("stroke-width",f.getLineWidth())):(a.setAttribute("stroke","none"),a.setAttribute("stroke-width",0)),i.setAttribute("shapeRendering",f.getShapeRendering()),o.setAttribute("shapeRendering",d.getShapeRendering()),a.setAttribute("shapeRendering",f.getShapeRendering())}},t.drawPanel=function(e){var n=EJSS_SVGGRAPHICS.Utils,i=r.getElementById(".myPanel");null===i&&(i=document.createElementNS("http://www.w3.org/2000/svg","path"),i.setAttribute("id",".myPanel"),r.appendChild(i));var o=.5,a=.5,s=t.getBox(),l=s.width,u=s.height,g=e.getStyle();"crispEdges"==g.getShapeRendering()?i.setAttribute("d","M "+n.crispValue(o)+" "+n.crispValue(a)+" L "+n.crispValue(o)+" "+n.crispValue(a+u)+" L "+n.crispValue(o+l)+" "+n.crispValue(a+u)+" L "+n.crispValue(o+l)+" "+n.crispValue(a)+" z"):i.setAttribute("d","M 0.5 0.5 L 0.5 "+(a+u)+" L "+(o+l)+" "+(a+u)+" L "+(o+l)+" "+a+" z"),g.getDrawFill()?i.setAttribute("fill",g.getFillColor()):i.setAttribute("fill","none"),g.getDrawLines()?(i.setAttribute("stroke",g.getLineColor()),i.setAttribute("stroke-width",g.getLineWidth())):(i.setAttribute("stroke","none"),i.setAttribute("stroke-width",0)),i.setAttribute("shapeRendering",g.getShapeRendering())},t.importSVG=function(e){var r=t.getBox(),n=document.createElement("canvas");n.width=r.width+1,n.height=r.height+1;var i=n.getContext("2d"),o=t.getDOMElement();o.setAttribute("width",n.width),o.setAttribute("height",n.height);var a=(new XMLSerializer).serializeToString(o),s=new Image;return s.src="data:image/svg+xml;utf8,"+a,s.onload=function(){console.log("tam "+n.width+" "+n.height),i.drawImage(s,0,0),e&&e(n.toDataURL("image/png"))},s.src},t};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.InfoText={registerProperties:function(e,t){EJSS_DRAWING2D.Text.registerProperties(e,t),t.registerProperty("Info",e.setInfo),t.registerProperty("Format",e.setFormat)}},EJSS_DRAWING2D.infoText=function(e){function t(e,t){if(!Array.isArray(t)||void 0===n)return t;for(var r="",i=e,o=e.match(/[0-9]*\.(\^|#)+/g),a=0;a<o.length;a++){var s=o[a].split("#").length-1;r=isNaN(t[a])?t[a]:t[a].toFixed(s),i=i.replace(o[a],r)}return i}var r,n,i=EJSS_DRAWING2D.text(e),o=i.getText;return i.setInfo=function(e){r=e},i.getText=function(){if(void 0===r){var e=o();return t(n,e)}return r.getInfo?r.getInfo():"function"==typeof r?r():void 0},i.setFormat=function(e){n=e},i.isChanged=function(){return!0},i.registerProperties=function(e){EJSS_DRAWING2D.InfoText.registerProperties(i,e)},i};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Knob={},EJSS_DRAWING2D.knob=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.KnobOld={registerProperties:function(e,t){EJSS_DRAWING2D.Element.registerProperties(e,t),t.registerProperty("Value",e.setValue,e.getValue),t.registerProperty("Minimum",e.setMinimum,e.getMinimum),t.registerProperty("Maximum",e.setMaximum,e.getMaximum),t.registerAction("OnPress",e.getValue),t.registerAction("OnRelease",e.getValue),t.registerAction("OnChange",e.getValue),t.registerProperty("Size",e.setSize)}},EJSS_DRAWING2D.knobOld=function(e){function t(){u=document.createElement("div"),document.body.appendChild(u),u.innerHTML=h,a=EJSS_DRAWING2D.shape(e+".exterior_shape"),a.setSize([1,1]),a.getStyle().setDrawLines(!1),a.getStyle().setAttributes({fill:"url(#KnobExteriorGradient)",filter:"url(#KnobFilter)"}),s=EJSS_DRAWING2D.shape(e+".middle_shape"),s.setSize([.9,.9]),s.getStyle().setDrawLines(!1),s.getStyle().setAttributes({fill:"url(#KnobMiddleGradient)"}),l=EJSS_CORE.promoteToControlElement(EJSS_DRAWING2D.shape(e+".inner_shape"),g.getView(),e+".inner_shape"),l.setY(.3),l.setSize([.2,.2]),l.getStyle().setDrawLines(!1),l.getStyle().setAttributes({fill:"url(#KnobInteriorGradient)"}),l.setProperty("EnabledPosition","ENABLED_NO_MOVE"),l.setProperty("Sensitivity",10),l.setProperty("OnDrag",o),l.setProperty("OnPress",n),l.setProperty("OnRelease",i)}function r(){c=Math.max(Math.min(S,c),d);var e=E-(c-d)/(S-d)*(E-f)+Math.PI/2;l.setPosition([.3*Math.cos(e),.3*Math.sin(e)])}function n(e,t){var r=g.getController();r&&r.invokeImmediateAction("OnPress")}function i(e,t){var r=g.getController();r&&r.invokeImmediateAction("OnRelease")}function o(e,t){var e=t.point,r=t.element,n=g.getAbsolutePosition(!0);e[0]-=n[0],e[1]-=n[1];var i=E-(c-d)/(S-d)*(E-f),o=Math.atan2(-e[0],e[1]);if(!(Math.abs(o-i)>p)){o=Math.min(Math.max(o,f),E),c=S-(o-f)/(E-f)*(S-d);var i=o+Math.PI/2;r.setPosition([.3*Math.cos(i),.3*Math.sin(i)]);var a=g.getController();a&&(a.immediatePropertyChanged("Value"),a.invokeImmediateAction("OnChange"))}}var a,s,l,u,g=EJSS_DRAWING2D.group(e),c=0,S=1,d=-1,f=(Math.PI,Math.PI,Math.PI,Math.PI,.7*-Math.PI),E=.7*Math.PI,p=Math.PI/5,h="<svg xmlns='http://www.w3.org/2000/svg' version='1.1'>  <defs>    <linearGradient id='KnobExteriorGradient' x1='0%' y1='0%' x2='100%' y2='100%'>      <stop offset='0%'   stop-color='rgb(250,250,250)' />      <stop offset='100%' stop-color='rgb(100,100,100)' />    </linearGradient>    <linearGradient id='KnobMiddleGradient' x1='0%' y1='0%' x2='100%' y2='100%'>      <stop offset='0%'   stop-color='rgb(200,200,200)' />      <stop offset='100%' stop-color='rgb(150,150,150)' />    </linearGradient>    <linearGradient id='KnobInteriorGradient' x1='0%' y1='0%' x2='100%' y2='100%'>      <stop offset='0%'   stop-color='rgb(127,127,127)' />      <stop offset='100%' stop-color='rgb(250,250,250)' />    </linearGradient>    <filter id='KnobFilter' x='0' y='0' width='200%' height='200%'>      <feOffset result='offOut' in='SourceGraphic' dx='1' dy='1' />      <feGaussianBlur result='blurOut' in='offOut' stdDeviation='2' />      <feBlend in='SourceGraphic' in2='blurOut' mode='normal' />    </filter>  </defs></svg>";return g.setValue=function(e){c!=e&&(c=e,r())},g.getValue=function(){return c},g.setMinimum=function(e){d!=e&&(d=e,r())},g.getMinimum=function(){return d},g.setMaximum=function(e){S!=e&&(S=e,r())},g.getMaximum=function(){return S},g.setSize=function(e){g.setSizeX(e),g.setSizeY(e)},g.registerProperties=function(e){t(),EJSS_DRAWING2D.Knob.registerProperties(g,e)},g.superSetParent=g.setParent,g.setParent=function(e,t){g.superSetParent(e,t),a.setParent(g),s.setParent(g),l.setParent(g)},g};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Mesh={},EJSS_DRAWING2D.mesh=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Meter={},EJSS_DRAWING2D.meter=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Pipe={},EJSS_DRAWING2D.pipe=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.PlottingPanel={registerProperties:function(e,t){EJSS_DRAWING2D.DrawingPanel.registerProperties(e,t),t.registerProperty("Title",e.getTitle().setText),t.registerProperty("TitleFont",e.getTitle().getFont().setFont),t.registerProperty("TitleColor",e.getTitle().getFont().setFillColor),t.registerProperty("TitleMargin",e.getTitle().setMarginY),t.registerProperty("TitleX",e.getTitleX().setText),
t.registerProperty("TitleXFont",e.getTitleX().getFont().setFont),t.registerProperty("TitleXColor",e.getTitleX().getFont().setFillColor),t.registerProperty("TitleXMargin",e.getTitleX().setMarginY),t.registerProperty("TitleY",e.getTitleY().setText),t.registerProperty("TitleYFont",e.getTitleY().getFont().setFont),t.registerProperty("TitleYColor",e.getTitleY().getFont().setFillColor),t.registerProperty("TitleYMargin",e.getTitleY().setMarginX),t.registerProperty("GridXShow",e.getGrid().setShowX,e.getGrid().getShowX),t.registerProperty("GridXTicks",e.getGrid().setTicksX,e.getGrid().getTicksX),t.registerProperty("GridXStep",e.getGrid().setStepX,e.getGrid().getStepX),t.registerProperty("GridXAutoStepMin",e.getGrid().setAutoStepXMin,e.getGrid().getAutoStepXMin),t.registerProperty("GridXAutoTicksRange",e.getGrid().setAutoTicksXRange,e.getGrid().getAutoTicksXRange),t.registerProperty("GridXScale",e.getGrid().setScaleX,e.getGrid().getScaleX),t.registerProperty("GridXScalePrecision",e.getGrid().setScalePrecisionX,e.getGrid().getScalePrecisionX),t.registerProperty("GridXFixedTick",e.getGrid().setFixedTickX,e.getGrid().getFixedTickX),t.registerProperty("GridXAutoTicks",e.getGrid().setAutoTicksX,e.getGrid().getAutoTicksX),t.registerProperty("GridXLineColor",e.getGrid().setLineColorX),t.registerProperty("GridXLineWidth",e.getGrid().setLineWidthX),t.registerProperty("GridXShapeRendering",e.getGrid().setShapeRenderingX),t.registerProperty("GridYShow",e.getGrid().setShowY,e.getGrid().getShowY),t.registerProperty("GridYTicks",e.getGrid().setTicksY,e.getGrid().getTicksY),t.registerProperty("GridYStep",e.getGrid().setStepY,e.getGrid().getStepY),t.registerProperty("GridYAutoStepMin",e.getGrid().setAutoStepYMin,e.getGrid().getAutoStepYMin),t.registerProperty("GridYAutoTicksRange",e.getGrid().setAutoTicksYRange,e.getGrid().getAutoTicksYRange),t.registerProperty("GridYScale",e.getGrid().setScaleY,e.getGrid().getScaleY),t.registerProperty("GridYScalePrecision",e.getGrid().setScalePrecisionY,e.getGrid().getScalePrecisionY),t.registerProperty("GridYFixedTick",e.getGrid().setFixedTickY,e.getGrid().getFixedTickY),t.registerProperty("GridYAutoTicks",e.getGrid().setAutoTicksY,e.getGrid().getAutoTicksY),t.registerProperty("GridYLineColor",e.getGrid().setLineColorY),t.registerProperty("GridYLineWidth",e.getGrid().setLineWidthY),t.registerProperty("GridYShapeRendering",e.getGrid().setShapeRenderingY),t.registerProperty("AxisXShow",e.getAxisX().setShow),t.registerProperty("AxisXLineColor",e.getAxisX().getStyle().setLineColor),t.registerProperty("AxisXLineWidth",e.getAxisX().getStyle().setLineWidth),t.registerProperty("AxisXShapeRendering",e.getAxisX().getStyle().setShapeRendering),t.registerProperty("AxisXFixedTick",e.getAxisX().setFixedTick,e.getAxisX().getFixedTick),t.registerProperty("AxisXAutoTicks",e.getAxisX().setAutoTicks,e.getAxisX().getAutoTicks),t.registerProperty("AxisXTicks",e.getAxisX().setTicks,e.getAxisX().getTicks),t.registerProperty("AxisXStep",e.getAxisX().setStep,e.getAxisX().getStep),t.registerProperty("AxisXTickStep",e.getAxisX().setTickStep,e.getAxisX().getTickStep),t.registerProperty("AxisXAutoStepMin",e.getAxisX().setAutoStepMin,e.getAxisX().getAutoStepMin),t.registerProperty("AxisXAutoTicksRange",e.getAxisX().setAutoTicksRange,e.getAxisX().getAutoTicksRange),t.registerProperty("AxisXScale",e.getAxisX().setScale,e.getAxisX().getScale),t.registerProperty("AxisXScalePrecision",e.getAxisX().setScalePrecision,e.getAxisX().getScalePrecision),t.registerProperty("AxisXFont",e.getAxisX().getFont().setFont),t.registerProperty("AxisXFontColor",e.getAxisX().getFont().setFillColor),t.registerProperty("AxisYShow",e.getAxisY().setShow),t.registerProperty("AxisYLineColor",e.getAxisY().getStyle().setLineColor),t.registerProperty("AxisYLineWidth",e.getAxisY().getStyle().setLineWidth),t.registerProperty("AxisYShapeRendering",e.getAxisY().getStyle().setShapeRendering),t.registerProperty("AxisYFixedTick",e.getAxisY().setFixedTick,e.getAxisY().getFixedTick),t.registerProperty("AxisYAutoTicks",e.getAxisY().setAutoTicks,e.getAxisY().getAutoTicks),t.registerProperty("AxisYTicks",e.getAxisY().setTicks,e.getAxisY().getTicks),t.registerProperty("AxisYStep",e.getAxisY().setStep,e.getAxisY().getStep),t.registerProperty("AxisYTickStep",e.getAxisY().setTickStep,e.getAxisY().getTickStep),t.registerProperty("AxisYAutoStepMin",e.getAxisY().setAutoStepMin,e.getAxisY().getAutoStepMin),t.registerProperty("AxisYAutoTicksRange",e.getAxisY().setAutoTicksRange,e.getAxisY().getAutoTicksRange),t.registerProperty("AxisYScale",e.getAxisY().setScale,e.getAxisY().getScale),t.registerProperty("AxisYScalePrecision",e.getAxisY().setScalePrecision,e.getAxisY().getScalePrecision),t.registerProperty("AxisYFont",e.getAxisY().getFont().setFont),t.registerProperty("AxisYFontColor",e.getAxisY().getFont().setFillColor),t.registerProperty("XFixedTick",function(t){e.getAxisX().setFixedTick(t),e.getGrid().setFixedTickX(t)}),t.registerProperty("YFixedTick",function(t){e.getAxisY().setFixedTick(t),e.getGrid().setFixedTickY(t)}),t.registerProperty("XTicks",function(t){e.getAxisX().setTicks(t),e.getGrid().setTicksX(t)}),t.registerProperty("YTicks",function(t){e.getAxisY().setTicks(t),e.getGrid().setTicksY(t)}),t.registerProperty("XStep",function(t){e.getAxisX().setStep(t),e.getGrid().setStepX(t)}),t.registerProperty("YStep",function(t){e.getAxisY().setStep(t),e.getGrid().setStepY(t)}),t.registerProperty("XTickStep",function(t){e.getAxisX().setTickStep(t),e.getGrid().setTickStepX(t)}),t.registerProperty("YTickStep",function(t){e.getAxisY().setTickStep(t),e.getGrid().setTickStepY(t)}),t.registerProperty("XAutoStepMin",function(t){e.getAxisX().setAutoStepMin(t),e.getGrid().setAutoStepXMin(t)}),t.registerProperty("YAutoStepMin",function(t){e.getAxisY().setAutoStepMin(t),e.getGrid().setAutoStepYMin(t)}),t.registerProperty("XAutoTicksRange",function(t){e.getAxisX().setAutoTicksRange(t),e.getGrid().setAutoTicksXRange(t)}),t.registerProperty("YAutoTicksRange",function(t){e.getAxisY().setAutoTicksRange(t),e.getGrid().setAutoTicksyRange(t)}),t.registerProperty("XScale",function(t){e.getAxisX().setScale(t),e.getGrid().setScaleX(t)}),t.registerProperty("YScale",function(t){e.getAxisY().setScale(t),e.getGrid().setScaleY(t)}),t.registerProperty("XScalePrecision",function(t){e.getAxisX().setScalePrecision(t),e.getGrid().setScalePrecisionX(t)}),t.registerProperty("YScalePrecision",function(t){e.getAxisY().setScalePrecision(t),e.getGrid().setScalePrecisionY(t)}),t.registerProperty("XAutoTicks",function(t){e.getAxisX().setAutoTicks(t),e.getGrid().setAutoTicksX(t)}),t.registerProperty("YAutoTicks",function(t){e.getAxisY().setAutoTicks(t),e.getGrid().setAutoTicksY(t)})}},EJSS_DRAWING2D.plottingPanel=function(e,t){var r=EJSS_DRAWING2D.drawingPanel(e,t);r.getGrid=function(){return i},r.getAxisX=function(){return a},r.getAxisY=function(){return s},r.getTitleX=function(){return l},r.getTitleY=function(){return u},r.getTitle=function(){return g},r.getFixedTickX=function(){return getGrid().getFixedTickX()},r.getFixedTickY=function(){return getGrid().getFixedTickY()},r.registerProperties=function(e){EJSS_DRAWING2D.PlottingPanel.registerProperties(r,e)};var n=EJSS_DRAWING2D.group(e+".bottomgroup");n.setRelativePosition("SOUTH_WEST"),n.panelChangeListener=function(e){if("bounds"==e){var t=r.getRealWorldXMin(),i=r.getRealWorldXMax(),o=r.getRealWorldYMin(),a=r.getRealWorldYMax(),s=Math.abs(i-t),l=Math.abs(a-o);return n.setSize([s,l]),n.setPosition([t,o]),!0}},n.panelChangeListener("bounds");var i=EJSS_DRAWING2D.grid(e+".grid");i.setGroup(n),i.setRelativePosition("SOUTH_WEST"),i.setLineColorX("lightgray"),i.setShapeRenderingX("RENDER_CRISPEDGES"),i.setLineColorY("lightgray"),i.setShapeRenderingY("RENDER_CRISPEDGES"),i.setSize([1,1]),i.setPosition([0,0]),i.panelChangeListener=function(e){if("bounds"==e){var t=r.getRealWorldXMin(),n=r.getRealWorldXMax();i.setScaleX([t,n]),i.setTicksXMode(r.getTypeScaleX());var o=r.getRealWorldYMin(),a=r.getRealWorldYMax();return i.setScaleY([o,a]),i.setTicksYMode(r.getTypeScaleY()),!0}};var o=EJSS_DRAWING2D.group(e+".topgroup");o.setRelativePosition("SOUTH_WEST"),o.panelChangeListener=function(e){if("bounds"==e){var t=r.getRealWorldXMin(),n=r.getRealWorldXMax(),i=r.getRealWorldYMin(),a=r.getRealWorldYMax(),s=Math.abs(n-t),l=Math.abs(a-i);return o.setSize([s,l]),o.setPosition([t,i]),!0}},o.panelChangeListener("bounds");var a=EJSS_DRAWING2D.axis(e+".axisX");a.setGroup(o),a.setRelativePosition("WEST"),a.getStyle().setLineColor("black"),a.getStyle().setShapeRendering("RENDER_CRISPEDGES"),a.getFont().setFontSize(10),a.setSize([1,1]),a.setPosition([0,0]),a.setOrient("AXIS_HORIZONTAL"),a.panelChangeListener=function(e){if("bounds"==e){var t=r.getRealWorldXMin(),n=r.getRealWorldXMax();return a.setScale([t,n]),a.setTicksMode(r.getTypeScaleX()),r.getInvertedScaleY()?(a.setTextPosition("TICKS_DOWN"),l.setMarginY(-30),g.setMarginY(20)):(a.setTextPosition("TICKS_UP"),l.setMarginY(30),g.setMarginY(-20)),!0}},a.setTicksMode(r.getTypeScaleX());var s=EJSS_DRAWING2D.axis(e+".axisY");s.setGroup(o),s.setRelativePosition("SOUTH"),s.getStyle().setLineColor("black"),s.getStyle().setShapeRendering("RENDER_CRISPEDGES"),s.getFont().setFontSize(10),s.setSize([1,1]),s.setPosition([0,0]),s.setOrient("AXIS_VERTICAL"),s.panelChangeListener=function(e){if("bounds"==e){var t=r.getRealWorldYMin(),n=r.getRealWorldYMax();return s.setScale([t,n]),s.setTicksMode(r.getTypeScaleY()),s.setInvertedScaleY(r.getInvertedScaleY()),!0}},s.setTicksMode(r.getTypeScaleY());var l=EJSS_DRAWING2D.text(e+".titleX");l.setGroup(o),l.setRelativePosition("CENTER"),l.getFont().setFontSize(12),l.setPosition([.5,0]),l.setMarginY(30),l.setText("x");var u=EJSS_DRAWING2D.text(e+".titleY");u.setGroup(o),u.setRelativePosition("CENTER"),u.getFont().setFontSize(12),u.setWritingMode("MODE_DOWNTOP"),u.setPosition([0,.5]),u.setMarginX(-40),u.setText("y");var g=EJSS_DRAWING2D.text(e+".title");return g.setGroup(o),g.setRelativePosition("CENTER"),g.getFont().setFontSize(12),g.setPosition([.5,1]),g.setMarginY(-20),g.setText("Plot"),r.getStyle().setLineColor("black"),r.getStyle().setFillColor("white"),r.getStyle().setShapeRendering("RENDER_CRISPEDGES"),r._25([50,50,50,50]),r.getGuttersStyle().setLineColor("black"),r.getGuttersStyle().setFillColor("rgb(211,216,255)"),r.getGuttersStyle().setShapeRendering("RENDER_CRISPEDGES"),r.addDecoration(n),r.addDecoration(i),r.addDecoration(o,-1,!0),r.addDecoration(a,-1,!0),r.addDecoration(s,-1,!0),r.addDecoration(l,-1,!0),r.addDecoration(u,-1,!0),r.addDecoration(g,-1,!0),r};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Polygon={},EJSS_DRAWING2D.polygon=function(e){},EJSS_DRAWING2D.PolygonSet={},EJSS_DRAWING2D.polygonSet=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Ruler={},EJSS_DRAWING2D.ruler=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.ScalarField={registerProperties:function(e,t){EJSS_DRAWING2D.Element.registerProperties(e,t),t.registerProperty("Data",e.setData,e.getData),t.registerProperty("MinimumX",e.setMinimumX,e.getMinimumX),t.registerProperty("MaximumX",e.setMaximumX,e.getMaximumX),t.registerProperty("MinimumY",e.setMinimumY,e.getMinimumY),t.registerProperty("MaximumY",e.setMaximumY,e.getMaximumY),t.registerProperty("MinimumZ",e.setMinimumZ,e.getMinimumZ),t.registerProperty("MaximumZ",e.setMaximumZ,e.getMaximumZ),t.registerProperty("Radius",e.setRadius,e.getRadius)}},EJSS_DRAWING2D.scalarField=function(e){var t=EJSS_DRAWING2D.element(e),r=[],n=-1,i=1,o=-1,a=1,s=-1,l=1,u=0;return t._23=function(){return"ElementScalarField"},t.getMinimumX=function(){return n},t.setMinimumX=function(e){n!=e&&(n=e,t.setChanged(!0))},t.getMaximumX=function(){return i},t.setMaximumX=function(e){i!=e&&(i=e,t.setChanged(!0))},t.getMinimumY=function(){return o},t.setMinimumY=function(e){o!=e&&(o=e,t.setChanged(!0))},t.getMaximumY=function(){return a},t.setMaximumY=function(e){a!=e&&(a=e,t.setChanged(!0))},t.getMinimumZ=function(){return s},t.setMinimumZ=function(e){s!=e&&(s=e,t.setChanged(!0))},t.getMaximumZ=function(){return l},t.setMaximumZ=function(e){l!=e&&(l=e,t.setChanged(!0))},t.getRadius=function(){return u},t.setRadius=function(e){u!=e&&(u=e,t.setChanged(!0))},t.getData=function(){return r},t.setData=function(e){r=e||r,t.setChanged(!0)},t.registerProperties=function(e){EJSS_DRAWING2D.ScalarField.registerProperties(t,e)},t};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Segment={registerProperties:function(e,t){EJSS_DRAWING2D.Element.registerProperties(e,t),t.registerProperty("Offset",e.setRelativePosition,e.getRelativePosition)}},EJSS_DRAWING2D.segment=function(e){var t=EJSS_DRAWING2D.element(e);return t._23=function(){return"ElementSegment"},t.registerProperties=function(e){EJSS_DRAWING2D.Segment.registerProperties(t,e)},t.setSize([.1,.1]),t.setRelativePosition("SOUTH_WEST"),t},EJSS_DRAWING2D.SegmentSet={},EJSS_DRAWING2D.segmentSet=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.SetSquare={},EJSS_DRAWING2D.setSquare=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Shape={NONE:0,ELLIPSE:1,RECTANGLE:2,ROUND_RECTANGLE:3,WHEEL:4,POINT:5,registerProperties:function(e,t){EJSS_DRAWING2D.Element.registerProperties(e,t),t.registerProperty("ShapeType",e.setShapeType),t.registerProperty("CornerRadius",e.setCornerRadius)},copyTo:function(e,t){EJSS_DRAWING2D.Element.copyTo(e,t),t.setShapeType(e.getShapeType()),t.setCornerRadius(e.getCornerRadius())}},EJSS_DRAWING2D.shape=function(e){var t=EJSS_DRAWING2D.element(e),r=10,n=EJSS_DRAWING2D.Shape.ELLIPSE;return t.setShapeType=function(e){n="string"==typeof e?EJSS_DRAWING2D.Shape[e.toUpperCase()]:e},t.getShapeType=function(){return n},t.setCornerRadius=function(e){r!=e&&(r=e,t.setChanged(!0))},t.getCornerRadius=function(){return r},t._23=function(){return"ElementShape"},t.registerProperties=function(e){EJSS_DRAWING2D.Shape.registerProperties(t,e)},t.copyTo=function(e){EJSS_DRAWING2D.Shape.copyTo(t,e)},t.setSize([.1,.1]),t.setRelativePosition("CENTER"),t.getStyle().setFillColor("Blue"),t.getStyle().setLineColor("Black"),t},EJSS_DRAWING2D.ShapeSet={},EJSS_DRAWING2D.shapeSet=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.SimplePanel={GRAPHICS2D_SVG:"SVG",GRAPHICS2D_CANVAS:"Canvas",registerProperties:function(e,t){t.registerProperty("MinimumX",e.setWorldXMin,e.getWorldXMin),t.registerProperty("MaximumX",e.setWorldXMax,e.getWorldXMax),t.registerProperty("MinimumY",e.setWorldYMin,e.getWorldYMin),t.registerProperty("MaximumY",e.setWorldYMax,e.getWorldYMax),t.registerProperty("Bounds",e.setWorldCoordinates,e.getWorldCoordinates),t.registerProperty("MarginX",e.setMarginX,e.getMarginX),t.registerProperty("MarginY",e.setMarginY,e.getMarginY),t.registerProperty("Parent",e.getGraphics().setParent,e.getGraphics().getParent),t.registerProperty("Width",e.getGraphics().setWidth,e.getGraphics().getWidth),t.registerProperty("Height",e.getGraphics().setHeight,e.getGraphics().getHeight),t.registerProperty("Graphics",e.setGraphics),t.registerProperty("Background",e.getStyle().setFillColor),t.registerProperty("Foreground",e.getStyle().setLineColor),t.registerProperty("LineColor",e.getStyle().setLineColor),t.registerProperty("LineWidth",e.getStyle().setLineWidth),t.registerProperty("DrawLines",e.getStyle().setDrawLines),t.registerProperty("FillColor",e.getStyle().setFillColor),t.registerProperty("DrawFill",e.getStyle().setDrawFill),t.registerProperty("ShapeRendering",e.getStyle().setShapeRendering),t.registerProperty("Visibility",e.getGraphics().getStyle().setVisibility),t.registerProperty("Display",e.getGraphics().getStyle().setDisplay),t.registerProperty("CSS",e.getGraphics().getStyle().setCSS)}},EJSS_DRAWING2D.simplePanel=function(e){var t={},r=EJSS_GRAPHICS.svgGraphics(e),n=EJSS_DRAWING2D.style(e),i=[],o=!1,a=[],s={xminPreferred:-1,xmaxPreferred:1,yminPreferred:-1,ymaxPreferred:1,xorigin:0,yorigin:0,xscale:1,yscale:1},l=!0,u=!0;return t.getName=function(){return e},t.getGraphics=function(){return r},t.importGraphics=function(e){return r.importSVG(e)},t.getStyle=function(){return n},t.setGraphics=function(t){t==EJSS_DRAWING2D.SimplePanel.GRAPHICS2D_SVG?r=EJSS_GRAPHICS.svgGraphics(e):t==EJSS_DRAWING2D.SimplePanel.GRAPHICS2D_CANVAS?console.log("WARNING: setGraphics() - Canvas not supported"):console.log("WARNING: setGraphics() - Graphics not supported")},t.setWorldXMin=function(e){e!==s.xminPreferred&&(s.xminPreferred=e,u=!0)},t.getWorldXMin=function(){return s.xminPreferred},t.setWorldXMax=function(e){e!==s.xmaxPreferred&&(s.xmaxPreferred=e,u=!0)},t.getWorldXMax=function(){return s.xmaxPreferred},t.setWorldYMin=function(e){e!==s.yminPreferred&&(s.yminPreferred=e,u=!0)},t.getWorldYMin=function(){return s.yminPreferred},t.setWorldYMax=function(e){e!==s.ymaxPreferred&&(s.ymaxPreferred=e,u=!0)},t.getWorldYMax=function(){return s.ymaxPreferred},t.setWorldCoordinates=function(e){t.setWorldXMin(e[0]),t.setWorldXMax(e[1]),t.setWorldYMin(e[2]),t.setWorldYMax(e[3])},t.getWorldCoordinates=function(){return[t.getWorldXMin(),t.getWorldXMax(),t.getWorldYMin(),t.getWorldYMax()]},t.addElement=function(e,r){EJSS_TOOLS.addToArray(i,e,r),e.setPanel(t),e.dataCollected&&a.push(e),o=!0},t.removeElement=function(e){EJSS_TOOLS.removeFromArray(i,e),e.setPanel(null),e.dataCollected&&EJSS_TOOLS.removeFromArray(a,e),o=!0},t.getElements=function(){return i},t.indexOfElement=function(e){return i.indexOf(e)},t.toPixelAxisY=function(e){return s.yorigin-e-s.yscale*s.yminPreferred},t.toPixelAxisX=function(e){return s.xorigin+e-s.xscale*s.xminPreferred},t._26=function(e){var t=[];return t[0]=s.xorigin+s.xscale*(e[0]-s.xminPreferred),t[1]=s.yorigin+s.yscale*(e[1]-s.yminPreferred),t},t.toPixelMod=function(e){var t=[];return t[0]=e[0]*s.xscale,t[1]=e[1]*s.yscale,t},t.toPanelPosition=function(e){var t=[];return t[0]=s.xminPreferred+(e[0]-s.xorigin)/s.xscale,t[1]=s.yminPreferred+(e[1]-s.yorigin)/s.yscale,t},t.toPanelMod=function(e){var t=[];return t[0]=0==s.xscale?0:e[0]/s.xscale,t[1]=0==s.yscale?0:e[1]/s.yscale,t},t.getPixelPositionWorldOrigin=function(){return[s.xorigin,s.yorigin]},t._27=function(){var e=r.getWidth(),t=r.getHeight(),n=e/(s.xmaxPreferred-s.xminPreferred),i=t/(s.ymaxPreferred-s.yminPreferred);s.xscale=n,s.yscale=-i,s.xorigin=.5,s.yorigin=t+.5,u=!1},t.reset=function(){r.reset()},t.render=function(){var e=!1;o&&(r.reset(),e=!0,o=!1);for(var n=0,s=a.length;n<s;n++)a[n].dataCollected();u&&t._27(),(l||e)&&r.drawPanel(t),r.draw(i,e),l=!1;for(var n=0,s=i.length;n<s;n++)i[n].setChanged(!1)},t.registerProperties=function(e){EJSS_DRAWING2D.SimplePanel.registerProperties(t,e)},n.setLineColor("black"),n.setFillColor("rgb(239,239,255)"),n.setChangeListener(function(e){l=!0}),t};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Spring={DEF_RADIUS:.05,DEF_LOOPS:8,DEF_PPL:15,copyTo:function(e,t){EJSS_DRAWING2D.Element.copyTo(e,t),t.setRadius(e.getRadius()),t.setSolenoid(e.getSolenoid()),t.setThinExtremes(e.getThinExtremes()),t.setLoops(e.getLoops()),t.setPointsPerLoop(e.getPointsPerLoop())},registerProperties:function(e,t){EJSS_DRAWING2D.Element.registerProperties(e,t),t.registerProperty("Radius",e.setRadius,e.getRadius),t.registerProperty("Solenoid",e.setSolenoid,e.getSolenoid),t.registerProperty("ThinExtremes",e.setThinExtremes,e.getThinExtremes),t.registerProperty("Loops",e.setLoops,e.getLoops),t.registerProperty("PointsPerLoop",e.setPointsPerLoop,e.getPointsPerLoop)}},EJSS_DRAWING2D.spring=function(e){var t,r,n=EJSS_DRAWING2D.element(e),i=EJSS_DRAWING2D.Spring.DEF_RADIUS,o=0,a=!0;return n._23=function(){return"ElementSpring"},n.setRadius=function(e){i!=e&&(i=e,n.setChanged(!0))},n.getRadius=function(){return i},n.setSolenoid=function(e){o!=e&&(o=e,n.setChanged(!0))},n.getSolenoid=function(){return o},n.setThinExtremes=function(e){a!=e&&(a=e,n.setChanged(!0))},n.getThinExtremes=function(){return a},n.setLoops=function(e){t!=e&&(t=e,n.setChanged(!0))},n.getLoops=function(){return t},n.setPointsPerLoop=function(e){r!=e&&(r=e,n.setChanged(!0))},n.getPointsPerLoop=function(){return r},n.registerProperties=function(e){EJSS_DRAWING2D.Spring.registerProperties(n,e)},n.copyTo=function(e){EJSS_DRAWING2D.Spring.copyTo(n,e)},n.setSize([.1,.1]),n.setLoops(EJSS_DRAWING2D.Spring.DEF_LOOPS),n.setPointsPerLoop(EJSS_DRAWING2D.Spring.DEF_PPL),n.setRelativePosition("SOUTH_WEST"),n};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.SpringSet={},EJSS_DRAWING2D.springSet=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Tank={},EJSS_DRAWING2D.tank=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Text={MODE_TOPDOWN:0,MODE_RIGTHLEFT:1,MODE_DOWNTOP:2,MODE_LEFTRIGHT:3,copyTo:function(e,t){EJSS_DRAWING2D.Element.copyTo(e,t),EJSS_DRAWING2D.Font.copyTo(e.getFont(),t.getFont()),t.setText(e.getText()),t.setWritingMode(e.getWritingMode())},registerProperties:function(e,t){EJSS_DRAWING2D.Element.registerProperties(e,t),t.registerProperty("Text",e.setText),t.registerProperty("Framed",e.setFramed),t.registerProperty("WritingMode",e.setWritingMode),t.registerProperty("Font",e.getFont().setFont),t.registerProperty("FontFamily",e.getFont().setFontFamily),t.registerProperty("FontSize",e.getFont().setFontSize),t.registerProperty("LetterSpacing",e.getFont().setLetterSpacing),t.registerProperty("OutlineColor",e.getFont().setOutlineColor),t.registerProperty("FontWeight",e.getFont().setFontWeight),t.registerProperty("FillColor",e.getFont().setFillColor),t.registerProperty("FontStyle",e.getFont().setFontStyle),t.registerProperty("MarginX",e.getMarginX().setMarginX),t.registerProperty("MarginY",e.getMarginY().setMarginY)}},EJSS_DRAWING2D.text=function(e){var t=EJSS_DRAWING2D.element(e),r="",n=EJSS_DRAWING2D.Text.MODE_LEFTRIGHT,i=EJSS_DRAWING2D.font(e),o=!1,a=0,s=0;return t._23=function(){return"ElementText"},t.setText=function(e){r!=e&&(r=e,t.setChanged(!0))},t.getText=function(){return r},t.setMarginX=function(e){a!=e&&(a=e,t.setChanged(!0))},t.getMarginX=function(){return a},t.setMarginY=function(e){s!=e&&(s=e,t.setChanged(!0))},t.getMarginY=function(){return s},t.getSizeX=function(){var e=r?r.length:0;return e*i.getFontSize()+e*i.getNumberLetterSpacing()},t.getSizeY=function(){return i.getFontSize()},t.getFont=function(){return i},t.setFramed=function(e){o!=e&&(o=e,t.setChanged(!0))},t.getFramed=function(){return o},t.setWritingMode=function(e){"string"==typeof e&&(e=EJSS_DRAWING2D.Text[e.toUpperCase()]),n!=e&&(n=e,t.setChanged(!0))},t.getWritingMode=function(){return n},t.registerProperties=function(e){EJSS_DRAWING2D.Text.registerProperties(t,e)},t.copyTo=function(e){EJSS_DRAWING2D.Text.copyTo(t,e)},i.setChangeListener(function(e){t.setChanged(!0)}),t.setPixelSize(!0),t},EJSS_DRAWING2D.TextSet={registerProperties:function(e,t){EJSS_DRAWING2D.ElementSet.registerProperties(e,t),t.registerProperty("Text",function(t){e.setToEach(function(e,t){e.setText(t)},t)}),t.registerProperty("Framed",function(t){e.setToEach(function(e,t){e.setFramed(t)},t)}),t.registerProperty("WritingMode",function(t){e.setToEach(function(e,t){e.setWritingMode(t)},t)}),t.registerProperty("Font",function(t){e.setToEach(function(e,t){e.getFont().setFont(t)},t)}),t.registerProperty("FontFamily",function(t){e.setToEach(function(e,t){e.getFont().setFontFamily(t)},t)}),t.registerProperty("FontSize",function(t){e.setToEach(function(e,t){e.getFont().setFontSize(t)},t)}),t.registerProperty("LetterSpacing",function(t){e.setToEach(function(e,t){e.getFont().setLetterSpacing(t)},t)}),t.registerProperty("OutlineColor",function(t){e.setToEach(function(e,t){e.getFont().setOutlineColor(t)},t)}),t.registerProperty("FontWeight",function(t){e.setToEach(function(e,t){e.getFont().setFontWeight(t)},t)}),t.registerProperty("FillColor",function(t){e.setToEach(function(e,t){e.getFont().setFillColor(t)},t)})}},EJSS_DRAWING2D.textSet=function(e){var t=EJSS_DRAWING2D.elementSet(EJSS_DRAWING2D.text,e),r=EJSS_DRAWING2D.TextSet;return t.registerProperties=function(e){r.registerProperties(t,e)},t};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Trace={},EJSS_DRAWING2D.trace=function(e){},EJSS_DRAWING2D.TraceSet={},EJSS_DRAWING2D.traceSet=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Trail={NO_CONNECTION:0,LINE_CONNECTION:1,copyTo:function(e,t){EJSS_DRAWING2D.Element.copyTo(e,t),t.setActive(e.getActive()),t.setNoRepeat(e.getNoRepeat()),t.setClearAtInput(e.getClearAtInput()),t.setSkip(e.getSkip()),t.setInputLabels(e.getInputLabels()),t.setMaximumPoints(e.getMaximumPoints()),t.setConnectionType(e.getConnectionType()),t.setPoints(e.getPoints())},registerProperties:function(e,t){EJSS_DRAWING2D.Element.registerProperties(e,t),t.registerProperty("Active",e.setActive,e.getActive),t.registerProperty("NoRepeat",e.setNoRepeat,e.getNoRepeat),t.registerProperty("ClearAtInput",e.setClearAtInput,e.getClearAtInput),t.registerProperty("Skip",e.setSkip,e.getSkip),t.registerProperty("ColumnNames",e.setInputLabels,e.getInputLabels),t.registerProperty("Maximum",e.setMaximumPoints,e.getMaximumPoints),t.registerProperty("ConnectionType",e.setConnectionType,e.getConnectionType),t.registerProperty("Connected",e.setConnected,e.isConnected),t.registerProperty("Points",e.setPoints,e.getPoints),t.registerProperty("LastPoint",e.addPoint,e.getLastPoint),t.registerProperty("Input",e.addPoints),t.registerProperty("InputX",e.addXPoints),t.registerProperty("InputY",e.addYPoints)}},EJSS_DRAWING2D.trail=function(e){function t(e,t,n){if(isNaN(e)||isNaN(t))return void(c=!0);i&&S[0]==e&&S[1]==t||(void 0!==n&&null!==n||(n=u),d=0,S=r.formatPoint([e,t,n]),a>0&&(g>0&&(d=r.formatPoint([e,t,n])),++g>=a&&(g=0)),0==d&&(l>2&&f.length>=l&&f.splice(0,1),f[f.length]=r.formatPoint([e,t,n]),c=!1))}var r=EJSS_DRAWING2D.element(e),n=!0,i=!1,o=!1,a=0,s=["x","y"],l=0,u=EJSS_DRAWING2D.Trail.LINE_CONNECTION,g=0,c=!0,S=0,d=0,f=[],E=[],p=[],h=[],m=0,A=0;return r._23=function(){return"ElementTrail"},r.setActive=function(e){n!=e&&(n=e,r.setChanged(!0))},r.getActive=function(){return n},r.setNoRepeat=function(e){i!=e&&(i=e,r.setChanged(!0))},r.getNoRepeat=function(){return i},r.setClearAtInput=function(e){o!=e&&(o=e,r.setChanged(!0))},r.getClearAtInput=function(){return o},r.setSkip=function(e){a!=e&&(a=e,g=0,r.setChanged(!0))},r.getSkip=function(){return a},r.setInputLabels=function(e){s[0]==e[0]&&s[1]==e[1]||(s[0]=e[0],s[1]=e[1],r.setChanged(!0))},r.getInputLabels=function(){return s},r.setMaximumPoints=function(e){var t=Math.max(e,2);l!=t&&(l=t,r.setChanged(!0))},r.getMaximumPoints=function(){return l},r.setConnected=function(e){e?r.setConnectionType(EJSS_DRAWING2D.Trail.LINE_CONNECTION):r.setConnectionType(EJSS_DRAWING2D.Trail.NO_CONNECTION)},r.isConnected=function(){return u===EJSS_DRAWING2D.Trail.LINE_CONNECTION},r.setConnectionType=function(e){"string"==typeof e&&(e=EJSS_DRAWING2D.Trail[e.toUpperCase()]),u!=e&&(u=e,r.setChanged(!0))},r.getConnectionType=function(){return u},r.addPoint=function(e,i,a){n&&(o&&r.initialize(),e instanceof Array?t(e[0],e[1],e[2]):t(e,i,a),r.setChanged(!0))},r.addPoints=function(e,i){if(n){if(o&&r.initialize(),void 0===i||null===i)if(e[0]instanceof Array)for(var a=0,s=e.length;a<s;a++)t(e[a][0],e[a][1],e[a][2]);else t(e[0],e[1]);else for(var s=Math.min(e.length,i.length),a=0;a<s;a++)t(e[a],i[a]);r.setChanged(!0)}},r.addXPoints=function(e){if(n){var t=0;if(e instanceof Array){for(var r=e.length;t<r;t++)h[t]?h[t]=[e[t],h[t][1],h[t][2]]:h[t]=[e[t],A,u];m=e[t]}else h[t]?h[t]=[e,h[t][1],h[t][2]]:h[t]=[e,A,u],t++,m=e;for(;h[t];)h[t]=[m,h[t][1],h[t][2]],t++}},r.addYPoints=function(e){if(n){var t=0;if(e instanceof Array){for(var r=e.length;t<r;t++)h[t]?h[t]=[h[t][0],e[t],h[t][2]]:h[t]=[m,e[t],u];A=e[t]}else h[t]?h[t]=[h[t][0],e,h[t][2]]:h[t]=[m,e,u],t++,A=e;for(;h[t];)h[t]=[h[t][0],A,h[t][2]],t++}},r.dataCollected=function(){h.length>0&&(r.addPoints(h),h=[],r.setChanged(!0))},r.setPoints=function(e,t){n&&(r.clear(),r.addPoints(e,t),r.setChanged(!0))},r.moveToPoint=function(e,i){n&&(o&&r.initialize(),e instanceof Array?t(e[0],e[1],EJSS_DRAWING2D.Trail.NO_CONNECTION):t(e,i,EJSS_DRAWING2D.Trail.NO_CONNECTION),r.setChanged(!0))},r.getSegmentsCount=function(){return E.length},r.getSegmentPoints=function(e){return E[e]},r.getSegmentStyle=function(e){return p[e]},r.getCurrentPoints=function(){return f},r.getPoints=function(){for(var e=[],t=E.length,r=0;r<t;r++)e=e.concat(E[r]);return e=e.concat(f)},r.getLastPoint=function(){return S},r.reset=function(){r.clear()},r.clear=function(){E=[],p=[],r.initialize()},r.clearLastSegment=function(){f.length<=0&&(E.pop(),p.pop(),r.setChanged(!0)),r.initialize()},r.initialize=function(){f=[],d=0,c=!0,g=0,S=0,r.setChanged(!0)},r.newSegment=function(){if(0!=d){var e=f.length;f[e]=r.formatPoint(d)}var e=E.length;E[e]=f;var t=EJSS_DRAWING2D.style(r.getName()+" #"+e);EJSS_DRAWING2D.Style.copyTo(r.getStyle(),t),p[e]=t,r.initialize()},r.getBounds=function(e){var t,n,i,o,a=r.getPoints(),s=a.length;if(0==s)t=n=i=o=0;else{n=t=a[0][0],o=i=a[0][1];for(var l=1;l<s;l++){var u=a[l][0],g=a[l][1];u>n&&(n=u),g>o&&(o=g),u<t&&(t=u),g<i&&(i=g)}}var u=r.getX(),g=r.getY(),c=r.getSizeX(),S=r.getSizeY(),d=c/2,f=S/2,E=r.getRelativePositionOffset(c,S);return{left:u+E[0]-d+t*c,right:u+E[0]-d+n*c,top:g+E[1]-f+o*S,bottom:g+E[1]-f+i*S}},r.formatPoint=function(e){return e},r.registerProperties=function(e){EJSS_DRAWING2D.Trail.registerProperties(r,e)},r.copyTo=function(e){EJSS_DRAWING2D.Trail.copyTo(r,e)},r.setSize([1,1]),r.setRelativePosition("SOUTH_WEST"),r},EJSS_DRAWING2D.TrailSet={},EJSS_DRAWING2D.trailSet=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.colorCoded=function(e,t){var r=EJSS_DRAWING2D.colorMapper(e,t),n=!1;return r.setSymmetricZ=function(e){n=e},r.isSymmetricZ=function(){return n},r.setAutoscale=function(e){for(var t=Number.MAX_VALUE,i=Number.MIN_VALUE,o=0,a=e.length;o<a;o++){var s=e[o];i=Math.max(i,s),t=Math.min(t,s)}var l=i,u=t;n&&(l=Math.max(Math.abs(t),Math.abs(i)),u=-l),r.setScale(u,l)},r.setAutoscaleArray2=function(e){for(var t=Number.MAX_VALUE,i=Number.MIN_VALUE,o=0,a=e.length;o<a;o++)for(var s=0,l=e[o].length;s<l;s++){var u=e[o][s];i=Math.max(i,u),t=Math.min(t,u)}var g=i,c=t;n&&(g=Math.max(Math.abs(t),Math.abs(i)),c=-g),r.setScale(c,g)},r.setAutoscaleArray3=function(e){for(var t=Number.MAX_VALUE,i=Number.MIN_VALUE,o=0,a=e.length;o<a;o++)for(var s=0,l=e[o].length;s<l;s++)for(var u=0,g=e[o][s].length;u<g;u++){var c=e[o][s][u];i=Math.max(i,c),t=Math.min(t,c)}var S=i,d=t;n&&(S=Math.max(Math.abs(t),Math.abs(i)),d=-S),r.setScale(d,S)},r};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.ColorMapper={CUSTOM:-1,SPECTRUM:0,GRAYSCALE:1,DUALSHADE:2,RED:3,GREEN:4,BLUE:5,BLACK:6,WIREFRAME:7,NORENDER:8,REDBLUE_SHADE:9,getColorPalette:function(e,t){function r(e,t,r){var n={h:Math.round(360*e),s:t,b:r},i={r:0,g:0,b:0};if(0===n.s)return i.r=i.g=i.b=n.h,i;var o=Math.floor(n.h/60),a=n.h/60-o,s=n.b*(1-n.s),l=n.b*(1-a*n.s),u=n.b*(1-(1-a)*n.s);switch(o){case 0:i.r=n.b,i.g=u,i.b=s;break;case 1:i.r=l,i.g=n.b,i.b=s;break;case 2:i.r=s,i.g=n.b,i.b=u;break;case 3:i.r=s,i.g=l,i.b=n.b;break;case 4:i.r=u,i.g=s,i.b=n.b;break;case 5:i.r=n.b,i.g=s,i.b=l}return i.r=Math.round(255*i.r),i.g=Math.round(255*i.g),i.b=Math.round(255*i.b),i}var n=EJSS_DRAWING2D.ColorMapper,i=[];e<2&&(e=2);for(var o=0;o<e;o++){var a=o/(e-1)*.8,s=1,l=0,u=0,g=0;switch(t){case n.REDBLUE_SHADE:l=Math.floor(255*Math.max(0,-e-1+2*o)/(e-1)),g=Math.floor(255*Math.max(0,e-1-2*o)/(e-1)),i[o]="rgb("+l+","+u+","+g+")";break;case n.SPECTRUM:a=.8-a;var c=r(a,1,s);i[o]="rgb("+c.r+","+c.g+","+c.b+")";break;case n.GRAYSCALE:case n.BLACK:l=u=g=Math.floor(255*o/(e-1)),i[o]="rgb("+l+","+u+","+g+")";break;case n.RED:l=Math.floor(255*o/(e-1)),i[o]="rgb("+l+","+u+","+g+")";break;case n.GREEN:u=Math.floor(255*o/(e-1)),i[o]="rgb("+l+","+u+","+g+")";break;case n.BLUE:g=Math.floor(255*o/(e-1)),i[o]="rgb("+l+","+u+","+g+")";break;case n.DUALSHADE:default:var S=o/(e-1);a=.8*(1-S),s=.2+1.6*Math.abs(.5-S);var c=r(a,1,s);i[o]="rgb("+c.r+","+c.g+","+c.b+")"}}return i}},EJSS_DRAWING2D.colorMapper=function(e,t){var r,n,i,o=EJSS_DRAWING2D.ColorMapper,a={},s=[],l="darkgray",u="lightgray",g=-1,c=1;return a.setChangeListener=function(e){r=e},a.setPaletteType=function(t){"string"==typeof t&&(t=EJSS_DRAWING2D.ColorMapper[t.toUpperCase()]),n=t,l="darkgray",u="lightgray",n!=EJSS_DRAWING2D.ColorMapper.GRAYSCALE&&n!=EJSS_DRAWING2D.ColorMapper.BLACK||(l="rgb(64,64,128)",u="rgb(255,191,191)"),e=Math.max(2,e),s=o.getColorPalette(e,n),r&&r("palette")},a.getColors=function(){return s},a.getFloorColor=function(){return l},a.getCeilColor=function(){return u},a.getNumColors=function(){return e},a.setFloorCeilColor=function(e,t){l=e,u=t},a.setScale=function(e,t){g=e,c=t,i=new Array(s.length+1)
;for(var r=(c-g)/s.length,n=0,o=s.length;n<o;n++)i[n]=g+n*r;i[s.length]=c},a.getPaletteType=function(){return n},a.setColorPalette=function(t){l="darkgray",u="lightgray",s=t,e=t.length,n=EJSS_DRAWING2D.ColorMapper.CUSTOM,r&&r("colors")},a.setNumberOfColors=function(t){if(t!=e){if(e=t,n==EJSS_DRAWING2D.ColorMapper.CUSTOM){for(var i=[],o=0,s=Math.min(colors.length,e);o<s;o++)i[o]=colors[o];for(var o=colors.length;o<numColors;o++)i[o]=colors[colors.length-1];colors=i}else a.setPaletteType(n);r&&r("numColors")}},a.getNumberOfColors=function(){return e},a.doubleToIndex=function(e){if(g-e>Number.MIN_VALUE)return-1;if(e-c>Number.MIN_VALUE)return s.length;var t=0;return c!=g&&(t=Math.floor(s.length*(e-g)/(c-g))),t=Math.max(0,t),Math.min(t,s.length-1)},a.indexToColor=function(e){return e<0?l:e>=s.length?u:s[e]},a.doubleToColor=function(e){return a.indexToColor(a.doubleToIndex())},a.getColorThresholds=function(){return i},a.setPaletteType(t),a.setScale(-1,1),a};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Font={FONTSTYLES:["normal","italic","oblique","initial"],FONTWEIGHTS:["normal","lighter","bold","bolder","initial","100","200","300","400","500","600","700","800","900"],copyTo:function(e,t){t.setFontFamily(e.getFontFamily()),t.setFontSize(e.getFontSizeString()),t.setLetterSpacing(e.getLetterSpacing()),t.setOutlineColor(e.getOutlineColor()),t.setOutlineWidth(e.getOutlineWidth()),t.setFontWeight(e.getFontWeight()),t.setFillColor(e.getFillColor())}},EJSS_DRAWING2D.font=function(e){var t,r={},n="Arial",i="20",o="normal",a="none",s="1",l="normal",u="black",g="none";return r.setChangeListener=function(e){t=e},r.setFontFamily=function(e){n!=e&&(n=e,t&&t("fontFamily"))},r.getFontFamily=function(){return n},r.setFontSize=function(e){i!=e&&(i=e,t&&t("fontSize"))},r.getFontSize=function(){return isNaN(i)?-1!=i.indexOf("em")?10*+i.substr(0,i.indexOf("em")):-1!=i.indexOf("px")?+i.substr(0,i.indexOf("px")):0:+i},r.getFontSizeString=function(){return i},r.setLetterSpacing=function(e){o!=e&&(o=e,t&&t("letterSpacing"))},r.getLetterSpacing=function(){return o},r.getNumberLetterSpacing=function(){return isNaN(o)?-1!=o.indexOf("px")?+o.substr(0,o.indexOf("px")):1:+o},r.setOutlineColor=function(e){a!=e&&(a=e,t&&t("lineColor"))},r.getOutlineColor=function(){return a},r.setOutlineWidth=function(e){s!=e&&(s=e,t&&t("lineWidth"))},r.getOutlineWidth=function(){return s},r.setFontWeight=function(e){l!=e&&EJSS_DRAWING2D.Font.FONTWEIGHTS.indexOf(e)>-1&&(l=e,t&&t("fontWeight"))},r.getFontWeight=function(){return l},r.setFillColor=function(e){u!=e&&(u=e,t&&t("fillColor"))},r.getFillColor=function(){return u},r.setFontStyle=function(e){g!=e&&EJSS_DRAWING2D.Font.FONTSTYLES.indexOf(e)>-1&&(g=e,t&&t("fontstyle"))},r.getFontStyle=function(){return g},r.getFont=function(){return g+" "+s+" "+i+" "+n},r.setFont=function(e){if(!("string"!=typeof e||e.length<=0)){var t=e.split(" ");g=t[0],l=t[1];var r=t[2].split("/");i=r[0],t[3]&&(n=e.substring(e.indexOf(t[3])))}},r};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.functionsParser=function(){function e(e){function t(){}return t.prototype=e,new t}function t(e,t,r,n){this.type_=e,this.index_=t||0,this.prio_=r||0,this.number_=void 0!==n&&null!==n?n:0,this.toString=function(){switch(this.type_){case C:return this.number_;case D:case I:case R:return this.index_;case _:return"CALL";default:return"Invalid Token"}}}function r(e,t,r,n){this.tokens=e,this.ops1=t,this.ops2=r,this.functions=n}function n(e){return"string"==typeof e?(T.lastIndex=0,T.test(e)?"'"+e.replace(T,function(e){var t=N[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+"'":"'"+e+"'"):e}function i(e,t){return Number(e)+Number(t)}function o(e,t){return e-t}function a(e,t){return e*t}function s(e,t){return e/t}function l(e,t){return e%t}function u(e,t){return""+e+t}function g(e){return-e}function c(e){return Math.random()*(e||1)}function S(e){e=Math.floor(e);for(var t=e;e>1;)t*=--e;return t}function d(e,t){return Math.sqrt(e*e+t*t)}function f(e,t,r){return e?t:r}function E(e){return e<0?0:1}function p(e,t){return"[object Array]"!=Object.prototype.toString.call(e)?[e,t]:(e=e.slice(),e.push(t),e)}function h(e,t){return e>t?1:0}function m(e,t){return e<t?1:0}function A(e,t){return e==t?1:0}function P(e,t){return e!=t?1:0}function v(){this.success=!1,this.errormsg="",this.expression="",this.pos=0,this.tokennumber=0,this.tokenprio=0,this.tokenindex=0,this.tmpprio=0,this.ops1={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sqrt:Math.sqrt,log:Math.log,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,"-":g,exp:Math.exp},this.ops2={"+":i,"-":o,"*":a,"/":s,"%":l,"^":Math.pow,",":p,"||":u,">":h,"<":m,"==":A,"!=":P},this.functions={random:c,fac:S,min:Math.min,max:Math.max,pyt:d,step:E,pow:Math.pow,atan2:Math.atan2,if:f},this.consts={E:Math.E,pi:Math.PI,PI:Math.PI}}var y={},C=0,D=1,I=2,R=3,_=4,T=/[\\\'\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,N={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","'":"\\'","\\":"\\\\"};r.prototype={simplify:function(n){n=n||{};var i,o,a,s,l=[],u=[],g=this.tokens.length,c=0;for(c=0;c<g;c++){s=this.tokens[c];var S=s.type_;if(S===C)l.push(s);else if(S===R&&s.index_ in n)s=new t(C,0,0,n[s.index_]),l.push(s);else if(S===I&&l.length>1)o=l.pop(),i=l.pop(),a=this.ops2[s.index_],s=new t(C,0,0,a(i.number_,o.number_)),l.push(s);else if(S===D&&l.length>0)i=l.pop(),a=this.ops1[s.index_],s=new t(C,0,0,a(i.number_)),l.push(s);else{for(;l.length>0;)u.push(l.shift());u.push(s)}}for(;l.length>0;)u.push(l.shift());return new r(u,e(this.ops1),e(this.ops2),e(this.functions))},substitute:function(n,i){i instanceof r||(i=(new v).parse(String(i)));var o,a=[],s=this.tokens.length,l=0;for(l=0;l<s;l++){o=this.tokens[l];if(o.type_===R&&o.index_===n)for(var u=0;u<i.tokens.length;u++){var g=i.tokens[u],c=new t(g.type_,g.index_,g.prio_,g.number_);a.push(c)}else a.push(o)}return new r(a,e(this.ops1),e(this.ops2),e(this.functions))},evaluate:function(e){e=e||{};var t,r,n,i,o=[],a=this.tokens.length,s=0;for(s=0;s<a;s++){i=this.tokens[s];var l=i.type_;if(l===C)o.push(i.number_);else if(l===I)r=o.pop(),t=o.pop(),n=this.ops2[i.index_],o.push(n(t,r));else if(l===R)if(i.index_ in e)o.push(e[i.index_]);else{if(!(i.index_ in this.functions))throw new Error("undefined variable: "+i.index_);o.push(this.functions[i.index_])}else if(l===D)t=o.pop(),n=this.ops1[i.index_],o.push(n(t));else{if(l!==_)throw new Error("invalid Expression");if(t=o.pop(),n=o.pop(),!n.apply||!n.call)throw new Error(n+" is not a function");"[object Array]"==Object.prototype.toString.call(t)?o.push(n.apply(void 0,t)):o.push(n.call(void 0,t))}}if(o.length>1)throw new Error("invalid Expression (parity)");return o[0]},toString:function(e){var t,r,i,o,a=[],s=this.tokens.length,l=0;for(l=0;l<s;l++){o=this.tokens[l];var u=o.type_;if(u===C)a.push(n(o.number_));else if(u===I)r=a.pop(),t=a.pop(),i=o.index_,e&&"^"==i?a.push("Math.pow("+t+","+r+")"):a.push("("+t+i+r+")");else if(u===R)a.push(o.index_);else if(u===D)t=a.pop(),i=o.index_,"-"===i?a.push("("+i+t+")"):a.push(i+"("+t+")");else{if(u!==_)throw new Error("invalid Expression");t=a.pop(),i=a.pop(),a.push(i+"("+t+")")}}if(a.length>1)throw new Error("invalid Expression (parity)");return a[0]},variables:function(){for(var e=this.tokens.length,t=[],r=0;r<e;r++){var n=this.tokens[r];n.type_===R&&-1==t.indexOf(n.index_)&&t.push(n.index_)}return t},toJSFunction:function(e,t){return new Function(e,"with(Parser.values) { return "+this.simplify(t).toString(!0)+"; }")}},y.parse=function(e){return(new v).parse(e)},y.evaluate=function(e,t){return v.parse(e).evaluate(t)},v.Expression=r,v.values={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sqrt:Math.sqrt,log:Math.log,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,random:c,fac:S,exp:Math.exp,min:Math.min,max:Math.max,pyt:d,ifelse:f,step:E,pow:Math.pow,atan2:Math.atan2,E:Math.E,pi:Math.PI,PI:Math.PI};return v.prototype={parse:function(n){this.errormsg="",this.success=!0;var i=[],o=[];this.tmpprio=0;var a=77,s=0;for(this.expression=n,this.pos=0;this.pos<this.expression.length;)if(this.isOperator())this.isSign()&&64&a?(this.isNegativeSign()&&(this.tokenprio=2,this.tokenindex="-",s++,this.addfunc(o,i,D)),a=77):this.isComment()||(0==(2&a)&&this.error_parsing(this.pos,"unexpected operator"),s+=2,this.addfunc(o,i,I),a=77);else if(this.isNumber()){0==(1&a)&&this.error_parsing(this.pos,"unexpected number");var l=new t(C,0,0,this.tokennumber);o.push(l),a=50}else if(this.isString()){0==(1&a)&&this.error_parsing(this.pos,"unexpected string");var l=new t(C,0,0,this.tokennumber);o.push(l),a=50}else if(this.isLeftParenth())0==(8&a)&&this.error_parsing(this.pos,'unexpected "("'),128&a&&(s+=2,this.tokenprio=-2,this.tokenindex=-1,this.addfunc(o,i,_)),a=333;else if(this.isRightParenth()){if(256&a){var l=new t(C,0,0,[]);o.push(l)}else 0==(16&a)&&this.error_parsing(this.pos,'unexpected ")"');a=186}else if(this.isComma())0==(32&a)&&this.error_parsing(this.pos,'unexpected ","'),this.addfunc(o,i,I),s+=2,a=77;else if(this.isConst()){0==(1&a)&&this.error_parsing(this.pos,"unexpected constant");var u=new t(C,0,0,this.tokennumber);o.push(u),a=50}else if(this.isOp2())0==(4&a)&&this.error_parsing(this.pos,"unexpected function"),this.addfunc(o,i,I),s+=2,a=8;else if(this.isOp1())0==(4&a)&&this.error_parsing(this.pos,"unexpected function"),this.addfunc(o,i,D),s++,a=8;else if(this.isVar()){0==(1&a)&&this.error_parsing(this.pos,"unexpected variable");var g=new t(R,this.tokenindex,0,0);o.push(g),a=186}else this.isWhite()||(""===this.errormsg?this.error_parsing(this.pos,"unknown character"):this.error_parsing(this.pos,this.errormsg));for((this.tmpprio<0||this.tmpprio>=10)&&this.error_parsing(this.pos,'unmatched "()"');i.length>0;){var c=i.pop();o.push(c)}return s+1!==o.length&&this.error_parsing(this.pos,"parity"),new r(o,e(this.ops1),e(this.ops2),e(this.functions))},evaluate:function(e,t){return this.parse(e).evaluate(t)},error_parsing:function(e,t){throw this.success=!1,this.errormsg="parse error [column "+e+"]: "+t,new Error(this.errormsg)},addfunc:function(e,r,n){for(var i=new t(n,this.tokenindex,this.tokenprio+this.tmpprio,0);r.length>0&&i.prio_<=r[r.length-1].prio_;)e.push(r.pop());r.push(i)},isNumber:function(){for(var e=!1,t="";this.pos<this.expression.length;){var r=this.expression.charCodeAt(this.pos);if(!(r>=48&&r<=57||46===r))break;t+=this.expression.charAt(this.pos),this.pos++,this.tokennumber=parseFloat(t),e=!0}return e},unescape:function(e,t){for(var r=[],n=!1,i=0;i<e.length;i++){var o=e.charAt(i);if(n){switch(o){case"'":r.push("'");break;case"\\":r.push("\\");break;case"/":r.push("/");break;case"b":r.push("\b");break;case"f":r.push("\f");break;case"n":r.push("\n");break;case"r":r.push("\r");break;case"t":r.push("\t");break;case"u":var a=parseInt(e.substring(i+1,i+5),16);r.push(String.fromCharCode(a)),i+=4;break;default:throw this.error_parsing(t+i,"Illegal escape sequence: '\\"+o+"'")}n=!1}else"\\"==o?n=!0:r.push(o)}return r.join("")},isString:function(){var e=!1,t="",r=this.pos;if(this.pos<this.expression.length&&"'"==this.expression.charAt(this.pos))for(this.pos++;this.pos<this.expression.length;){var n=this.expression.charAt(this.pos);if("'"==n&&"\\"!=t.slice(-1)){this.pos++,this.tokennumber=this.unescape(t,r),e=!0;break}t+=this.expression.charAt(this.pos),this.pos++}return e},isConst:function(){var e;for(var t in this.consts){var r=t.length;if(e=this.expression.substr(this.pos,r),t===e)return this.tokennumber=this.consts[t],this.pos+=r,!0}return!1},isOperator:function(){var e=this.expression.charCodeAt(this.pos);if(43===e)this.tokenprio=0,this.tokenindex="+";else if(45===e)this.tokenprio=0,this.tokenindex="-";else if(124===e){if(124!==this.expression.charCodeAt(this.pos+1))return!1;this.pos++,this.tokenprio=0,this.tokenindex="||"}else if(61===e){if(61!==this.expression.charCodeAt(this.pos+1))return!1;this.pos++,this.tokenprio=0,this.tokenindex="=="}else if(33===e){if(61!==this.expression.charCodeAt(this.pos+1))return!1;this.pos++,this.tokenprio=0,this.tokenindex="!="}else if(42===e)this.tokenprio=1,this.tokenindex="*";else if(47===e)this.tokenprio=2,this.tokenindex="/";else if(37===e)this.tokenprio=2,this.tokenindex="%";else if(94===e)this.tokenprio=3,this.tokenindex="^";else if(60===e)this.tokenprio=2,this.tokenindex="<";else{if(62!==e)return!1;this.tokenprio=2,this.tokenindex=">"}return this.pos++,!0},isSign:function(){var e=this.expression.charCodeAt(this.pos-1);return 45===e||43===e},isPositiveSign:function(){return 43===this.expression.charCodeAt(this.pos-1)},isNegativeSign:function(){return 45===this.expression.charCodeAt(this.pos-1)},isLeftParenth:function(){return 40===this.expression.charCodeAt(this.pos)&&(this.pos++,this.tmpprio+=10,!0)},isRightParenth:function(){return 41===this.expression.charCodeAt(this.pos)&&(this.pos++,this.tmpprio-=10,!0)},isComma:function(){return 44===this.expression.charCodeAt(this.pos)&&(this.pos++,this.tokenprio=-1,this.tokenindex=",",!0)},isWhite:function(){var e=this.expression.charCodeAt(this.pos);return(32===e||9===e||10===e||13===e)&&(this.pos++,!0)},isOp1:function(){for(var e="",t=this.pos;t<this.expression.length;t++){var r=this.expression.charAt(t);if(r.toUpperCase()===r.toLowerCase()&&(t===this.pos||"_"!=r&&(r<"0"||r>"9")))break;e+=r}return e.length>0&&e in this.ops1&&(this.tokenindex=e,this.tokenprio=5,this.pos+=e.length,!0)},isOp2:function(){for(var e="",t=this.pos;t<this.expression.length;t++){var r=this.expression.charAt(t);if(r.toUpperCase()===r.toLowerCase()&&(t===this.pos||"_"!=r&&(r<"0"||r>"9")))break;e+=r}return e.length>0&&e in this.ops2&&(this.tokenindex=e,this.tokenprio=5,this.pos+=e.length,!0)},isVar:function(){for(var e="",t=this.pos;t<this.expression.length;t++){var r=this.expression.charAt(t);if(r.toUpperCase()===r.toLowerCase()&&(t===this.pos||"_"!=r&&(r<"0"||r>"9")))break;e+=r}return e.length>0&&(this.tokenindex=e,this.tokenprio=4,this.pos+=e.length,!0)},isComment:function(){return 47===this.expression.charCodeAt(this.pos-1)&&42===this.expression.charCodeAt(this.pos)&&(this.pos=this.expression.indexOf("*/",this.pos)+2,1===this.pos&&(this.pos=this.expression.length),!0)}},y};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.InteractionTarget={ENABLED_FIXED:0,ENABLED_NONE:0,ENABLED_ANY:1,ENABLED_X:2,ENABLED_Y:3,ENABLED_NO_MOVE:4,SENSITIVITY_BOTH:0,SENSITIVITY_HORIZONTAL:1,SENSITIVITY_VERTICAL:2,SENSITIVITY_ANY:3,copyTo:function(e,t){t.setMotionEnabled(e.getMotionEnabled()),t.setAffectsGroup(e.getAffectsGroup()),t.setActionCommand(e.getActionCommand()),t.setDataObject(e.getDataObject()),t.setSensitivity(e.getSensitivity())}},EJSS_DRAWING2D.interactionTarget=function(e,t,r){var n=EJSS_DRAWING2D.InteractionTarget,i={},o=EJSS_DRAWING2D.Element,a=n.ENABLED_NONE,s=!1,l=null,u=null,g=20,c=n.SENSITIVITY_BOTH;return i.getElement=function(){return e},i.getType=function(){return t},i.setMotionEnabled=function(e){"string"==typeof e?(value=n[e.toUpperCase()],a="undefined"==typeof value?n.ENABLED_NONE:value):a=e},i.getMotionEnabled=function(){return a},i.setSensitivityType=function(e){c="string"==typeof e?n[e.toUpperCase()]:e},i.getSensitivityType=function(){return c},i.isEnabled=function(){return a!=n.ENABLED_NONE},i.setPositionOffset=function(e){r=e},i.getPixelPosition=function(){var t=e.getPixelPosition(!0),n=e.getPixelSizes(!0),i=e.getRelativePositionOffset(n),a=t[0]+i[0],s=t[1]+i[1],l=e.getPanel().getInvertedScaleY(),u=o.getRelativePositionOffset(r,n[0],n[1],l);return[a-u[0],s-u[1]]},i.getPosition=function(){var t=e.getAbsolutePosition(!0),n=e.getAbsoluteSize(),i=e.getPanel().getInvertedScaleY(),a=o.getRelativePositionOffset(r,n[0],n[1],i),s=e.getRelativePositionOffset(n);return[t[0]+s[0]-a[0],t[1]+s[1]-a[1]]},i.setAffectsGroup=function(e){s=e},i.getAffectsGroup=function(){return s},i.setSensitivity=function(e){g=e},i.getSensitivity=function(){return g},i.setActionCommand=function(e){l=e},i.getActionCommand=function(){return l},i.setDataObject=function(e){u=e},i.getDataObject=function(){return u},i};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.PanelInteraction={TARGET_POSITION:0,TARGET_SIZE:1},EJSS_DRAWING2D.panelInteraction=function(e){function t(t,r,n,i){var o=EJSS_DRAWING2D.InteractionTarget,a=EJSS_DRAWING2D.PanelInteraction;if(r.getType()===a.TARGET_POSITION){var s=n[0]-i[0],l=n[1]-i[1];switch(r.getMotionEnabled()){case o.ENABLED_ANY:t.setX(t.getX()+s),t.setY(t.getY()+l),t.getController().propertiesChanged("Position","X","Y"),r.getElement().setChanged(!0),t.setChanged(!0);break;case o.ENABLED_X:t.setX(t.getX()+s),t.getController().propertiesChanged("Position","X"),r.getElement().setChanged(!0),t.setChanged(!0);break;case o.ENABLED_Y:t.setY(t.getY()+l),t.getController().propertiesChanged("Position","Y"),r.getElement().setChanged(!0),t.setChanged(!0)}}else if(r.getType()===a.TARGET_SIZE){if(2==E)var u=e.toPanelMod(h),s=u[0],l=-u[1];else var s=n[0]-i[0],l=n[1]-i[1];var g=r.getElement(),c=g.getAbsoluteSize();0===c[0]&&(c[0]=1e-5),0===c[1]&&(c[1]=1e-5);var S=[s/c[0],l/c[1]],d=t.getSize();switch(0===d[0]&&0!==S[0]&&(d[0]=1e-5),0===d[1]&&0!==S[0]&&(d[1]=1e-5),r.getMotionEnabled()){case o.ENABLED_ANY:t.setSizeX(d[0]+d[0]*S[0]),t.setSizeY(d[1]+d[1]*S[1]),t.getController().propertiesChanged("Size","SizeX","SizeY"),r.getElement().setChanged(!0),t.setChanged(!0);break;case o.ENABLED_X:t.setSizeX(d[0]+d[0]*S[0]),t.getController().propertiesChanged("Size","SizeX"),r.getElement().setChanged(!0),t.setChanged(!0);break;case o.ENABLED_Y:t.setSizeY(d[1]+d[1]*S[1]),t.getController().propertiesChanged("Size","SizeY"),r.getElement().setChanged(!0),t.setChanged(!0)}}}function r(t){var r=e.getGraphics().getBox(),n=r.left,i=r.top,o=[];if(void 0!==t.changedTouches)for(var a=0;a<t.changedTouches.length;a++)o[a]=[],o[a][0]=t.changedTouches[a].pageX-n,o[a][1]=t.changedTouches[a].pageY-i;else o[0]=[],o[0][0]=(t.clientX||t.x)-n,o[0][1]=(t.clientY||t.y)-i;return o}var n={},i=EJSS_DRAWING2D.PanelInteraction,o=!1,a=!1,s=!1,l=[],u=[],g=[],c=null,S=!1,d=!1,f=0,E=0,p=[0,0],h=[0,0],m=0,A="move",P=0;n.reload=function(){l=[],u=[],g=[],c=null,d=!1,f=0,E=0,p=[0,0],h=[0,0],m=0,P=0,o=!o,n.setEnabled(!o),a=!a,n.setStopGestures(!a)},n.getPanel=function(){return e},n.getEnabled=function(){return o},n.setStopMoveEvents=function(e){s!=e&&(s=e,s?n.setHandler("move",function(){return!0}):n.setHandler("move",n.handleMouseMoveEvent))},n.setStopGestures=function(e){a!=e&&(a=e,a?(n.setHandler("gesturestart",function(e){return e.preventDefault(),e.stopPropagation(),!1}),n.setHandler("gesturechange",function(e){return e.preventDefault(),e.stopPropagation(),!1}),n.setHandler("gestureend",function(e){return e.preventDefault(),e.stopPropagation(),!1})):(n.setHandler("gesturestart",function(){return!0}),n.setHandler("gesturechange",function(){return!0}),n.setHandler("gestureend",function(){return!0})))},n.setEnabled=function(e){o!=e&&(o=e,o?(s||n.setHandler("move",n.handleMouseMoveEvent),n.setHandler("down",n.handleMouseDownEvent),n.setHandler("up",n.handleMouseUpEvent),n.setHandler("mousewheel",n.handleMouseWheelEvent)):(n.setHandler("move",function(){return!0}),n.setHandler("down",function(){return!0}),n.setHandler("up",function(){return!0}),n.setHandler("mousewheel",function(){return!0})))},n.setCursorTypeForMove=function(e){A=e},n.getInteractionPoint=function(){return e.toPanelPosition(l)},n.getInteractionDistance=function(){if(0==g.length||0==l.length)return[];var t=e.toPanelPosition(g),r=e.toPanelPosition(l);return[t[0]-r[0],t[1]-r[1]]},n.getInteractionBounds=function(){if(0==u.length||0==l.length)return[];var t=e.toPanelPosition(u),r=e.toPanelPosition(l);return[t[0],r[0],t[1],r[1]]},n.getInteractionZoomDelta=function(){return 0==m&&0==h[0]?0:m>0||h[0]>0?1:-1},n.getInteractionElement=function(){return c},n.getOrientation=function(){return window.orientation},n.handleMouseMoveEvent=function(i){if(a&&(i.preventDefault(),i.stopPropagation()),2==(void 0!==i.touches?i.touches.length:1)){var s=i.touches[0],u=i.touches[1],f=s.clientX||s.x,m=s.clientY||s.y,P=u.clientX||u.x,v=u.clientY||u.y;if(0!=E){var y=[Math.abs(f-P),Math.abs(m-v)],C=[y[0]-p[0],y[1]-p[1]];C[0]<8&&C[0]>-8&&C[1]<8&&C[1]>-8?h=[0,0]:(h=C,p=y)}else E=1,p=[Math.abs(f-P),Math.abs(m-v)],h=[0,0]}else E=0,p=[0,0];var D=r(i);if(g=l,l=D[D.length-1],d)if(null!=c){var I=c.getAffectsGroup()?c.getElement().getGroup():c.getElement(),R=e.toPanelPosition(l),_=e.toPanelPosition(g);t(I,c,R,_),I.getController().invokeAction("OnDrag"),o&&e.getController().invokeAction("OnMove")}else if(S)o&&e.getController().invokeAction("OnDrag");else{for(var T=[],N=0;N<D.length;N++){var O=n.findInteractionTarget(e.getElements(),D[N]);if(null!=O){T.push(O);var I=O.getAffectsGroup()?O.getElement().getGroup():O.getElement(),R=e.toPanelPosition(D[N]);t(I,O,R,O.getPosition()),I.getController().invokeAction("OnDrag"),o&&e.getController().invokeAction("OnMove")}}o&&(0==E?e.getController().invokeAction("OnDrag"):1==E&&0==T.length&&e.getController().invokeAction("OnZoom"))}else{var O=n.findInteractionTarget(e.getElements(),D[0]);null===O?(null!=c&&c.getElement().getController().invokeAction("OnExit"),o&&e.getController().invokeAction("OnMove"),i.target.style.cursor="default"):(c!=O&&(null!=c&&c.getElement().getController().invokeAction("OnExit"),O.getElement().getController().invokeAction("OnEnter")),O.isEnabled()?i.target.style.cursor=A:i.target.style.cursor="default"),c=O}return e.getController().reportInteractions(),!1},n.handleMouseDownEvent=function(t){d=!0,s&&n.setHandler("move",n.handleMouseMoveEvent),a&&(t.preventDefault(),t.stopPropagation());var i=void 0!==t.touches?t.touches.length:1;2!=i&&(E=0);var f=r(t);u=f[0],g=u,l=f[f.length-1];for(var p=!1,h=null,m=0;m<f.length;m++)h=n.findInteractionTarget(e.getElements(),f[m]),null!==h?(h.getElement().getController().invokeAction("OnPress"),t.target.style.cursor=A):o&&(e.getController().invokeAction("OnPress"),p=!0);return 1==f.length&&1==i?(c=h,S=p):(c=null,S=!1),e.getController().reportInteractions(),!1},n.handleMouseUpEvent=function(t){d=!1,s&&n.setHandler("move",function(){return!0}),a&&(t.preventDefault(),t.stopPropagation()),0!=E&&(E=0,h=[0,0],p=[0,0]);var i=r(t);if(g=l,l=i[i.length-1],null!=c)c.getElement().getController().invokeAction("OnRelease");else for(var u=0;u<i.length;u++){var S=n.findInteractionTarget(e.getElements(),i[u]);null!==S?S.getElement().getController().invokeAction("OnRelease"):o&&e.getController().invokeAction("OnRelease")}return t.timeStamp-f<500&&e.getController().invokeAction("OnDoubleClick"),f=t.timeStamp,t.target.style.cursor="default",e.getController().reportInteractions(),!1},n.handleMouseWheelEvent=function(t){0==(void 0!==t.touches?t.touches.length:0)&&(a&&(t.preventDefault(),t.stopPropagation()),m=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail)),e.getController().invokeAction("OnZoom"),e.getController().reportInteractions())},n.findInteractionTarget=function(t,r){for(var o=EJSS_DRAWING2D.InteractionTarget,a=null,s=t.length-1;s>=0;s--){var l=t[s];if(l.isGroupVisible())if(l.getElements){if(null!==(a=n.findInteractionTarget(l.getElements(),r)))return a}else{for(var u=l.getInteractionTargets(),g=0;g<u.length;g++)if(u[g].isEnabled()){var c=u[g].getSensitivity();if(c>0){var S=u[g].getPixelPosition(),d=!1;switch(u[g].getSensitivityType()){case o.SENSITIVITY_HORIZONTAL:d=Math.abs(S[1]-r[1])<c;break;case o.SENSITIVITY_VERTICAL:d=Math.abs(S[0]-r[0])<c;break;case o.SENSITIVITY_ANY:d=Math.abs(S[0]-r[0])<c||Math.abs(S[1]-r[1])<c;break;default:d=Math.abs(S[0]-r[0])<c&&Math.abs(S[1]-r[1])<c}if(d)return P=s,u[g]}}if(0!=E&&(a=l.getInteractionTarget(i.TARGET_SIZE),a.isEnabled()&&!a.getSensitivity())){var f=l.getAbsoluteBounds(),p=e.toPanelPosition(r);if(f.left<p[0]&&f.right>p[0]&&f.bottom<p[1]&&f.top>p[1])return P=s,E=2,a}if(a=l.getInteractionTarget(i.TARGET_POSITION),a.isEnabled()&&!a.getSensitivity()){var f=l.getAbsoluteBounds(),p=e.toPanelPosition(r);if(f.left<p[0]&&f.right>p[0]&&f.bottom<p[1]&&f.top>p[1])return P=s,a}}}return null},n.getIndexElement=function(){return P},n.setHandler=function(t,r){var n=e.getGraphics(),i=n.getEventContext();switch(t){case"move":i.addEventListener("mousemove",r,!1),i.addEventListener("touchmove",r,!1);break;case"down":i.addEventListener("mousedown",r,!1),i.addEventListener("touchstart",r,!1);break;case"up":i.addEventListener("mouseup",r,!1),i.addEventListener("touchend",r,!1);break;case"mousewheel":i.addEventListener("mousewheel",r,!1);break;case"gesturestart":i.addEventListener("gesturestart",r,!1);break;case"gesturechange":i.addEventListener("gesturechange",r,!1);break;case"gestureend":i.addEventListener("gestureend",r,!1)}return!1};var v=window.onorientationchange;window.onorientationchange=function(){v&&v(),e.getController().invokeAction("OnOrientationChange"),e.getController().reportInteractions()};var y=window.onresize;return window.onresize=function(){y&&y(),e.getController().invokeAction("OnResize"),e.getController().reportInteractions()},n.setStopGestures(!0),n};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Style={RENDER_AUTO:"auto",RENDER_OPTSPEED:"optimizeSpeed",RENDER_CRISPEDGES:"crispEdges",RENDER_GEOPRECISION:"geometricPrecision",copyTo:function(e,t){t.setDrawLines(e.getDrawLines()),t.setLineColor(e.getLineColor()),t.setLineWidth(e.getLineWidth()),t.setDrawFill(e.getDrawFill()),t.setFillColor(e.getFillColor()),t.setAttributes(e.getAttributes()),t.setShapeRendering(e.getShapeRendering())}},EJSS_DRAWING2D.style=function(e){var t,r=EJSS_DRAWING2D.Style,n={},i=!0,o="black",a=.5,s=!0,l="none",u=r.RENDER_AUTO,g={};return n.setChangeListener=function(e){t=e},n.setDrawLines=function(e){e!=i&&(i=e,t&&t("drawlines"))},n.getDrawLines=function(){return i},n.setLineColor=function(e){return"string"!=typeof e&&(e=EJSS_TOOLS.DisplayColors.getLineColor(e)),e!=o&&(o=e,t&&t("linecolor")),n},n.getLineColor=function(){return o},n.setLineWidth=function(e){e!=a&&(a=e,t&&t("linewidth"))},n.getLineWidth=function(){return a},n.setDrawFill=function(e){e!=s&&(s=e,t&&t("drawfill"))},n.getDrawFill=function(){return s},n.setFillColor=function(e){"string"!=typeof e&&(e=EJSS_TOOLS.DisplayColors.getLineColor(e)),e!=l&&(l=e,t&&t("fillcolor"))},n.getFillColor=function(){return l},n.setShapeRendering=function(e){"RENDER"==e.substring(0,6)&&(e=r[e.toUpperCase()]),u!=e&&(u=e,t&&t("shaperendering"))},n.getShapeRendering=function(){return u},n.setAttributes=function(e){e!=g&&(g=e,t&&t("attributes"))},n.getAttributes=function(){return g},n.serialize=function(){return{mDrawLines:i,mLineColor:o,mLineWidth:a,mDrawFill:s,mFillColor:l,mShapeRendering:u,mAttributes:g}},n.unserialize=function(e){i=e.mDrawLines,o=e.mLineColor,a=e.mLineWidth,s=e.mDrawFill,l=e.mFillColor,u=e.mShapeRendering,g=e.mAttributes},n};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Transformation={compare:function(e,t){return e.radians==t.radians&&e.a==t.a&&e.b==t.b&&e.c==t.c&&e.d==t.d&&e.e==t.e&&e.f==t.f}},EJSS_DRAWING2D.transformation=function(e){e=e||{a:1,b:0,c:0,d:1,e:0,f:0};var t={a:e.a,c:e.c,e:e.e,b:e.b,d:e.d,f:e.f,radians:0};return t.toString=function(){return"a="+t.a+", c="+t.c+", e="+t.e+"\nb="+t.b+", d="+t.d+", f="+t.f},t.setToIdentity=function(){t.a=1,t.c=0,t.e=0,t.b=0,t.d=1,t.f=0,radians=0},t.setTransform=function(e){Array.isArray(e)&&e.length>5?(t.a=e[0],t.c=e[2],t.e=e[4],t.b=e[1],t.d=e[3],t.f=e[5]):(t.a=e.a,t.c=e.c,t.e=e.e,t.b=e.b,t.d=e.d,t.f=e.f,t.radians=e.radians)},t.setToTranslation=function(e,r){t.a=1,t.c=0,t.e=e,t.b=0,t.d=1,t.f=r},t.setToRotation=function(e){var r=Math.cos(e),n=Math.sin(e);t.a=r,t.c=-n,t.e=0,t.b=n,t.d=r,t.f=0,t.radians=e},t.getRotation=function(){return t.radians},t.translate=function(e,r){t.e+=e,t.f+=r},t.scale=function(e,r){t.a*=e,t.b*=e,t.c*=r,t.d*=r},t.concatenate=function(e){var r=t.a,n=t.b,i=t.c,o=t.d,a=t.e,s=t.f;t.a=r*e.a+i*e.b,t.b=n*e.a+o*e.b,t.c=r*e.c+i*e.d,t.d=n*e.c+o*e.d,t.e=r*e.e+i*e.f+a,t.f=n*e.e+o*e.f+s,t.radians+=e.radians},t.transform=function(e){var r=e[0],n=e[1];return e[0]=t.a*r+t.c*n+t.e,e[1]=t.b*r+t.d*n+t.f,e},t.transformVector=function(e){var r=e[0],n=e[1];return e[0]=t.a*r+t.c*n,e[1]=t.b*r+t.d*n,e},t.inverseTransform=function(e){var r=t.a,n=t.b,i=t.c,o=t.d,a=t.e,s=t.f,l=r*o-n*i;if(0===l)return null;var u=e[0],g=e[1];return e[0]=(o*u-i*g+(i*s-o*a))/l,e[1]=(-n*u+r*g+(n*a-r*s))/l,e},t};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Video={},EJSS_DRAWING2D.video=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.WebCamImage={},EJSS_DRAWING2D.webCamImage=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.AnalyticCurve={},EJSS_DRAWING3D.analyticCurve=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.AnalyticSurface={},EJSS_DRAWING3D.analyticSurface=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Arrow={},EJSS_DRAWING3D.arrow=function(e){},EJSS_DRAWING3D.ArrowSet={},EJSS_DRAWING3D.arrowSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Basic={},EJSS_DRAWING3D.basic=function(e){},EJSS_DRAWING3D.BasicSet={},EJSS_DRAWING3D.basicSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Box={},EJSS_DRAWING3D.box=function(e){},EJSS_DRAWING3D.BoxSet={},EJSS_DRAWING3D.boxSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Cone={},EJSS_DRAWING3D.cone=function(e){},EJSS_DRAWING3D.ConeSet={},EJSS_DRAWING3D.coneSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Cylinder={},EJSS_DRAWING3D.cylinder=function(e){},EJSS_DRAWING3D.CylinderSet={},EJSS_DRAWING3D.cylinderSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Disk={},EJSS_DRAWING3D.disk=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.DrawingPanel={},EJSS_DRAWING3D.drawingPanel=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Element={},EJSS_DRAWING3D.element=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.ElementSet={},EJSS_DRAWING3D.elementSet=function(e,t){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Ellipsoid={},EJSS_DRAWING3D.ellipsoid=function(e){},EJSS_DRAWING3D.EllipsoidSet={},EJSS_DRAWING3D.ellipsoidSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Group={},EJSS_DRAWING3D.group=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.panelInteraction=function(e){function t(t){var r,n,i=e.getGraphics().getBox(),o=i.left,a=i.top;return void 0!==t.changedTouches&&1===t.changedTouches.length?(r=t.changedTouches[0].pageX,n=t.changedTouches[0].pageY):(r=t.x||t.clientX,n=t.y||t.clientY),[r-o,n-a]}var r={},n=!1,i=[0,0],o=0,a=0,s=!1,l=0,u=0,g=0,c=0,S=!1,d=[0,0];return r.getPanel=function(){return e},r.getEnabled=function(){return n},r.setEnabled=function(e){n!=e&&(n=e,n?(r.setHandler("move",r.handleMouseMoveEvent),r.setHandler("down",r.handleMouseDownEvent),r.setHandler("up",r.handleMouseUpEvent),r.setHandler("mousewheel",r.handleMouseWheelEvent)):(r.setHandler("move",function(){}),r.setHandler("down",function(){}),r.setHandler("up",function(){}),r.setHandler("mousewheel",function(){})))},r.getInteractionPoint=function(){return i},r.getInteractionDeltas=function(){return[o,a]},r.getInteractionZoomDelta=function(){return g},r.handleMouseWheelEvent=function(t){0==(void 0!==t.touches?t.touches.length:0)&&(t.preventDefault(),g=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail)),e.getController().invokeAction("OnZoom"),e.getController().reportInteractions())},r.handlePinchGesture=function(t){t.timeStamp-u>100&&(t.preventDefault(),t.scale<c?g=1:t.scale>=c&&(g=-1),c=t.scale,e.getController().invokeAction("OnZoom"),e.getController().reportInteractions(),u=t.timeStamp)},r.handleMouseMoveEvent=function(r){var n=void 0!==r.touches?r.touches.length:1;if(1==n){var l=i[0],c=i[1];i=t(r),o=i[0]-l,a=i[1]-c,s?(e.getController().invokeAction("OnDrag"),r.target.style.cursor="move"):r.target.style.cursor="default"}if(2==n){if(r.timeStamp-u>25){r.preventDefault();var f=r.touches[0],E=r.touches[1],p=f.clientX||f.x,h=f.clientY||f.y,m=E.clientX||E.x,A=E.clientY||E.y;if(S){var P=[Math.abs(p-m),Math.abs(h-A)],v=P[0]-d[0];v<3&&v>-3?g=0:(g=v,d=P),e.getController().invokeAction("OnZoom")}else S=!0,d=[Math.abs(p-m),Math.abs(h-A)],g=0;u=r.timeStamp}}else S=!1,d=[0,0];e.getController().reportInteractions()},r.handleMouseDownEvent=function(n){1==(void 0!==n.touches?n.touches.length:1)&&(s=!0,i=t(n),e.getController().invokeAction("OnPress"),r.pick(i[0],i[1]),n.preventDefault(),e.getController().reportInteractions()),S=!1},r.handleMouseUpEvent=function(r){1==(void 0!==r.touches?r.touches.length:1)&&(s=!1,i=t(r),e.getController().invokeAction("OnRelease"),r.target.style.cursor="default",r.timeStamp-l<500&&e.getController().invokeAction("OnDoubleClick"),l=r.timeStamp,e.getController().reportInteractions()),S=!1},r.setHandler=function(t,r){var n=e.getGraphics(),i=n.getEventContext();switch(t){case"move":i.addEventListener("mousemove",r,!1),i.addEventListener("touchmove",r,!1);break;default:case"down":i.addEventListener("mousedown",r,!1),i.addEventListener("touchstart",r,!1);break;case"up":i.addEventListener("mouseup",r,!1),i.addEventListener("touchend",r,!1);break;case"mousewheel":i.addEventListener("mousewheel",r,!1);break;case"pinch":i.addEventListener("gesturestart",function(e){c=1},!1),i.addEventListener("gesturechange",r,!1)}return!1},r.pick=function(t,r){var n=t-1,i=r-1,o=e.getGraphics().getContext();if(o){var a=new Uint8Array(4);o.readPixels(n,i,1,1,o.RGBA,o.UNSIGNED_BYTE,a),a.data&&(a=a.data)}},r};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Style={copyTo:function(e,t){t.setClosedTop(e.getClosedTop()),t.setClosedBottom(e.getClosedBottom()),t.setClosedLeft(e.getClosedLeft()),t.setClosedRight(e.getClosedRight()),t.setDrawLines(e.getDrawLines()),t.setLineColor(e.getLineColor()),t.setLineWidth(e.getLineWidth()),t.setDrawFill(e.getDrawFill()),t.setTransparency(e.getTransparency()),t.setAmbientColor(e.getAmbientColor()),t.setFillColor(e.getFillColor()),t.setSpecularColor(e.getSpecularColor()),t.setAmbientReflection(e.getAmbientReflection()),t.setColorReflection(e.getColorReflection()),t.setSpecularReflection(e.getSpecularReflection()),t.setShininessVal(e.getShininessVal()),t.setPaletteFloor(e.getPaletteFloor()),t.setPaletteCeil(e.getPaletteCeil()),t.setPaletteFloorColor(e.getPaletteFloorColor()),t.setPaletteCeilColor(e.getPaletteCeilColor())}},EJSS_DRAWING3D.style=function(e){var t,r,n,i,o={},a=!0,s=!0,l=!0,u=!0,g=[0,0,0],c=.5,S=[0,0,0],d=[0,0,0],f=[1,1,1],E=1,p=1,h=1,m=10,A=[1,0,-1],P=[-1,0,1],v=!1,y=!0,C=0;return o.setProjChangeListener=function(e){n=e},o.setMeshChangeListener=function(e){i=e},o.setClosedTop=function(e){e!=a&&(a=e,i&&i("closedtop"))},o.getClosedTop=function(){return a},o.setClosedBottom=function(e){e!=s&&(s=e,i&&i("closedbottom"))},o.getClosedBottom=function(){return s},o.setClosedLeft=function(e){e!=l&&(l=e,i&&i("closedleft"))},o.getClosedLeft=function(){return l},o.setClosedRight=function(e){e!=u&&(u=e,i&&i("closedright"))},o.getClosedRight=function(){return u},o.setDrawLines=function(e){e!=v&&(v=e,n&&n("drawlines"))},o.getDrawLines=function(){return v},o.setLineColor=function(e){return"string"==typeof e&&(e=EJSS_TOOLS.DisplayColors.getArrayColor(e)),EJSS_TOOLS.compareArrays(e,g)||(g=e.slice(),n&&n("linecolor")),o},o.getLineColor=function(){return g},o.setLineWidth=function(e){e!=c&&(c=e,n&&n("linewidth"))},o.getLineWidth=function(){return c},o.setDrawFill=function(e){e!=y&&(y=e,n&&n("drawfill"))},o.getDrawFill=function(){return y},o.setFillColor=function(e){"string"==typeof e&&(e=EJSS_TOOLS.DisplayColors.getArrayColor(e)),EJSS_TOOLS.compareArrays(e,d)||(d=e.slice(),n&&n("fillcolor"))},o.getFillColor=function(){return d},o.setAmbientColor=function(e){"string"==typeof e&&(e=EJSS_TOOLS.DisplayColors.getArrayColor(e)),EJSS_TOOLS.compareArrays(e,S)||(S=e.slice(),n&&n("ambientcolor"))},o.getAmbientColor=function(){return S},o.setSpecularColor=function(e){"string"==typeof e&&(e=EJSS_TOOLS.DisplayColors.getArrayColor(e)),EJSS_TOOLS.compareArrays(e,f)||(f=e.slice(),n&&n("specularcolor"))},o.getSpecularColor=function(){return f},o.setAmbientReflection=function(e){E!=e&&(E=e,n&&n("ambientreflection"))},o.getAmbientReflection=function(){return E},o.setColorReflection=function(e){p!=e&&(p=e,n&&n("colorreflection"))},o.getColorReflection=function(){return p},o.setSpecularReflection=function(e){h!=e&&(h=e,n&&n("specularreflection"))},o.getSpecularReflection=function(){return h},o.setShininessVal=function(e){m!=e&&(m=e,n&&n("shininess"))},o.getShininessVal=function(){return m},o.setTransparency=function(e){e!=C&&(C=e,n&&n("transparency"))},o.getTransparency=function(){return C},o.setPaletteFloor=function(e){e&&!EJSS_TOOLS.compareArrays(e,t)&&(t=e.slice(),n&&n("palettefloor"))},o.getPaletteFloor=function(){return t},o.setPaletteCeil=function(e){e&&!EJSS_TOOLS.compareArrays(e,r)&&(r=e.slice(),n&&n("paletteceil"))},o.getPaletteCeil=function(){return r},o.setPaletteFloorColor=function(e){EJSS_TOOLS.compareArrays(e,A)||(A=e.slice(),n&&n("palettefloorcolor"))},o.getPaletteFloorColor=function(){return A},o.setPaletteCeilColor=function(e){EJSS_TOOLS.compareArrays(e,P)||(P=e.slice(),n&&n("paletteceilcolor"))},o.getPaletteCeilColor=function(){return P},o};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Transformation={registerProperties:function(e,t){e.setController(t),t.registerProperty("Parent",e.setParent,e.getParent),t.registerProperty("Axis",e.setAxis,e.getAxis),t.registerProperty("Angle",e.setAngle,e.getAngle),t.registerProperty("Origin",e.setOrigin,e.getOrigin)}},EJSS_DRAWING3D.rotationX=function(e){var t=EJSS_DRAWING3D.transformation();return t.setAxis([1,0,0]),t},EJSS_DRAWING3D.rotationY=function(e){var t=EJSS_DRAWING3D.transformation();return t.setAxis([0,1,0]),t},EJSS_DRAWING3D.rotationZ=function(e){var t=EJSS_DRAWING3D.transformation();return t.setAxis([0,0,1]),t},EJSS_DRAWING3D.transformation=function(e){var t={},r=null,n=[0,0,0,1,0,0,0],i={propertiesChanged:function(){},invokeAction:function(){}};return t.getArray=function(){return n},t.setChanged=function(e){e&&r.setProjChanged(!0)},t.setParent=function(e){r&&r.removeExtraTransformation(t),(r=e)&&r.addExtraTransformation(t)},t.getParent=function(){return r},t.setAngle=function(e){n[0]=e},t.getAngle=function(){return n[0]},t.setAxis=function(e){n[1]=e[0],n[2]=e[1],n[3]=e[2]},t.getAxis=function(){return n.slice(1,4)},t.setOrigin=function(e){n[4]=e[0],n[5]=e[1],n[6]=e[2]},t.getOrigin=function(){return n.slice(5)},t.getController=function(){return i},t.setController=function(e){i=e},t.registerProperties=function(e){EJSS_DRAWING3D.Transformation.registerProperties(t,e)},t};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.analyticCurve=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.analyticSurface=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.arrow=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.basic=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.box=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.cylinder=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.ellipsoid=function(e,t){};var hasFloat32Array="undefined"!=typeof Float32Array;Matrix.prototype={inverse:function(){return Matrix.inverse(this,new Matrix)},transpose:function(){return Matrix.transpose(this,new Matrix)},multiply:function(e){return Matrix.multiply(this,e,new Matrix)},transformPoint:function(e){var t=this.m;return new Vector(t[0]*e.x+t[1]*e.y+t[2]*e.z+t[3],t[4]*e.x+t[5]*e.y+t[6]*e.z+t[7],t[8]*e.x+t[9]*e.y+t[10]*e.z+t[11]).divide(t[12]*e.x+t[13]*e.y+t[14]*e.z+t[15])},transformVector:function(e){var t=this.m;return new Vector(t[0]*e.x+t[1]*e.y+t[2]*e.z,t[4]*e.x+t[5]*e.y+t[6]*e.z,t[8]*e.x+t[9]*e.y+t[10]*e.z)}},Matrix.inverse=function(e,t){t=t||new Matrix;var r=e.m,n=t.m;n[0]=r[5]*r[10]*r[15]-r[5]*r[14]*r[11]-r[6]*r[9]*r[15]+r[6]*r[13]*r[11]+r[7]*r[9]*r[14]-r[7]*r[13]*r[10],n[1]=-r[1]*r[10]*r[15]+r[1]*r[14]*r[11]+r[2]*r[9]*r[15]-r[2]*r[13]*r[11]-r[3]*r[9]*r[14]+r[3]*r[13]*r[10],n[2]=r[1]*r[6]*r[15]-r[1]*r[14]*r[7]-r[2]*r[5]*r[15]+r[2]*r[13]*r[7]+r[3]*r[5]*r[14]-r[3]*r[13]*r[6],n[3]=-r[1]*r[6]*r[11]+r[1]*r[10]*r[7]+r[2]*r[5]*r[11]-r[2]*r[9]*r[7]-r[3]*r[5]*r[10]+r[3]*r[9]*r[6],n[4]=-r[4]*r[10]*r[15]+r[4]*r[14]*r[11]+r[6]*r[8]*r[15]-r[6]*r[12]*r[11]-r[7]*r[8]*r[14]+r[7]*r[12]*r[10],n[5]=r[0]*r[10]*r[15]-r[0]*r[14]*r[11]-r[2]*r[8]*r[15]+r[2]*r[12]*r[11]+r[3]*r[8]*r[14]-r[3]*r[12]*r[10],n[6]=-r[0]*r[6]*r[15]+r[0]*r[14]*r[7]+r[2]*r[4]*r[15]-r[2]*r[12]*r[7]-r[3]*r[4]*r[14]+r[3]*r[12]*r[6],n[7]=r[0]*r[6]*r[11]-r[0]*r[10]*r[7]-r[2]*r[4]*r[11]+r[2]*r[8]*r[7]+r[3]*r[4]*r[10]-r[3]*r[8]*r[6],n[8]=r[4]*r[9]*r[15]-r[4]*r[13]*r[11]-r[5]*r[8]*r[15]+r[5]*r[12]*r[11]+r[7]*r[8]*r[13]-r[7]*r[12]*r[9],n[9]=-r[0]*r[9]*r[15]+r[0]*r[13]*r[11]+r[1]*r[8]*r[15]-r[1]*r[12]*r[11]-r[3]*r[8]*r[13]+r[3]*r[12]*r[9],n[10]=r[0]*r[5]*r[15]-r[0]*r[13]*r[7]-r[1]*r[4]*r[15]+r[1]*r[12]*r[7]+r[3]*r[4]*r[13]-r[3]*r[12]*r[5],n[11]=-r[0]*r[5]*r[11]+r[0]*r[9]*r[7]+r[1]*r[4]*r[11]-r[1]*r[8]*r[7]-r[3]*r[4]*r[9]+r[3]*r[8]*r[5],n[12]=-r[4]*r[9]*r[14]+r[4]*r[13]*r[10]+r[5]*r[8]*r[14]-r[5]*r[12]*r[10]-r[6]*r[8]*r[13]+r[6]*r[12]*r[9],n[13]=r[0]*r[9]*r[14]-r[0]*r[13]*r[10]-r[1]*r[8]*r[14]+r[1]*r[12]*r[10]+r[2]*r[8]*r[13]-r[2]*r[12]*r[9],n[14]=-r[0]*r[5]*r[14]+r[0]*r[13]*r[6]+r[1]*r[4]*r[14]-r[1]*r[12]*r[6]-r[2]*r[4]*r[13]+r[2]*r[12]*r[5],n[15]=r[0]*r[5]*r[10]-r[0]*r[9]*r[6]-r[1]*r[4]*r[10]+r[1]*r[8]*r[6]+r[2]*r[4]*r[9]-r[2]*r[8]*r[5];for(var i=r[0]*n[0]+r[1]*n[4]+r[2]*n[8]+r[3]*n[12],o=0;o<16;o++)n[o]/=i;return t},Matrix.transpose=function(e,t){t=t||new Matrix;var r=e.m,n=t.m;return n[0]=r[0],n[1]=r[4],n[2]=r[8],n[3]=r[12],n[4]=r[1],n[5]=r[5],n[6]=r[9],n[7]=r[13],n[8]=r[2],n[9]=r[6],n[10]=r[10],n[11]=r[14],n[12]=r[3],n[13]=r[7],n[14]=r[11],n[15]=r[15],t},Matrix.multiply=function(e,t,r){r=r||new Matrix;var n=e.m,i=t.m,o=r.m;return o[0]=n[0]*i[0]+n[1]*i[4]+n[2]*i[8]+n[3]*i[12],o[1]=n[0]*i[1]+n[1]*i[5]+n[2]*i[9]+n[3]*i[13],o[2]=n[0]*i[2]+n[1]*i[6]+n[2]*i[10]+n[3]*i[14],o[3]=n[0]*i[3]+n[1]*i[7]+n[2]*i[11]+n[3]*i[15],
o[4]=n[4]*i[0]+n[5]*i[4]+n[6]*i[8]+n[7]*i[12],o[5]=n[4]*i[1]+n[5]*i[5]+n[6]*i[9]+n[7]*i[13],o[6]=n[4]*i[2]+n[5]*i[6]+n[6]*i[10]+n[7]*i[14],o[7]=n[4]*i[3]+n[5]*i[7]+n[6]*i[11]+n[7]*i[15],o[8]=n[8]*i[0]+n[9]*i[4]+n[10]*i[8]+n[11]*i[12],o[9]=n[8]*i[1]+n[9]*i[5]+n[10]*i[9]+n[11]*i[13],o[10]=n[8]*i[2]+n[9]*i[6]+n[10]*i[10]+n[11]*i[14],o[11]=n[8]*i[3]+n[9]*i[7]+n[10]*i[11]+n[11]*i[15],o[12]=n[12]*i[0]+n[13]*i[4]+n[14]*i[8]+n[15]*i[12],o[13]=n[12]*i[1]+n[13]*i[5]+n[14]*i[9]+n[15]*i[13],o[14]=n[12]*i[2]+n[13]*i[6]+n[14]*i[10]+n[15]*i[14],o[15]=n[12]*i[3]+n[13]*i[7]+n[14]*i[11]+n[15]*i[15],r},Matrix.identity=function(e){e=e||new Matrix;var t=e.m;return t[0]=t[5]=t[10]=t[15]=1,t[1]=t[2]=t[3]=t[4]=t[6]=t[7]=t[8]=t[9]=t[11]=t[12]=t[13]=t[14]=0,e},Matrix.perspective=function(e,t,r,n,i){var o=Math.tan(e*Math.PI/360)*r,a=o*t;return Matrix.frustum(-a,a,-o,o,r,n,i)},Matrix.frustum=function(e,t,r,n,i,o,a){a=a||new Matrix;var s=a.m;return s[0]=2*i/(t-e),s[1]=0,s[2]=(t+e)/(t-e),s[3]=0,s[4]=0,s[5]=2*i/(n-r),s[6]=(n+r)/(n-r),s[7]=0,s[8]=0,s[9]=0,s[10]=-(o+i)/(o-i),s[11]=-2*o*i/(o-i),s[12]=0,s[13]=0,s[14]=-1,s[15]=0,a},Matrix.ortho=function(e,t,r,n,i,o,a){a=a||new Matrix;var s=a.m;return s[0]=2/(t-e),s[1]=0,s[2]=0,s[3]=-(t+e)/(t-e),s[4]=0,s[5]=2/(n-r),s[6]=0,s[7]=-(n+r)/(n-r),s[8]=0,s[9]=0,s[10]=-2/(o-i),s[11]=-(o+i)/(o-i),s[12]=0,s[13]=0,s[14]=0,s[15]=1,a},Matrix.scale=function(e,t,r,n){n=n||new Matrix;var i=n.m;return i[0]=e,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=t,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=r,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,n},Matrix.translate=function(e,t,r,n){n=n||new Matrix;var i=n.m;return i[0]=1,i[1]=0,i[2]=0,i[3]=e,i[4]=0,i[5]=1,i[6]=0,i[7]=t,i[8]=0,i[9]=0,i[10]=1,i[11]=r,i[12]=0,i[13]=0,i[14]=0,i[15]=1,n},Matrix.rotate=function(e,t,r,n,i,o,a,s){if(!e||!t&&!r&&!n)return Matrix.identity(s);s=s||new Matrix;var l=s.m,u=Math.sqrt(t*t+r*r+n*n);t/=u,r/=u,n/=u;var g=Math.cos(e),c=Math.sin(e),S=1-g;return l[0]=t*t*S+g,l[1]=t*r*S-n*c,l[2]=t*n*S+r*c,l[3]=i-l[0]*i-l[1]*o-l[2]*a,l[4]=r*t*S+n*c,l[5]=r*r*S+g,l[6]=r*n*S-t*c,l[7]=o-l[4]*i-l[5]*o-l[6]*a,l[8]=n*t*S-r*c,l[9]=n*r*S+t*c,l[10]=n*n*S+g,l[11]=a-l[8]*i-l[9]*o-l[10]*a,l[12]=0,l[13]=0,l[14]=0,l[15]=1,s},Matrix.lookAt=function(e,t,r,n,i,o,a,s,l,u){u=u||new Matrix;var g=u.m,c=new Vector(e,t,r),S=new Vector(n,i,o),d=new Vector(a,s,l),f=c.subtract(S).unit(),E=d.cross(f).unit(),p=f.cross(E).unit();return g[0]=E.x,g[1]=E.y,g[2]=E.z,g[3]=-E.dot(c),g[4]=p.x,g[5]=p.y,g[6]=p.z,g[7]=-p.dot(c),g[8]=f.x,g[9]=f.y,g[10]=f.z,g[11]=-f.dot(c),g[12]=0,g[13]=0,g[14]=0,g[15]=1,u};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.mesh=function(e,t,r){},EJSS_WEBGLGRAPHICS.indexer=function(){var e={},t=[],r={};return e.getUnique=function(){return t},e.add=function(e){var n=JSON.stringify(e);return n in r||(r[n]=t.length,t.push(e)),r[n]},e},EJSS_WEBGLGRAPHICS.buffer=function(e,t,r){var n={},i=null,t=t,r=r,o="",a=[];return n.setData=function(e){a=e},n._0=function(e){o=e},n.getBuffer=function(){return i},n.getName=function(){return o},n.compile=function(n){for(var o=[],s=0;s<a.length;s+=1e4)o=Array.prototype.concat.apply(o,a.slice(s,s+1e4));var l=a.length?o.length/a.length:0;if(l!=Math.round(l))throw"buffer elements not of consistent size, average size is "+l;i=i||e.createBuffer(),i.length=o.length,i.spacing=l,e.bindBuffer(t,i),e.bufferData(t,new r(o),n||e.STATIC_DRAW)},n};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.plane=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.segment=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.Shader={},EJSS_WEBGLGRAPHICS.shader=function(e,t,r,n){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.spring=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.surface=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.text=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.Texture={},EJSS_WEBGLGRAPHICS.texture=function(e,t,r,n){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.trail=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.Utils={},EJSS_WEBGLGRAPHICS.Utils.regexMap=function(e,t,r){for(;null!=(result=e.exec(t));)r(result)},EJSS_WEBGLGRAPHICS.Utils.isArray=function(e){var t=Object.prototype.toString.call(e);return"[object Array]"==t||"[object Float32Array]"==t},EJSS_WEBGLGRAPHICS.Utils.isNumber=function(e){var t=Object.prototype.toString.call(e);return"[object Number]"==t||"[object Boolean]"==t},Vector.prototype={setx:function(e){this.x=e},sety:function(e){this.y=e},setz:function(e){this.z=e},getx:function(){return this.x},gety:function(){return this.y},getz:function(){return this.z},negative:function(){return new Vector(-this.x,-this.y,-this.z)},add:function(e){return e instanceof Vector?new Vector(this.x+e.x,this.y+e.y,this.z+e.z):new Vector(this.x+e,this.y+e,this.z+e)},subtract:function(e){return e instanceof Vector?new Vector(this.x-e.x,this.y-e.y,this.z-e.z):new Vector(this.x-e,this.y-e,this.z-e)},multiply:function(e){return e instanceof Vector?new Vector(this.x*e.x,this.y*e.y,this.z*e.z):new Vector(this.x*e,this.y*e,this.z*e)},divide:function(e){return e instanceof Vector?new Vector(this.x/e.x,this.y/e.y,this.z/e.z):new Vector(this.x/e,this.y/e,this.z/e)},equals:function(e){return this.x==e.x&&this.y==e.y&&this.z==e.z},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},cross:function(e){return new Vector(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},length:function(){return Math.sqrt(this.dot(this))},unit:function(){return this.divide(this.length())},min:function(){return Math.min(Math.min(this.x,this.y),this.z)},max:function(){return Math.max(Math.max(this.x,this.y),this.z)},angle:function(e){return Math.acos(this.dot(e)/(this.length()*e.length()))},toAngles:function(){return{theta:Math.atan2(this.z,this.x),phi:Math.asin(this.y/this.length())}},toArray:function(e){return[this.x,this.y,this.z].slice(0,e||3)},clone:function(){return new Vector(this.x,this.y,this.z)},init:function(e,t,r){return this.x=e,this.y=t,this.z=r,this}},Vector.negative=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t},Vector.add=function(e,t,r){return t instanceof Vector?(r.x=e.x+t.x,r.y=e.y+t.y,r.z=e.z+t.z):(r.x=e.x+t,r.y=e.y+t,r.z=e.z+t),r},Vector.subtract=function(e,t,r){return t instanceof Vector?(r.x=e.x-t.x,r.y=e.y-t.y,r.z=e.z-t.z):(r.x=e.x-t,r.y=e.y-t,r.z=e.z-t),r},Vector.multiply=function(e,t,r){return t instanceof Vector?(r.x=e.x*t.x,r.y=e.y*t.y,r.z=e.z*t.z):(r.x=e.x*t,r.y=e.y*t,r.z=e.z*t),r},Vector.divide=function(e,t,r){return t instanceof Vector?(r.x=e.x/t.x,r.y=e.y/t.y,r.z=e.z/t.z):(r.x=e.x/t,r.y=e.y/t,r.z=e.z/t),r},Vector.cross=function(e,t,r){return r.x=e.y*t.z-e.z*t.y,r.y=e.z*t.x-e.x*t.z,r.z=e.x*t.y-e.y*t.x,r},Vector.unit=function(e,t){var r=e.length();return t.x=e.x/r,t.y=e.y/r,t.z=e.z/r,t},Vector.fromAngles=function(e,t){return new Vector(Math.cos(e)*Math.cos(t),Math.sin(t),Math.sin(e)*Math.cos(t))},Vector.randomDirection=function(){return Vector.fromAngles(Math.random()*Math.PI*2,Math.asin(2*Math.random()-1))},Vector.min=function(e,t){return new Vector(Math.min(e.x,t.x),Math.min(e.y,t.y),Math.min(e.z,t.z))},Vector.max=function(e,t){return new Vector(Math.max(e.x,t.x),Math.max(e.y,t.y),Math.max(e.z,t.z))},Vector.lerp=function(e,t,r){return t.subtract(e).multiply(r).add(e)},Vector.fromArray=function(e){return new Vector(e[0],e[1],e[2])};var EJSS_GRAPHICS=EJSS_GRAPHICS||{};EJSS_GRAPHICS.WebGLGraphics={},EJSS_GRAPHICS.webGLGraphics=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Plane={},EJSS_DRAWING3D.plane=function(e){},EJSS_DRAWING3D.PlaneSet={},EJSS_DRAWING3D.planeSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Segment={},EJSS_DRAWING3D.segment=function(e){},EJSS_DRAWING3D.SegmentSet={},EJSS_DRAWING3D.segmentSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Sphere={},EJSS_DRAWING3D.sphere=function(e){},EJSS_DRAWING3D.SphereSet={},EJSS_DRAWING3D.sphereSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Spring={},EJSS_DRAWING3D.spring=function(e){},EJSS_DRAWING3D.SpringSet={},EJSS_DRAWING3D.springSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Surface={},EJSS_DRAWING3D.surface=function(e){},EJSS_DRAWING3D.SurfaceSet={},EJSS_DRAWING3D.surfaceSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Tetrahedron={},EJSS_DRAWING3D.tetrahedron=function(e){},EJSS_DRAWING3D.TetrahedronSet={},EJSS_DRAWING3D.tetrahedronSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Text={},EJSS_DRAWING3D.text=function(e){},EJSS_DRAWING3D.TextSet={},EJSS_DRAWING3D.textSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Trail={},EJSS_DRAWING3D.trail=function(e){},EJSS_DRAWING3D.TrailSet={},EJSS_DRAWING3D.trailSet=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.ArrayPanel={},EJSS_INTERFACE.arrayPanel=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Audio={},EJSS_INTERFACE.audio=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.BoxPanel={registerProperties:function(e,t){EJSS_INTERFACE.Panel.registerProperties(e,t)},showOkDialog:function(e,t,r){var n=document.getElementById(".myBoxPanelOk")||EJSS_INTERFACE.boxPanel(".myBoxPanelOk").getDOMElement(),i=document.getElementById(".myBoxPanelOk.back"),o=document.getElementById(".myBoxPanelOk.msg");o.style.visibility="visible",o.innerHTML=e+"<br/>";var a=document.getElementById(".myBoxPanelOk.okbt");a.onclick=t,a.style.display="inline",n.style.width=r||"200px",n.style.marginLeft=parseFloat(n.style.width)/-2+"px",n.style.visibility="visible",i.style.visibility="visible"},showOkCancelDialog:function(e,t,r,n){var i=document.getElementById(".myBoxPanelCancelOk")||EJSS_INTERFACE.boxPanel(".myBoxPanelCancelOk").getDOMElement(),o=document.getElementById(".myBoxPanelCancelOk.back"),a=document.getElementById(".myBoxPanelCancelOk.msg");a.style.visibility="visible",a.innerHTML=e+"<br/>";var s=document.getElementById(".myBoxPanelCancelOk.okbt");s.onclick=t,s.style.display="inline";var l=document.getElementById(".myBoxPanelCancelOk.cancelbt");l.onclick=r,l.style.display="inline",i.style.width=n||"200px",i.style.marginLeft=parseFloat(i.style.width)/-2+"px",i.style.visibility="visible",o.style.visibility="visible"},showInputDialog:function(e,t,r,n){var i=document.getElementById(".BoxPanelInput")||EJSS_INTERFACE.boxPanel(".BoxPanelInput").getDOMElement(),o=document.getElementById(".BoxPanelInput.back"),a=document.getElementById(".BoxPanelInput.msg");a.style.visibility="visible",a.innerHTML=e;var s=document.getElementById(".BoxPanelInput.input");s.style.display="inline";var l=document.getElementById(".BoxPanelInput.okbt");l.onclick=function(){t(s.value)},l.style.display="inline";var u=document.getElementById(".BoxPanelInput.cancelbt");u.onclick=r,u.style.display="inline",i.style.width=n||"200px",i.style.marginLeft=parseFloat(i.style.width)/-2+"px",i.style.visibility="visible",o.style.visibility="visible"},showSelectDialog:function(e,t,r,n,i,o){var a=document.getElementById(".BoxPanelSelect")||EJSS_INTERFACE.boxPanel(".BoxPanelSelect").getDOMElement(),s=document.getElementById(".BoxPanelSelect.back"),l=document.getElementById(".BoxPanelSelect.msg");l.style.visibility="visible",l.innerHTML=e;var u=document.getElementById(".BoxPanelSelect.select");u.innerHTML="";for(var g=0;g<t.text.length;g++){var c=document.createElement("option");c.value&&c.value[g]&&c.setAttribute("value",t.value[g]),c.innerHTML=t.text[g],u.appendChild(c)}i&&(u.size=i),u.style.display="block",u.style.margin="0 auto";var S=document.getElementById(".BoxPanelSelect.okbt");S.onclick=function(){r(t.value[u.selectedIndex])},S.style.display="inline";var d=document.getElementById(".BoxPanelSelect.cancelbt");d.onclick=n,d.style.display="inline",a.style.width=o||"200px",a.style.marginLeft=parseFloat(a.style.width)/-2+"px",a.style.visibility="visible",s.style.visibility="visible"}},EJSS_INTERFACE.boxPanel=function(e){var t=EJSS_INTERFACE.panel(e);t.setVisibility=function(e){mElement.style.visibility=e,t.getStyle().setVisibility(e)},t.registerProperties=function(e){EJSS_INTERFACE.BoxPanel.registerProperties(t,e)};var r=document.createElement("div");document.body.appendChild(r),r.className="myBoxPanelBackground",r.id=e+".back",r.style.backgroundColor="rgba(255, 255, 255, 0.3)",r.style.position="fixed",r.style.top="1%",r.style.left="1%",r.style.width="98%",r.style.height="98%",r.style.zIndex="99998",r.style.visibility="hidden";var n=document.createElement("span");n.id=e+".msg",n.style.visibility="hidden",t.getDOMElement().appendChild(n);var i=document.createElement("input");i.id=e+".input",i.type="text",i.style.display="none",i.size="20",t.getDOMElement().appendChild(i);var o=document.createElement("select");o.id=e+".select",o.style.display="none",o.size="4",t.getDOMElement().appendChild(o);var a=document.createElement("button");a.id=e+".okbt",a.innerHTML="Ok",a.style.verticalAlign="middle",a.style.display="none",a.addEventListener("click",function(){document.getElementById(e).style.visibility="hidden",document.getElementById(e+".back").style.visibility="hidden",document.getElementById(e+".msg").style.visibility="hidden",document.getElementById(e+".input").style.display="none",document.getElementById(e+".okbt").style.display="none",document.getElementById(e+".cancelbt").style.display="none"}),t.getDOMElement().appendChild(a);var s=document.createElement("button");return s.id=e+".cancelbt",s.innerHTML="Cancel",s.style.verticalAlign="middle",s.style.display="none",s.addEventListener("click",function(){document.getElementById(e).style.visibility="hidden",document.getElementById(e+".back").style.visibility="hidden",document.getElementById(e+".msg").style.visibility="hidden",document.getElementById(e+".input").style.display="none",document.getElementById(e+".okbt").style.display="none",document.getElementById(e+".cancelbt").style.display="none"}),t.getDOMElement().appendChild(s),t.getDOMElement().className="BoxPanel",t.getStyle().setCSS({position:"fixed",top:"25%",left:"50%"}),t.getStyle().setCSS({zIndex:"99999",visibility:"hidden"}),t.getStyle().setCSS({marginLeft:"-250px",width:"500px"}),t.getStyle().setCSS({background:"lightgray"}),t.getStyle().setCSS({borderWidth:"1px"}),t.getStyle().setCSS({borderStyle:"solid"}),t.getStyle().setCSS({borderColor:"red"}),t.getStyle().setCSS({overflow:"hidden",wordWrap:"break-word"}),t};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Button={registerProperties:function(e,t){EJSS_INTERFACE.Element.registerProperties(e,t),t.registerProperty("Text",e.setText),t.registerProperty("Disabled",e.setDisabled),t.registerProperty("ImageUrl",e.setImageUrl),t.registerAction("OnClick"),t.registerAction("OnPress"),t.registerAction("OnRelease")}},EJSS_INTERFACE.button=function(e){function t(){r.getDOMElement().innerHTML="",n.length>0&&(r.getDOMElement().innerHTML='<img style="vertical-align:inherit;-webkit-touch-callout:none;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;" src="'+n+'"/>'),i.length>0&&(r.getDOMElement().innerHTML+='<span style="white-space:pre;-webkit-touch-callout:none;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;vertical-align:inherit;">'+i.toString()+"</span>")}var r=EJSS_INTERFACE.element(e),n="",i="";r.setDisabled=function(e){r.getDOMElement().disabled=e},r.getDisabled=function(){return r.getDOMElement().disabled},r.setText=function(e){i!=e&&(i=e,t())},r.getText=function(){return i},r.setImageUrl=function(e){var i=r.getResourcePath(e);i!=n&&(n=i,t())},r.getImageUrl=function(){return n},r.registerProperties=function(e){EJSS_INTERFACE.Button.registerProperties(r,e)};var o=document.createElement("button");return o.id=e,
o.style.verticalAlign="middle",o.style.webkitTouchCallout="none",document.body.appendChild(o),r.setDOMElement(o),r.getDOMElement().oncontextmenu=function(e){return!1},r.getDOMElement().onmousedown=function(e){var t=r.getController();return t&&t.invokeAction("OnPress").reportInteractions(),!1},r.getDOMElement().addEventListener("touchstart",function(e){var t=r.getController();return t&&t.invokeAction("OnPress").reportInteractions(),!1}),r.getDOMElement().onmouseup=function(e){var t=r.getController();return t&&(t.invokeAction("OnRelease"),t.invokeAction("OnClick").reportInteractions()),!1},r.getDOMElement().addEventListener("touchend",function(e){var t=r.getController();return t&&(t.invokeAction("OnRelease"),t.invokeAction("OnClick").reportInteractions()),!1}),r};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Canvas={registerProperties:function(e,t){EJSS_INTERFACE.Element.registerProperties(e,t),t.registerProperty("Height",e.setHeight),t.registerProperty("Width",e.setWidth),t.registerProperty("ImageData",e.setImageData),t.registerProperty("Enabled",e.setEnabled,e.isEnabled),t.registerAction("OnPress",e.getInteractionPoint),t.registerAction("OnDrag",e.getInteractionPoint),t.registerAction("OnRelease",e.getInteractionPoint),t.registerAction("OnEnter",e.getInteractionPoint),t.registerAction("OnExit",e.getInteractionPoint),t.registerAction("OnMove",e.getInteractionPoint)}},EJSS_INTERFACE.canvas=function(e){function t(e){var t=EJSS_GRAPHICS.CanvasGraphics.getOffsetRect(u),r=[];if(void 0!==e.changedTouches)for(var n=0;n<e.changedTouches.length;n++)r[n]=[],r[n][0]=e.changedTouches[n].pageX-window.pageXOffset-t.left,r[n][1]=e.changedTouches[n].pageY-window.pageYOffset-t.top;else r[0]=[],r[0][0]=(e.clientX||e.x)-t.left,r[0][1]=(e.clientY||e.y)-t.top;return r[0]}function r(e){e.preventDefault();var r=u.getController();return r&&(S=t(e),r.invokeAction("OnPress").reportInteractions()),d=!0,!1}function n(e){e.preventDefault();var r=u.getController();return d&&r&&(S=t(e),r.invokeAction("OnRelease").reportInteractions()),d=!1,!1}function i(e){e.preventDefault();var r=u.getController();return d=!1,r&&(S=t(e),r.invokeAction("OnEnter").reportInteractions()),!1}function o(e){e.preventDefault();var r=u.getController();return d=!1,r&&(S=t(e),r.invokeAction("OnExit").reportInteractions()),!1}function a(e){e.preventDefault();var r=u.getController();return r&&(S=t(e),d?r.invokeAction("OnDrag").reportInteractions():r.invokeAction("OnMove").reportInteractions()),!1}var s,l,u=EJSS_INTERFACE.element(e),g=0,c=0,S=[0,0],d=!1;u.render=function(){s&&E.putImageData(s,0,0)},u.setImageData=function(e){s||(s=E.createImageData(c,g)),e.data&&(e=e.data);for(var t=0;t<e.length;t++)s.data[t]=e[t]},u.clear=function(){E.clearRect(0,0,c,g)},u.setWidth=function(e){var t=u.getDOMElement();return c!=e&&(c=e,"string"==typeof e&&-1!=e.indexOf("%")&&t.parentNode&&t.parentNode.offsetWidth?e=t.parentNode.offsetWidth*parseFloat(e)/100:"string"==typeof e&&(e=parseFloat(e)),"number"==typeof e&&t.setAttribute("width",e),!0)},u.getWidth=function(){var e=u.getDOMElement();if("string"==typeof c&&-1!=c.indexOf("%")&&e.parentNode&&e.parentNode.offsetWidth){var t=e.parentNode.offsetWidth*parseFloat(c)/100;if("number"==typeof t){t!=e.getAttribute("width")&&e.setAttribute("width",t)}}return c},u.setHeight=function(e){var t=u.getDOMElement();return g!=e&&(g=e,"string"==typeof e&&-1!=e.indexOf("%")&&t.parentNode&&t.parentNode.offsetHeight?e=t.parentNode.offsetHeight*parseFloat(e)/100:"string"==typeof e&&(e=parseFloat(e)),"number"==typeof e&&t.setAttribute("height",e),!0)},u.getHeight=function(){var e=u.getDOMElement();if("string"==typeof g&&-1!=g.indexOf("%")&&e.parentNode&&e.parentNode.offsetHeight&&(value=e.parentNode.offsetHeight*parseFloat(g)/100,"number"==typeof value)){var t=e.getAttribute("height");value!=t&&e.setAttribute("height",value)}return g},u.getContext=function(){return E},u.registerProperties=function(e){EJSS_INTERFACE.Canvas.registerProperties(u,e)},u.setEnabled=function(e){l=e;var t=u.getDOMElement();l?(t.onmousedown=r,t.onmouseup=n,t.onmouseover=i,t.onmouseout=o,t.onmousemove=a,t.addEventListener("touchstart",r,!1),t.addEventListener("touchend",n,!1),t.addEventListener("touchmove",a,!1)):(t.onmousedown=void 0,t.onmouseup=void 0,t.onmouseover=void 0,t.onmouseout=void 0,t.onmousemove=void 0,t.removeEventListener("touchstart",r),t.removeEventListener("touchend",n),t.removeEventListener("touchmove",a))},u.isEnabled=function(){return l},u.getInteractionPoint=u.getMousePosition=function(){return S};var f=document.createElement("canvas");f.setAttribute("id",e),f.style.overflow="hidden";var E=f.getContext("2d");return document.body.appendChild(f),u.setDOMElement(f),u.setEnabled(!0),u.setWidth(500),u.setHeight(500),u};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.CheckBox={OFF:!1,ON:!0,registerProperties:function(e,t){EJSS_INTERFACE.Element.registerProperties(e,t),t.registerProperty("Text",e.setText),t.registerProperty("ImageUrl",e.setImageUrl),t.registerProperty("TextOn",e.setTextOn),t.registerProperty("ImageOnUrl",e.setImageOnUrl),t.registerProperty("TextOff",e.setTextOff),t.registerProperty("ImageOffUrl",e.setImageOffUrl),t.registerProperty("Checked",e.setChecked,e.getChecked),t.registerProperty("Value",e.setValue,e.getValue),t.registerAction("OnChange",e.getChecked),t.registerAction("OnCheckOn"),t.registerAction("OnCheckOff")}},EJSS_INTERFACE.checkBox=function(e){function t(){c.innerHTML="",g.checked?i.src.length>0?c.appendChild(i):s.length>0?c.innerHTML=s.toString():n.src.length>0?c.appendChild(n):a.length>0&&(c.innerHTML=a.toString()):o.src.length>0?c.appendChild(o):l.length>0?c.innerHTML=l.toString():n.src.length>0?c.appendChild(n):a.length>0&&(c.innerHTML=a.toString())}var r=EJSS_INTERFACE.element(e),n=new Image,i=new Image,o=new Image,a="",s="",l="";r.setText=function(e){a=e,t()},r.setImageUrl=function(e){n.src=r.getResourcePath(e),t()},r.setTextOff=function(e){l=e,t()},r.getTextOff=function(){return l},r.setImageOffUrl=function(e){o.src=r.getResourcePath(e),t()},r.getImageUrlOff=function(){return o.src},r.setTextOn=function(e){s=e,t()},r.getTextOn=function(){return s},r.setImageOnUrl=function(e){i.src=r.getResourcePath(e),t()},r.getImageUrlOn=function(){return i.src},r.setChecked=function(e){g.checked!=e&&(g.checked=e,t())},r.getChecked=function(){return g.checked},r.setValue=function(e){g.value=e},r.getValue=function(){return g.value},r.registerProperties=function(e){EJSS_INTERFACE.CheckBox.registerProperties(r,e)};var u=document.createElement("fieldset");u.id=e,u.style.border=0,u.style.display="inline-block",document.body.appendChild(u),r.setDOMElement(u);var g=document.createElement("input");g.id=e+".checkbox",g.type="checkbox",u.appendChild(g),g.onchange=function(){t();var e=r.getController();e&&(e.propertiesChanged("Checked"),e.invokeAction("OnChange"),g.checked?e.invokeAction("OnCheckOn"):e.invokeAction("OnCheckOff"),e.reportInteractions())};var c=document.createElement("label");return c.id=e+".label",c.style.display="inline-block",u.appendChild(c),r};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.ComboBox={registerProperties:function(e,t){EJSS_INTERFACE.Element.registerProperties(e,t),t.registerProperty("Options",e.setOptions,e.getOptions),t.registerProperty("SelectedOptions",e.setSelectedOptions,e.getSelectedOptions),t.registerProperty("Multiple",e.setMultiple),t.registerProperty("Size",e.setSize),t.registerAction("OnChange"),t.registerAction("OnFocus")}},EJSS_INTERFACE.comboBox=function(e){var t=EJSS_INTERFACE.element(e),r=[];t.registerProperties=function(e){EJSS_INTERFACE.ComboBox.registerProperties(t,e)},t.setSize=function(e){t.getDOMElement().size=e},t.getSize=function(){return t.getDOMElement().size},t.setMultiple=function(e){t.getDOMElement().multiple=e},t.getMultiple=function(){return t.getDOMElement().multiple},t.setSelectedOptions=function(e){for(var r=t.getDOMElement(),n=0;n<r.options.length;n++){r.options[n].selected=!1;for(var i=0;i<e.length;i++)if(r.options[n].value==e[i]){r.options[n].selected=!0;break}}},t.getSelectedOptions=function(){for(var e=[],r=t.getDOMElement(),n=0,i=0;i<r.options.length;i++)r.options[i].selected&&(e[n++]=r.options[i].value);return e},t.getSelectedOptionsIndexes=function(){for(var e=[],r=t.getDOMElement(),n=0,i=0;i<r.options.length;i++)r.options[i].selected&&(e[n++]=i);return e},t.setOptions=function(e){if(!EJSS_TOOLS.compareArrays(r,e)){r=[];var n=t.getSelectedOptions(),i=t.getDOMElement();i.innerHTML="";for(var o=0;o<e.length;o++){var a=document.createElement("option");a.setAttribute("value",e[o]),a.innerHTML=e[o],i.appendChild(a),r[o]=e[o]}t.setSelectedOptions(n)}},t.getOptions=function(){for(var e=[],r=t.getDOMElement(),n=0;n<r.options.length;n++)e[n]=r.options[n].value;return e},t.setEditable=function(e){t.getDOMElement().readOnly=!e},t.getEditable=function(){return!t.getDOMElement().readOnly};var n=document.createElement("select");return n.id=e,document.body.appendChild(n),t.setDOMElement(n),t.getDOMElement().onfocus=function(){var e=t.getController();t.getStyle().setBackgroundColor("white"),e&&(e.propertiesChanged("Options"),e.invokeAction("OnFocus"),e.reportInteractions())},t.getDOMElement().onchange=function(){var e=t.getController();t.getStyle().setBackgroundColor("white"),e&&(e.propertiesChanged("SelectedOptions"),e.invokeAction("OnChange"),e.reportInteractions())},t.getDOMElement().onkeydown=function(){t.getStyle().setBackgroundColor("yellow")},t};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.DataTable={},EJSS_INTERFACE.dataTable=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Element={registerProperties:function(e,t){e.setController(t),t.registerProperty("Tooltip",e.setTitle),t.registerProperty("Foreground",e.getStyle().setColor),t.registerProperty("Background",e.getStyle().setBackgroundColor),t.registerProperty("BackgroundImage",e.getStyle().setBackgroundImage),t.registerProperty("BorderWidth",e.getStyle().setBorderWidth),t.registerProperty("BorderColor",e.getStyle().setBorderColor),t.registerProperty("BorderStyle",e.getStyle().setBorderStyle),t.registerProperty("Padding",e.getStyle().setPadding),t.registerProperty("Width",e.getStyle().setWidth,e.getStyle().getWidth),t.registerProperty("Height",e.getStyle().setHeight,e.getStyle().getHeight),t.registerProperty("LineHeight",e.getStyle().setLineHeight,e.getStyle().getLineHeight),t.registerProperty("TextAlign",e.getStyle().setTextAlign),t.registerProperty("VerticalAlign",e.getStyle().setVerticalAlign),t.registerProperty("Visibility",e.getStyle().setVisibility),t.registerProperty("Display",e.getStyle().setDisplay),t.registerProperty("Disabled",e.setDisabled),t.registerProperty("Float",e.getStyle().setFloat),t.registerProperty("Position",e.getStyle().setPosition),t.registerProperty("Left",e.getStyle().setLeft),t.registerProperty("Top",e.getStyle().setTop),t.registerProperty("Bottom",e.getStyle().setBottom),t.registerProperty("Overflow",e.getStyle().setOverflow),t.registerProperty("BoxShadow",e.getStyle().setShadow),t.registerProperty("Margin",e.getStyle().setMargin),t.registerProperty("Parent",e.setParent),t.registerProperty("ClassName",e.setClassName),t.registerProperty("CSS",e.getStyle().setCSS),t.registerProperty("Font",e.getStyle().setFont),t.registerProperty("FontFamily",e.getStyle().setFontFamily),t.registerProperty("FontSize",e.getStyle().setFontSize),t.registerProperty("LetterSpacing",e.getStyle().setLetterSpacing),t.registerProperty("OutlineColor",e.getStyle().setOutlineColor),t.registerProperty("FontWeight",e.getStyle().setFontWeight),t.registerProperty("FillColor",e.getStyle().setFillColor),t.registerProperty("FontStyle",e.getStyle().setFontStyle),t.registerProperty("Transform",e.getStyle().setTransform),t.registerProperty("WhiteSpace",e.getStyle().setWhiteSpace)}},EJSS_INTERFACE.element=function(e){var t,r,n={},i=EJSS_INTERFACE.style(e),o=null;return n.getDOMElement=function(){return t},n.setDOMElement=function(e){t=e},n.setParent=function(e){if(r=e,"string"==typeof e){document.getElementById(e).appendChild(n.getDOMElement())}else e.getDOMElement?e.appendChild(n):e.appendChild(n.getDOMElement())},n.getParent=function(){return r},n.getName=function(){return e},n.getResourcePath=function(e){return e},n.setClassName=function(e){n.getDOMElement().className=e},n._23Name=function(){return n.getDOMElement().className},n.setDisabled=function(e){n.getDOMElement().disabled=e},n.getDisabled=function(){return n.getDOMElement().disabled},n.setTitle=function(e){n.getDOMElement().title=e},n.getTitle=function(){return n.getDOMElement().title},n.getStyle=function(){return i},n.getController=function(){return o},n.setController=function(e){o=e},n.registerProperties=function(e){EJSS_INTERFACE.Element.registerProperties(n,e)},n};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.FunctionField={registerProperties:function(e,t){EJSS_INTERFACE.TextField.registerProperties(e,t),t.registerAction("OnError")}},EJSS_INTERFACE.functionField=function(e){var t,r=EJSS_INTERFACE.textField(e),n=EJSS_DRAWING2D.functionsParser(),i=n.parse("0"),o=r.setValue,a={},s=r.getStyle().getBackgroundColor();return r.registerProperties=function(e){EJSS_INTERFACE.FunctionField.registerProperties(r,e)},r.setParameters=function(e){for(var t in e)a[t]=e[t]},r.parseValue=function(e){if(e){if(e!=t){try{i=n.parse(e),r.getStyle().setBackgroundColor(s)}catch(t){r.getController().invokeAction("OnError"),console.log('FunctionField: Error parsing function "'+e+'" : '+t.message+"\n"),r.getStyle().setBackgroundColor("red")}t=e}}else t="0",i=n.parse("0"),r.getStyle().setBackgroundColor(s)},r.setValue=function(e){o(e),r.parseValue(e)},r.evaluate=function(e){var t={};for(var n in a)t[n]=a[n];for(var o in e)t[o]=e[o];try{return i.evaluate(t)}catch(e){return r.getController().invokeAction("OnError"),NaN}},r};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Html={},EJSS_INTERFACE.html=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Image={},EJSS_INTERFACE.image=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.ImageAndTextButton={registerProperties:function(e,t){EJSS_INTERFACE.Element.registerProperties(e,t),t.registerProperty("Text",e.setText),t.registerProperty("ImageUrl",e.setImageUrl),t.registerAction("OnClick")}},EJSS_INTERFACE.imageAndTextButton=function(e){var t=EJSS_INTERFACE.element(e),r="",n="";t.setText=function(e){r=e.toString(),t.getDOMElement().innerHTML=n+r},t.getText=function(){return r},t.setImageUrl=function(e){n='<img src="'+t.getResourcePath(e)+'"/>',t.getDOMElement().innerHTML=n+r},t.getImageUrl=function(){return n},t.registerProperties=function(e){EJSS_INTERFACE.ImageAndTextButton.registerProperties(t,e)};var i=document.createElement("button");return i.id=e,i.style.borderStyle="none",i.style.background="inherit",i.style.cursor="inherit",i.style.webkitBoxShadow="inset 0 0px 0 rgba(255,255,255,0),0 0px 0px rgba(0,0,0,0)",document.body.appendChild(i),t.setDOMElement(i),t.getDOMElement().onclick=function(){var e=t.getController();e&&e.invokeAction("OnClick").reportInteractions()},t};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Label={},EJSS_INTERFACE.label=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.MathML={},EJSS_INTERFACE.mathML=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Media={},EJSS_INTERFACE.media=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.MotionJPEG={},EJSS_INTERFACE.motionJPEG=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.NumberField={},EJSS_INTERFACE.numberField=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Panel={registerProperties:function(e,t){EJSS_INTERFACE.Element.registerProperties(e,t),t.registerProperty("Html",e.setHtml,e.getHtml)}},EJSS_INTERFACE.panel=function(e){var t=EJSS_INTERFACE.element(e);t.appendChild=function(e){var r=e.getDOMElement();t.getDOMElement().appendChild(r)},t.removeChild=function(e){var r=e.getDOMElement();t.getDOMElement().removeChild(r)},t.insertBefore=function(e,r){var n=e.getDOMElement(),i=r.getDOMElement();t.getDOMElement().insertBefore(n,i)},t.setHtml=function(e){t.getDOMElement().innerHTML=e},t.getHtml=function(){return t.getDOMElement().innerHTML},t.registerProperties=function(e){EJSS_INTERFACE.Panel.registerProperties(t,e)};var r=document.createElement("div");return r.id=e,r.contenteditable=!0,document.body.appendChild(r),t.setDOMElement(r),t.getStyle().setPadding("0px"),t.getStyle().setMargin("0px"),t.getStyle().setTextAlign("TEXTA_CENTER"),t.getStyle().setCSS({display:"block","margin-left":"auto","margin-right":"auto"}),t.getDOMElement().ontouchstart=function(e){for(var t=document.getElementsByTagName("input"),r=0;t.length>r;r++)t[r].disabled=!1},t};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.PasswordField={},EJSS_INTERFACE.passwordField=function(e){}
;var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.RadioButton={},EJSS_INTERFACE.radioButton=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Separator={},EJSS_INTERFACE.separator=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Slider={},EJSS_INTERFACE.slider=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Style={BORDER_SOLID:"solid",BORDER_DOTTED:"dotted",BORDER_DASHED:"dashed",TEXTA_LEFT:"left",TEXTA_RIGHT:"right",TEXTA_CENTER:"center",TEXTA_JUSTIFY:"justify",VISIB_VISIBLE:"visible",VISIB_HIDDEN:"hidden",FLOAT_LEFT:"left",FLOAT_RIGHT:"right",FLOAT_NONE:"none",FLOAT_CENTER:"none",POSITION_STATIC:"static",POSITION_ABSOLUTE:"absolute",POSITION_FIXED:"fixed",POSITION_RELATIVE:"relative",POSITION_INHERIT:"inherit",OVERFLOW_VISIBLE:"visible",OVERFLOW_HIDDEN:"hidden",OVERFLOW_SCROLL:"scroll",OVERFLOW_AUTO:"auto",setCSS:function(e,t){var r=function(e,t){return(t+"").toUpperCase()},n=e.style;if("object"!=typeof t){var i=t.trim().split("{");if(i[0]&&i[0].length>0){var o,a=i[0].trim(),s=document.styleSheets[0].rules||document.styleSheets[0].cssRules;for(o=0;o<s.length&&s[o].selectorText!=a;o++);var l=s[o].cssText?s[o].cssText:s[o].style.cssText;l=l.match(/{.*}/g)[0];var u=l.slice(1,l.length-2).split(";");for(elem in u){var g=u[elem].split(":");if(2==g.length){var c=g[0].trim(),S=g[1].trim(),d=c.replace(/-([\da-z])/gi,r);n[d]=S}}}if(i[1]){var f=i[1].trim(),u=f.slice(0,f.length-2).split(";");for(elem in u){var g=u[elem].split(":");if(2==g.length){var c=g[0].trim(),S=g[1].trim(),d=c.replace(/-([\da-z])/gi,r);n[d]=S}}}}else for(var E in t){var d=E.replace(/-([\da-z])/gi,r);n[d]=t[E]}}},EJSS_INTERFACE.style=function(e){var t=EJSS_INTERFACE.Style,r={},n="white",i=0,o=t.BORDER_SOLID;return r.setCSS=function(r){t.setCSS(document.getElementById(e),r)},r.setVisibility=function(t){document.getElementById(e).style.visibility=t?"visible":"hidden"},r.getVisibility=function(){return"visible"==document.getElementById(e).style.visibility},r.setVerticalAlign=function(t){document.getElementById(e).style.verticalAlign=t},r.getVerticalAlign=function(){return document.getElementById(e).style.verticalAlign},r.setTextAlign=function(r){"TEXTA_"==r.substring(0,6)&&(r=t[r.toUpperCase()]),document.getElementById(e).style.textAlign=r},r.getTextAlign=function(){return document.getElementById(e).style.textAlign},r.setLineHeight=function(t){"string"!=typeof t&&(t+="px"),document.getElementById(e).style.lineHeight=t},r.getLineHeight=function(){return document.getElementById(e).style.lineHeight},r.setHeight=function(t){"string"!=typeof t&&(t+="px"),document.getElementById(e).style.height=t},r.getHeight=function(){return document.getElementById(e).style.height},r.setWidth=function(t){"string"!=typeof t&&(t+="px"),document.getElementById(e).style.width=t},r.getWidth=function(){return document.getElementById(e).style.width},r.setOverflow=function(r){"OVERFL"==r.substring(0,6)&&(r=t[r.toUpperCase()]),document.getElementById(e).style.overflow=r},r.getOverflow=function(){return document.getElementById(e).style.overflow},r.setPosition=function(r){"POSITI"==r.substring(0,6)&&(r=t[r.toUpperCase()]),document.getElementById(e).style.position=r},r.getPosition=function(){return document.getElementById(e).style.position},r.setFloat=function(r){"FLOAT_"==r.substring(0,6)&&(r=t[r.toUpperCase()]),document.getElementById(e).style.float=r},r.getFloat=function(){return document.getElementById(e).style.float},r.setDisplay=function(t){document.getElementById(e).style.display=t},r.getDisplay=function(){return document.getElementById(e).style.display},r.setTop=function(t){document.getElementById(e).style.top=t},r.getTop=function(){return document.getElementById(e).style.top},r.setBottom=function(t){document.getElementById(e).style.bottom=t},r.getBottom=function(){return document.getElementById(e).style.bottom},r.setLeft=function(t){document.getElementById(e).style.left=t},r.getLeft=function(){return document.getElementById(e).style.left},r.setBorderStyle=function(r){"BORDER"==r.substring(0,6)&&(r=t[r.toUpperCase()]),o=r,document.getElementById(e).style.border=i+"px "+o+" "+n},r.getBorderStyle=function(){return o},r.setBorderWidth=function(t){i=t,document.getElementById(e).style.border=i+"px "+o+" "+n},r.getBorderWidth=function(){return i},r.setBorderColor=function(t){"string"!=typeof t&&(t=EJSS_TOOLS.DisplayColors.getLineColor(t)),n=t,document.getElementById(e).style.border=i+"px "+o+" "+n},r.getBorderColor=function(){return n},r.setPadding=function(t){document.getElementById(e).style.padding=t},r.getPadding=function(){return document.getElementById(e).style.padding},r.setShadow=function(t){document.getElementById(e).style.boxShadow=t||""},r.getShadow=function(){return""!=document.getElementById(e).style.boxShadow},r.setMargin=function(t){document.getElementById(e).style.margin=t},r.getMargin=function(){return document.getElementById(e).style.margin},r.setBackgroundImage=function(t){document.getElementById(e).style.backgroundImage="url("+t+")",document.getElementById(e).style.backgroundSize="100% 100%"},r.getBackgroundImage=function(){return document.getElementById(e).style.backgroundImage},r.setBackgroundColor=function(t){"string"!=typeof t&&(t=EJSS_TOOLS.DisplayColors.getLineColor(t)),document.getElementById(e).style.backgroundColor=t},r.getBackgroundColor=function(){return document.getElementById(e).style.backgroundColor},r.setColor=function(t){"string"!=typeof t&&(t=EJSS_TOOLS.DisplayColors.getLineColor(t)),document.getElementById(e).style.color=t},r.getColor=function(){return document.getElementById(e).style.color},r.getFont=function(){return document.getElementById(e).style.font},r.setFont=function(t){var r=document.getElementById(e).style,n=t.split(" ");r.fontStyle=n[0],r.fontWeight=n[1];var i=n[2].split("/");r.fontSize=i[0],i[1]&&(r.lineHeight=i[1]),n[3]&&(r.fontFamily=t.substring(t.indexOf(n[3])))},r.setFontStyle=function(t){document.getElementById(e).style.fontStyle=t},r.getFontStyle=function(){return document.getElementById(e).style.fontStyle},r.setFontFamily=function(t){document.getElementById(e).style.fontFamily=t},r.getFontFamily=function(){return document.getElementById(e).style.fontFamily},r.setFontSize=function(t){document.getElementById(e).style.fontSize=t},r.getFontSize=function(){return document.getElementById(e).style.fontSize},r.setLetterSpacing=function(t){document.getElementById(e).style.letterSpacing=t},r.getLetterSpacing=function(){return document.getElementById(e).style.letterSpacing},r.setOutlineColor=function(t){document.getElementById(e).style.stroke=t},r.getOutlineColor=function(){return document.getElementById(e).style.stroke},r.setFontWeight=function(t){document.getElementById(e).style.fontWeight=t},r.getFontWeight=function(){return document.getElementById(e).style.fontWeight},r.setFillColor=function(t){document.getElementById(e).style.fill=t},r.getFillColor=function(){return document.getElementById(e).style.fill},r.setTransform=function(t){document.getElementById(e).style.transform=t,document.getElementById(e).style["-ms-transform"]=t,document.getElementById(e).style["-webkit-transform"]=t},r.getTransform=function(){return document.getElementById(e).style.transform},r.setWhiteSpace=function(t){document.getElementById(e).style.whiteSpace=t},r.getWhiteSpace=function(){return document.getElementById(e).style.whiteSpace},r};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.SvgGraphics={registerProperties:function(e,t){EJSS_INTERFACE.Element.registerProperties(e,t),t.registerProperty("Height",e.setHeight),t.registerProperty("Width",e.setWidth)}},EJSS_INTERFACE.svgGraphics=function(e){var t=EJSS_INTERFACE.element(e),r=0,n=0;t.setWidth=function(e){if(n!=e){n=e;var r="string"==typeof n&&-1!=n.indexOf("%")?n:parseFloat(n);return t.getDOMElement().setAttribute("width",r),!0}return!1},t.getWidth=function(){return n},t.setHeight=function(e){if(r!=e){r=e;var n="string"==typeof r&&-1!=r.indexOf("%")?r:parseFloat(r);return t.getDOMElement().setAttribute("height",n),!0}return!1},t.getHeight=function(){return r},t.registerProperties=function(e){EJSS_INTERFACE.SvgGraphics.registerProperties(t,e)};var i=document.createElementNS("http://www.w3.org/2000/svg","svg");return i.setAttribute("id",e),i.style.overflow="hidden",i.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),document.body.appendChild(i),t.setDOMElement(i),t.setWidth(500),t.setHeight(500),t};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.TabbedPanel={registerProperties:function(e,t){EJSS_INTERFACE.Element.registerProperties(e,t),t.registerProperty("Titles",e.setTitles,e.getTitles),t.registerProperty("Selected",e.setSelected,e.getSelected),t.registerProperty("Font",e.setFont),t.registerProperty("Foreground",e.setColor),t.registerProperty("Background",e.setBackgroundColor),t.registerProperty("FillColor",e.setFillColor)}},EJSS_INTERFACE.tabbedPanel=function(e){function t(){l.innerHTML="";for(var t=0;t<i.length;t++){var s=i[t],u=document.createElement("li");u.className="_TabbedPanel.li",u.id=e+".item",l.appendChild(u),u.style.background=a||n.getStyle().getBackgroundColor(),u.onmouseover=function(){this.style.cursor="pointer"},u.onmouseout=function(){this.style.cursor="auto"};var g=document.createElement("a");g.className="_TabbedPanel.a",g.id=e+".item.a."+t,g.innerHTML=s,u.appendChild(g),g.style.color=n.getStyle().getColor(),g.style.fontStyle=n.getStyle().getFontStyle(),g.style.fontWeight=n.getStyle().getFontWeight(),g.style.fontSize=n.getStyle().getFontSize(),g.style.fontFamily=n.getStyle().getFontFamily(),g.style.lineHeight=n.getStyle().getLineHeight(),g.onclick=function(){var e=this.id.split(".");o=parseInt(e[e.length-1]),r()},r()}}function r(){for(var e=0;e<u.childNodes.length;e++)u.childNodes[e].style.display="none";u.childNodes.length>o&&(u.childNodes[o].style.display="block");for(var e=0;e<l.childNodes.length;e++)l.childNodes[e].firstChild.style.backgroundColor="transparent";l.childNodes.length>o&&(l.childNodes[o].firstChild.style.backgroundColor=n.getStyle().getFillColor())}var n=EJSS_INTERFACE.element(e),i=[],o=0,a=null;n.appendChild=function(e){var t=e.getDOMElement();u.appendChild(t),r()},n.removeChild=function(e){var t=e.getDOMElement();u.removeChild(t),r()},n.insertBefore=function(e,t){var n=e.getDOMElement(),i=t.getDOMElement();u.insertBefore(n,i),r()},n.getTitles=function(){return i},n.setTitles=function(e){EJSS_TOOLS.compareArrays(i,e)||(i=e,t())},n.getSelected=function(){return o},n.setSelected=function(e){o!=e&&(o=e,r())},n.registerProperties=function(e){EJSS_INTERFACE.TabbedPanel.registerProperties(n,e)},n.setFont=function(e){n.getStyle().setFont(e),t()},n.setFillColor=function(e){n.getStyle().setFillColor(e),r()},n.setBackgroundColor=function(e){a=e,t()},n.setColor=function(e){n.getStyle().setColor(e),t()};var s=document.createElement("span");s.className="_TabbedPanel.span",s.id=e,document.body.appendChild(s),n.setDOMElement(s);var l=document.createElement("ul");l.className="_TabbedPanel.ul",l.id=e+".ul",s.appendChild(l);var u=document.createElement("span");return u.id=e+".divs",s.appendChild(u),t(),n.getStyle().setFillColor("#ccc"),n};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.TextArea={},EJSS_INTERFACE.textArea=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.TextField={registerProperties:function(e,t){EJSS_INTERFACE.Element.registerProperties(e,t),t.registerProperty("Value",e.setValue,e.getValue),t.registerProperty("Editable",e.setEditable),t.registerProperty("Size",e.setSize),t.registerAction("OnChange")}},EJSS_INTERFACE.textField=function(e){function t(){var e=r.getDOMElement().value;if(r.getStyle().setBackgroundColor("white"),r.parseValue&&r.parseValue(e),i!=e){var t=r.getController();t&&(t.propertiesChanged("Value"),t.invokeAction("OnChange"),t.reportInteractions())}}var r=EJSS_INTERFACE.element(e),n=!1,i="";r.registerProperties=function(e){EJSS_INTERFACE.TextField.registerProperties(r,e)},r.enableEPub=function(){r.getDOMElement().disabled&&(r.getDOMElement().disabled=!1)},"undefined"!=typeof _isEPub&&_isEPub&&(r.render=function(){r.enableEPub()}),r.setValue=function(e){n||(r.getDOMElement().value=void 0===e?"value undefined":e)},r.getValue=function(){return r.getDOMElement().value},r.setEditable=function(e){r.getDOMElement().readOnly=!e,e?r.getStyle().setBackgroundColor("white"):r.getStyle().setBackgroundColor("lightgrey")},r.getEditable=function(){return!r.getDOMElement().readOnly},r.setSize=function(e){r.getDOMElement().size=e},r.getSize=function(){return r.getDOMElement().size};var o=document.createElement("input");return o.id=e,o.type="text",document.body.appendChild(o),r.setDOMElement(o),r.getDOMElement().onkeydown=function(e){if(!r.getDOMElement().readOnly){var o=e||window.event,a=o.which?o.which:o.keyCode;13==a?(n=!1,t(),i=r.getDOMElement().value):27==a?r.getDOMElement().value=i:(r.getStyle().setBackgroundColor("yellow"),n=!0)}},r.getDOMElement().onfocus=function(e){i=r.getDOMElement().value},r.getDOMElement().onblur=function(e){!e.readOnly&&n&&(t(),n=!1)},"undefined"!=typeof _isEPub&&_isEPub&&(r.getDOMElement().ontouchstart=function(e){r.getDOMElement().disabled&&(r.getDOMElement().disabled=!1),r.getDOMElement().focus(),e.stop()}),r};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.TwoStateButton={OFF:!1,ON:!0,registerProperties:function(e,t){EJSS_INTERFACE.Element.registerProperties(e,t),t.registerProperty("TextOn",e.setTextOn),t.registerProperty("ImageOnUrl",e.setImageUrlOn),t.registerProperty("TextOff",e.setTextOff),t.registerProperty("ImageOffUrl",e.setImageUrlOff),t.registerProperty("State",e.setState,e.getState),t.registerAction("OnClick"),t.registerAction("OffClick")}},EJSS_INTERFACE.twoStateButton=function(e){function t(){n.getDOMElement().innerHTML="",l?(i.length>0&&(n.getDOMElement().innerHTML='<img style="vertical-align:inherit;-webkit-touch-callout:none;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;" src="'+i+'"/>'),a.length>0&&(n.getDOMElement().innerHTML+='<span style="white-space:pre;vertical-align:inherit;-webkit-touch-callout:none;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;">'+a.toString()+"</span>")):(o.length>0&&(n.getDOMElement().innerHTML='<img style="vertical-align:inherit;-webkit-touch-callout:none;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;" src="'+o+'"/>'),s.length>0&&(n.getDOMElement().innerHTML+='<span style="white-space:pre;vertical-align:inherit;-webkit-touch-callout:none;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;">'+s.toString()+"</span>"))}var r=EJSS_INTERFACE.TwoStateButton,n=EJSS_INTERFACE.element(e),i="",o="",a="",s="",l=-1;n.setTextOff=function(e){s=e,t()},n.getTextOff=function(){return s},n.setImageUrlOff=function(e){var r=n.getResourcePath(e);r!=o&&(o=r,t())},n.getImageUrlOff=function(){return o},n.setTextOn=function(e){a=e,t()},n.getTextOn=function(){return a},n.setImageUrlOn=function(e){var r=n.getResourcePath(e);r!=i&&(i=r,t())},n.getImageUrlOn=function(){return i},n.setState=function(e){"string"==typeof e&&(e=r[e.toUpperCase()]),e!=l&&(l=e,t())},n.getState=function(){return l},n.registerProperties=function(e){EJSS_INTERFACE.TwoStateButton.registerProperties(n,e)};var u=document.createElement("button");return u.id=e,u.style.verticalAlign="middle",u.style.webkitTouchCallout="none",document.body.appendChild(u),n.setDOMElement(u),n.getDOMElement().oncontextmenu=function(e){return!1},n.getDOMElement().onclick=function(e){var t=n.getState();n.setState(!t);var r=n.getController();return r&&(r.propertiesChanged("State"),t?r.invokeAction("OnClick"):r.invokeAction("OffClick"),r.reportInteractions()),!1},n};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Video={},EJSS_INTERFACE.video=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.WebGLCanvas={},EJSS_INTERFACE.webGLCanvas=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.WrappedPanel={},EJSS_INTERFACE.wrappedPanel=function(e){};var EJSS_CORE=EJSS_CORE||{};EJSS_CORE.Model={MODE_JAVA_STYLE:1,MODE_RESPECT_TIME:2,MODE_RESPECT_DELAY:3},EJSS_CORE.createAnimation=function(){function e(e){for(var t=0,r=e.length;t<r;t++)if(c=!1,e[t](),c)return}var t,r,n,i={},o="Choose a name for the file",a=1,s=1,l=!1,u=!0,g=!1,c=!1,S=+new Date,d=!1,f=null,E=NaN,p=a,h=0,m=10,A=!0,P=!1,v=EJSS_CORE.Model.MODE_JAVA_STYLE;i.setView=function(e){f=e,f._12(function(){d||f._16(O,r,d)&&(i.automaticResetSolvers(),i.update())})},i.getView=function(){return f},i.serialize=function(){var e={};i._userSerialize&&(e=i._userSerialize());var t=f.serialize(),r={model:e,view:t};return JSON.stringify(r,function(e,t){return"number"==typeof t&&(isNaN(t)?t="__NaN":isFinite(t)||(t="__Infinity")),t})},i.unserialize=function(e){var t=JSON.parse(e,function(e,t){return"__NaN"==t?t=NaN:"__Infinity"==t&&(t=1/0),t});if(t.model){var r=t.model;i._userUnserialize&&i._userUnserialize(r)}if(t.view){var n=t.view;f.unserialize(n)}};var y,C,D,I,R;i.sendCallback=function(){},i.setStatusParams=function(e,t,r,n,o,a){y=e,C=t,D=r,I=n,R=o,a&&(i.sendCallback=a)},i.sendSnapshot=function(e,t,r,n){I&&e.importGraphics(function(e){var i=new XMLHttpRequest,o="user_file="+t+"&file="+encodeURIComponent(e)+"&type=png&context_id="+y+"&user_id="+C+"&ejsapp_id="+D;i.open("POST",I,!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){4==i.readyState&&200==i.status?r&&r():n&&n()},i.send(o)})},i.sendState=function(e,t,r){if(I){var n=i.serialize(),o=new XMLHttpRequest,a="user_file="+e+"&file="+encodeURIComponent(n)+"&type=json&context_id="+y+"&user_id="+C+"&ejsapp_id="+D;o.open("POST",I,!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){4==o.readyState&&200==o.status?t&&t():r&&r()},o.send(a)}},i.sendText=function(e,t,r,n,i){if(I){var o=new XMLHttpRequest,a="user_file="+e+"&file="+encodeURIComponent(t)+"&type="+r+"&context_id="+y+"&user_id="+C+"&ejsapp_id="+D;o.open("POST",I,!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){4==o.readyState&&200==o.status?n&&n():i&&i()},o.send(a)}},i.getState=function(e,t,r){var n=new XMLHttpRequest;n.open("GET",e,!0),n.setRequestHeader("Cache-Control","no-cache"),n.onreadystatechange=function(){4==n.readyState&&200==n.status?(i.unserialize(n.responseText),t&&t()):r&&r()},n.send()},i.getText=function(e,t,r){var n=new XMLHttpRequest;n.open("GET",e,!0),n.setRequestHeader("Cache-Control","no-cache"),n.onreadystatechange=function(){4==n.readyState&&200==n.status?t&&t(n.responseText):r&&r()},n.send()},i.getStateFiles=function(e,t,r){if(D){
var n=new XMLHttpRequest,i=R+"?ejsapp_id="+D+"&type="+e;n.open("GET",i,!0),n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){var e={};e.name=[],e.url=[];for(var i=JSON.parse(n.responseText),o=0;o<i.file_names.length;o++)e.name.push(i.file_names[o].file_name),e.url.push(i.file_paths[o].file_path);t&&t(e)}else r&&r()},n.send()}},i.saveText=function(e,t,r){if(!r){var r=t;t=null}y?EJSS_INTERFACE.BoxPanel.showInputDialog(o,function(e){i.sendText(e,r,t,function(){i.sendCallback()})}):i.sendText(e,r,t,function(){i.sendCallback()})},i.saveState=function(e){y?EJSS_INTERFACE.BoxPanel.showInputDialog(o,function(e){i.sendState(e,function(){i.sendCallback()})}):i.sendState(e,function(){i.sendCallback()})},i.saveImage=function(e,t){y?EJSS_INTERFACE.BoxPanel.showInputDialog(o,function(e){i.sendSnapshot(f[t],e,function(){i.sendCallback()})}):i.sendSnapshot(f[t],e,function(){i.sendCallback()})},i.readState=function(e,t){if(e)i.getState(e);else{var r=void 0!==t?t:".json";i.getStateFiles(r,function(e){var t={text:e.name,value:e.url};EJSS_INTERFACE.BoxPanel.showSelectDialog("Select a file to read",t,function(e){i.getState(e)})})}},i.readText=function(e,t,r){e?i.getText(e,function(e){if("function"==typeof r)r(e);else{var t={};t[r]=e,i._userUnserialize(t)}}):i.getStateFiles(t,function(e){var t={text:e.name,value:e.url};EJSS_INTERFACE.BoxPanel.showSelectDialog("Select a file to read",t,function(e){i.getText(e,function(e){if("function"==typeof r)r(e);else{var t={};t[r]=e,i._userUnserialize(t)}})})})};var _,T,N=[],O=0,M={},b=!1;i.getEventInteractionsStream=function(e){var t=e.target||e.srcElement,n={pageX:e.pageX,pageY:e.pageY,offsetLeft:t.offsetLeft,offsetTop:t.offsetTop,target:t.id,timeStamp:+new Date};n.runCount=O,n.runTime=r,n.event="mouse",_.send(JSON.stringify(n))},i.startCaptureStream=function(e,t,n,o,a){var s=window.location,l="https:"===s.protocol?"wss:":"ws:";l+="//"+s.host+":"+e;try{_=new WebSocket(l),void 0!==t&&t(),_.onopen=function(){O=0,r=+new Date,f.registerInteractions(_),document.addEventListener("mousemove",i.getEventInteractionsStream),document.addEventListener("touchmove",i.getEventInteractionsStream),document.addEventListener("mousedown",i.getEventInteractionsStream),document.addEventListener("touchstart",i.getEventInteractionsStream)},_.onclose=function(e){i.stopCaptureStream(),a(e)},_.onmessage=function(e){console.log("Message is received: "+e.data)}}catch(e){return void(void 0!==n&&n(e))}},i.stopCaptureStream=function(){try{_.close()}catch(e){}f.unregisterInteractions(),document.removeEventListener("mousemove",i.getEventInteractionsStream),document.removeEventListener("touchmove",i.getEventInteractionsStream),document.removeEventListener("mousedown",i.getEventInteractionsStream),document.removeEventListener("touchstart",i.getEventInteractionsStream)},i.playCaptureStream=function(e,t,n,i,o){if(!b){b=!0;var a=[];try{T=new EventSource(e),void 0!==t&&t(),T.onopen=i,T.onclose=function(e){var t=document.getElementById("_my_mouse");t&&document.body.removeChild(t),o(e)},T.onmessage=function(e){var t=JSON.parse(e.data);console.log("Now: "+Date.now()+"-"+t.timeStamp),a=a.concat(t.interactions)}}catch(e){return void(void 0!==n&&n(e))}setTimeout(function(){O=0,r=+new Date,w=[];var e=0,t=O,n=0,i=0,o=0,s=0,l=setInterval(function(){for(var r=e;r<a.length;){var u=a[r++];if(void 0!==u.isPlaying&&u.isPlaying)w.push(u),e++;else if(u.runCount==t&&n>=u.timeStamp-u.runTime&&i<=u.timeStamp-u.runTime){e++,i=u.timeStamp-u.runTime;for(var g in M){var c=f[g];c.getDOMElement().style.border=M[g]}if(M={},void 0!==u.event){var S=u.pageX,d=u.pageY,E=u.target;if(void 0!==E&&E.length>0){var c=document.getElementById(E);null!=c&&(o=u.offsetLeft-c.offsetLeft,s=u.offsetTop-c.offsetTop)}S-=o,d+=s;var p=document.getElementById("_my_mouse");if(!p){var p=document.createElement("div");p.id="_my_mouse",p.style.position="absolute",p.style.margin="0",p.style.border="3px solid red",document.body.appendChild(p)}p.style.left=S+"px",p.style.top=d+"px"}else if(void 0!==u.property){var c=f[u.element];c.propertyChanged(u.property,u.data).reportInteractions()}else if(void 0!==u.action){var c=f[u.element];c.invokeAction(u.action).reportInteractions(),void 0===M[c.getName()]&&(M[c.getName()]=c.getDOMElement().style.border),c.getDOMElement().style.border="1px solid red"}}}t!=O?(t=O,n=0,i=0):n+=10,b||clearInterval(l)},10)},1e3)}},i.pauseCaptureStream=function(){try{T.close()}catch(e){}b=!1},i.getEventInteractions=function(e){var t=e.target||e.srcElement,n={pageX:e.pageX,pageY:e.pageY,offsetLeft:t.offsetLeft,offsetTop:t.offsetTop,target:t.id,timeStamp:e.timeStamp};n.runCount=O,n.runTime=r,n.event="mouse",N.push(n)},i.startCapture=function(){O=0,r=+new Date,f.registerInteractions(),N=[],document.addEventListener("mousemove",i.getEventInteractions),document.addEventListener("touchmove",i.getEventInteractions),document.addEventListener("mousedown",i.getEventInteractions),document.addEventListener("touchstart",i.getEventInteractions)},i.stopCapture=function(){return f.unregisterInteractions(),document.removeEventListener("mousemove",i.getEventInteractions),document.removeEventListener("touchmove",i.getEventInteractions),document.removeEventListener("mousedown",i.getEventInteractions),document.removeEventListener("touchstart",i.getEventInteractions),{interactions:f.getRegInteractions(),events:N}},i._readCapturedInteractions=function(){for(var e=w.length,t=0;t<e;t++){var r=w[t];if(r.runCount==O&&r.isPlaying){if("undefined"!==r.property){var n=f[r.element];n.propertyChanged(r.property,r.data).reportInteractions()}if("undefined"!==r.action){var n=f[r.element];n.invokeAction(r.action).reportInteractions(),void 0===M[n.getName()]&&(M[n.getName()]=n.getDOMElement().style.border),n.getDOMElement().style.border="1px solid red"}r.runCount=-1}}};var G=!1,x=!1,J=1,L=!1,w=[];i.playCapture=function(e,t,n){var o=e.interactions,s=o.length,l=0,u=e.events,g=u.length,c=0;if(!G){G=!0,x=!1,i.reset(),void 0!==n&&(J=n),a/=J,O=0,r=+new Date,w=o;var S=O,d=0,E=0,p=0,h=setInterval(function(){for(var e in M){var r=f[e];r.getDOMElement().style.border=M[e]}if(M={},G){for(;l<s&&o[l].runCount<=S&&d>=o[l].timeStamp-o[l].runTime;){if(!o[l].isPlaying){if("undefined"!==o[l].property){var r=f[o[l].element];r.propertyChanged(o[l].property,o[l].data).reportInteractions()}if("undefined"!==o[l].action){var r=f[o[l].element];r.invokeAction(o[l].action).reportInteractions(),void 0===M[r.getName()]&&(M[r.getName()]=r.getDOMElement().style.border),r.getDOMElement().style.border="1px solid red"}}l++}for(;c<g&&u[c].runCount<=S&&d>=u[c].timeStamp-u[c].runTime;){var n=u[c].pageX,i=u[c].pageY,m=u[c].target;if(void 0!==m&&m.length>0){var r=document.getElementById(m);null!=r&&(E=u[c].offsetLeft-r.offsetLeft,p=u[c].offsetTop-r.offsetTop)}n-=E,i+=p;var A=document.getElementById("_my_mouse");if(!A){var A=document.createElement("div");A.id="_my_mouse",A.style.position="absolute",A.style.margin="0",A.style.border="3px solid red",document.body.appendChild(A)}A.style.left=n+"px",A.style.top=i+"px",c++}if(S!=O?(S=O,d=0):d+=10*J,c>=g&&l>=s){var A=document.getElementById("_my_mouse");A&&document.body.removeChild(A),clearInterval(h),G=!1,a*=J,w=[],t()}}x&&(clearInterval(h),G=!1,a*=J,w=[],t())},10)}},i.pauseCapture=function(){L=d,i.pause(),G=!1},i.resumeCapture=function(){L&&i.play(),G=!0},i.resetCapture=function(){x=!0},i.changeCaptureStep=function(e){a*=J,J=e,a/=J},i.setMode=function(e){i.setRunningMode(e)},i.setRunningMode=function(e){v="string"==typeof e?EJSS_CORE.Model[e.toUpperCase()]:e},i.getMode=function(){return v},i.setRunAlways=function(e){P=e},i.setPauseOnPageExit=function(e){P=!e},i.setFPS=function(e){a=Math.max(1e3/e,1)},i.getFPS=function(){return Math.floor(1e3/a)},i.setDelay=function(e){a=Math.max(e,0)},i.getDelay=function(e){return a},i.setMinimumDelay=function(e){m=Math.max(e,0)},i.setStepsPerDisplay=function(e){e>=1&&(s=e)},i.setUpdateView=function(e){u=e},i.setAutoplay=function(e){g=e},i.isPlaying=function(){return d},i.isPaused=function(){return!d},i.resetRealTime=function(){var e=+Date();E=1e3*i.getRealTime()-e},i.play=function(){d||(S=+new Date,p=a,d=!0,t=window.setTimeout(i.run,m))},i.pause=function(){d=!1,l=!0,0!=t&&(window.clearTimeout(t),t=0)},i.run=function(){O++,r=+new Date;var e,n=1;if(d){if(A||P){switch(v){default:case EJSS_CORE.Model.MODE_JAVA_STYLE:i.step(),S=+new Date,e=S-r,n=Math.max(m,a-e);break;case EJSS_CORE.Model.MODE_RESPECT_DELAY:i.step(),n=a,S=+new Date;break;case EJSS_CORE.Model.MODE_RESPECT_TIME:if((e=r-S)>=p-h){var o=0;p&&(o=Math.floor((e+h)/p),h=e+h-o*p);var s=i.step(o);p&&s>e&&o>100&&(alert("Imposible running with delay "+p+" ms."),d=!1,h=0),p=a,S=r}}var l=t;if(i._readCapturedInteractions(),f._16(O,r,d)&&(i.automaticResetSolvers(),i.update()),l!=t)return}else S=+new Date;t=window.setTimeout(i.run,n)}},i.onExit=function(){i.pause(),f._16(O,r,d),i.freeMemory()},i.reset=function(e){e||(i.pause(),i.resetModel()),f._14(!1),f._reset(),e||(f._15(),f._initialize(),i.initializeModel()),i.updateModel(),u?(f._update(),f._render()):f._collectData(),f._14(!0),g&&i.play(),f._resized(window.innerWidth,window.innerHeight)},i.initialize=function(){f._initialize(),i.initializeModel(),i.updateModel(),u?(f._update(),f._render()):f._collectData()},i.update=function(){(A||P)&&(i.updateModel(),u?(f._update(),f._render()):f._collectData())},i.step=function(e){var t=+new Date;e||(e=1);var r=Math.max(e,s);if(r>1){l=!1;for(var n=1;n<r;n++){if(l)return void i.update();i.stepModel(),i.updateModel(),f._collectData()}}i.stepModel();var o=+new Date-t;return i.update(),o},i.setShouldBreak=function(e){c=e},i.getShouldBreak=function(){return c},i._autoSelectView=function(e){for(var t=screen.height,r=screen.width,n=[],i=Number.MAX_VALUE,o=0;o<e.length;o++){var a=r-e[o].width;a>=0&&(a<i?(i=a,n=[o]):a==i&&n.push(o))}var s=-1;i=Number.MAX_VALUE;for(var o=0;o<n.length;o++){var a=Math.abs(t-e[n[o]].height);a<i&&(i=a,s=n[o])}return s},i.addToOnload=function(e){n=e},i.onload=function(){"function"==typeof n&&n()},i.parseInputParameters=function(e){if("string"==typeof e||e instanceof String)try{e=EJSS_TOOLS.Decode.hex_to_ascii(e),e=EJSS_TOOLS.Decode.decode(e),"'"==e[0]&&"'"==e[e.length-1]?e=e.substring(1,e.length-1):'"'==e[0]&&'"'==e[e.length-1]&&(e=e.substring(1,e.length-1)),e=JSON.parse(e)}catch(t){return console.log("Error trying to parse input parameters: "+e),null}return e};var W=[],k=[],F=[],V=[];return i.getRealTime=function(){return NaN},i.automaticResetSolvers=function(){},i.freeMemory=function(){},i.addToReset=function(e){W.push(e)},i.addToInitialization=function(e){k.push(e)},i.addToEvolution=function(e){F.push(e)},i.addToFixedRelations=function(e){V.push(e)},i.resetModel=function(){e(W)},i.initializeModel=function(){e(k)},i.stepModel=function(){e(F)},i.updateModel=function(){e(V)},window.onblur=function(){A=!1,f&&f._onBlur()},window.onfocus=function(){A=!0,f&&f._onFocus()},i};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.Bootstrap2IntervalData={},EJSS_ODE_INTERPOLATION.bootstrap2IntervalData=function(e,t,r,n,i){var o,a,s,l,u=EJSS_ODE_INTERPOLATION.bootstrapIntervalData(e,t,r,n,i);u.interpolate=function(e,t){var r=u.getDeltaTime(),n=u.getLeftState(),i=u.getLeftRate(),g=(e-u.getLeft())/r;return n[t]+g*(r*i[t]+g*(o[t]+g*(a[t]+g*(s[t]+g*l[t]))))},u.interpolateState=function(e,t,r,n){return u.bootstrap2((e-u.getLeft())/u.getDeltaTime(),t,r,n),t},u.bootstrap2=function(e,t,r,n){for(var i=u.getDeltaTime(),g=u.getLeftState(),c=u.getLeftRate(),S=r,d=0;d<n;d++)t[d]=g[S]+e*(i*c[S]+e*(o[S]+e*(a[S]+e*(s[S]+e*l[S])))),S++};var g=e.length,c=g-1,S=u.getDeltaTime(),d=new Array(g),f=new Array(g),E=new Array(g);o=new Array(g),a=new Array(g),s=new Array(g),l=new Array(g),u.bootstrap1(.7,d,0,c),d[c]=u.getLeft()+.7*S,i.getRate(d,f),u.bootstrap1(.85,d,0,c),d[c]=u.getLeft()+.85*S,i.getRate(d,E);for(var p=0;p<g;p++){var h=r[p]-e[p],m=S*t[p],A=S*n[p],P=S*f[p]+.7*(.7*-3+2)*A+(1.33-1)*m+-1.26*h,v=S*E[p]+.85*(2-2.55)*A+(.85*(4-2.55)-1)*m+-.765*h,y=(.85*(4-4.579375)*P- -.4095*v)/.009639000000000005,C=(.7*(2+.7*-3.2)*v-.85*(2-2.21)*P)/.009639000000000005,D=A+m-2*h-2*y-3*C;l[p]=C,s[p]=y,a[p]=D,o[p]=h-m-D-y-C}return u};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.BootstrapIntervalData={},EJSS_ODE_INTERPOLATION.bootstrapIntervalData=function(e,t,r,n,i){var o,a,s,l=EJSS_ODE_INTERPOLATION.hermiteIntervalData(e,t,r,n);l.interpolate=function(e,t){var r=l.getDeltaTime(),n=l.getLeftState(),i=l.getLeftRate(),u=(e-l.getLeft())/r;return n[t]+u*(r*i[t]+u*(o[t]+u*(a[t]+u*s[t])))},l.interpolateState=function(e,t,r,n){return l.bootstrap1((e-l.getLeft())/l.getDeltaTime(),t,r,n),t},l.bootstrap1=function(e,t,r,n){for(var i=l.getDeltaTime(),u=l.getLeftState(),g=l.getLeftRate(),c=r,S=0;S<n;S++)t[S]=u[c]+e*(i*g[c]+e*(o[c]+e*(a[c]+e*s[c]))),c++};var u=e.length,g=l.getDeltaTime(),c=new Array(u),S=new Array(u);o=new Array(u),a=new Array(u),s=new Array(u),l.hermite(.25,c,0,u-1),c[u-1]=l.getLeft()+.25*g,i.getRate(c,S);for(var d=0;d<u;d++){var f=r[d]-e[d],E=g*t[d],p=g*n[d],h=(g*S[d]+.3125*p+-.1875*E+-1.125*f)/.1875,m=p+E-2*f-2*h;s[d]=h,a[d]=m,o[d]=f-E-m-h}return l};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.ConstantConditionData={},EJSS_ODE_INTERPOLATION.constantConditionData=function(e){var t,r=EJSS_ODE_INTERPOLATION.intervalData(Number.NaN,Number.NaN);r.interpolate=function(e,r){return t[r]},r.interpolateState=function(e,r,n,i){for(var o=n,a=0;a<i;a++)r[a]=t[o],o++;return r};var n=e.length;t=new Array(n);for(var i=0;i<n;i++)t[i]=e[i];return r};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.Dopri5IntervalData={},EJSS_ODE_INTERPOLATION.dopri5IntervalData=function(e,t,r){var n=EJSS_ODE_INTERPOLATION.extraStepsIntervalData(e,bState,r);return n.interpolate=function(e,t){var r=(e-n.getLeft())/n.getDeltaTime(),i=1-r,o=n.getCoeffs();return o[0][t]+r*(o[1][t]+i*(o[2][t]+r*(o[3][t]+i*o[4][t])))},n.interpolateState=function(e,t,r,i){for(var o=(e-n.getLeft())/n.getDeltaTime(),a=1-o,s=n.getCoeffs(),l=r,u=0;u<i;u++)t[u]=s[0][l]+o*(s[1][l]+a*(s[2][l]+o*(s[3][l]+a*s[4][l]))),l++;return t},n};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.Dopri853IntervalData={},EJSS_ODE_INTERPOLATION.dopri853IntervalData=function(e,t,r){var n=EJSS_ODE_INTERPOLATION.extraStepsIntervalData(e,bState,r);return n.interpolate=function(e,t){var r=(e-n.getLeft())/n.getDeltaTime(),i=1-r,o=n.getCoeffs();return o[0][t]+r*(o[1][t]+i*(o[2][t]+r*(o[3][t]+i*(o[4][t]+r*(o[5][t]+i*(o[6][t]+r*o[7][t]))))))},n.interpolateState=function(e,t,r,i){for(var o=(e-n.getLeft())/n.getDeltaTime(),a=1-o,s=n.getCoeffs(),l=r,u=0;u<i;u++)t[u]=s[0][l]+o*(s[1][l]+a*(s[2][l]+o*(s[3][l]+a*(s[4][l]+o*(s[5][l]+a*(s[6][l]+o*s[7][l])))))),l++;return t},n};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.EulerIntervalData={},EJSS_ODE_INTERPOLATION.eulerIntervalData=function(e,t,r){var n,i,o=EJSS_ODE_INTERPOLATION.intervalData(e[e.length-1],r);o.interpolate=function(e,t){var r=e-o.getLeft();return n[t]+r*i[t]},o.interpolateState=function(e,t,r,a){for(var s=e-o.getLeft(),l=r,u=0;u<a;u++)t[u]=n[l]+s*i[l],l++;return t};var a=e.length;n=new Array(a),i=new Array(a);for(var s=0;s<a;s++)n[s]=e[s],i[s]=t[s];return o};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.EulerRichardsonIntervalData={},EJSS_ODE_INTERPOLATION.eulerRichardsonIntervalData=function(e,t,r,n){var i,o,a,s,l,u=EJSS_ODE_INTERPOLATION.intervalData(e[e.length-1],r);u.interpolate=function(e,t){var r=(e-u.getLeft())/o,n=r*r*o,i=o*r-n;return a[t]+i*s[t]+n*l[t]},u.interpolateState=function(e,t,r,n){for(var i=(e-u.getLeft())/o,g=i*i*o,c=o*i-g,S=r,d=0;d<n;d++)t[d]=a[S]+c*s[S]+g*l[S],S++;return t};var g=e.length;a=new Array(g),s=new Array(g),l=new Array(g);for(var c=0;c<g;c++)a[c]=e[c],s[c]=t[c],l[c]=n[c];return i=g-1,o=r-e[i],u};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.ExtraStepsIntervalData={},EJSS_ODE_INTERPOLATION.extraStepsIntervalData=function(e,t,r){var n,i,o,a=EJSS_ODE_INTERPOLATION.intervalData(e[e.length-1],t[t.length-1]);a.getTimeIndex=function(){return n},a.getDeltaTime=function(){return i},a.getCoeffs=function(){return o};var s=e.length;n=s-1,i=t[n]-e[n];var l=r.length;o=new Array(l);for(var u=0;u<l;u++){o[u]=new Array(s);for(var g=0;g<s;g++)o[u][g]=r[u][g]}return a};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.HermiteIntervalData={},EJSS_ODE_INTERPOLATION.hermiteIntervalData=function(e,t,r,n){var i,o,a,s,l,u,g=EJSS_ODE_INTERPOLATION.intervalData(e[e.length-1],r[r.length-1]);g.getTimeIndex=function(){return i},g.getDeltaTime=function(){return o},g.getLeftState=function(){return a},g.getLeftRate=function(){return s},g.interpolate=function(e,t){var r=(e-g.getLeft())/o,n=r-1,i=r*n,c=i*(1-2*r),S=-n-c,d=r+c,f=i*n*o,E=i*r*o;return S*a[t]+d*l[t]+f*s[t]+E*u[t]},g.interpolateState=function(e,t,r,n){return g.hermite((e-g.getLeft())/o,t,r,n),t},g.hermite=function(e,t,r,n){for(var i=e-1,g=e*i,c=g*(1-2*e),S=-i-c,d=e+c,f=g*i*o,E=g*e*o,p=r,h=0;h<n;h++)t[h]=S*a[p]+d*l[p]+f*s[p]+E*u[p],p++};var c=e.length;a=new Array(c),s=new Array(c),l=new Array(c),u=new Array(c);for(var S=0;S<c;S++)a[S]=e[S],s[S]=t[S],l[S]=r[S],u[S]=n[S];return i=c-1,o=r[i]-e[i],g};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.InitialConditionData={},EJSS_ODE_INTERPOLATION.initialConditionData=function(e){var t,r=EJSS_ODE_INTERPOLATION.intervalData(Number.NaN,Number.NaN);r.interpolate=function(r,n){return e.getInitialCondition(r,t),t[n]},r.interpolateState=function(r,n,i,o){e.getInitialCondition(r,t);for(var a=i,s=0;s<o;s++)n[s]=t[a],a++;return n};var n=e.getState(),i=n.length;return t=new Array(i),r};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.IntervalData={},EJSS_ODE_INTERPOLATION.intervalData=function(e,t){var r={};return r.getLeft=function(){return e},r.getRight=function(){return t},r.setRight=function(e){t=e},r.interpolate=function(e,t){return Number.NaN},r.interpolateState=function(e,t,r,n){return t},r};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.Radau5IntervalData={},EJSS_ODE_INTERPOLATION.radau5IntervalData=function(e,t,r){var n=EJSS_ODE_INTERPOLATION.extraStepsIntervalData(e,bState,r),i=bState[bState.length-1];return n.interpolate=function(e,t){var r=(e-i)/n.getDeltaTime(),o=n.getCoeffs(),a=EJSS_ODE_SOLVERS.Radau5.c1m1,s=EJSS_ODE_SOLVERS.Radau5.c2m1;return o[0][t]+r*(o[1][t]+(r-s)*(o[2][t]+(r-a)*o[3][t]))},n.interpolateState=function(e,t,r,o){for(var a=(e-i)/mDeltaTime,s=n.getCoeffs(),l=EJSS_ODE_SOLVERS.Radau5.c1m1,u=EJSS_ODE_SOLVERS.Radau5.c2m1,g=r,c=0;c<o;c++)t[c]=s[0][g]+a*(s[1][g]+(a-u)*(s[2][g]+(a-l)*s[3][g])),g++;return t},n};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.StateHistory={},EJSS_ODE_INTERPOLATION.stateHistory=function(e){var t,r={},n=[],i=!0,o=0,a=0,s=0;return r.setLength=function(e){a=Math.abs(e),s=Math.max(o,a)},r.setMinimumLength=function(e){o=Math.abs(e),s=Math.max(o,a)},r.addIntervalData=function(e){i=e.getLeft()<=e.getRight();n.length;if(n.length>0){var t=n.length-1,r=n[t],o=0;if(i){for(;null!=r&&r.getLeft()>=e.getLeft();)o++,t--,r=t<0?null:n[t];null!=r&&e.getLeft()<r.getRight()&&r.setRight(e.getLeft())}else{for(;null!=r&&r.getLeft()<=e.getLeft();)o++,t--,r=t<0?null:n[t];null!=r&&e.getLeft()>r.getRight()&&r.setRight(e.getLeft())}o>0&&n.splice(t,o)}n.push(e)},r.toString=function(){for(var e="History has now "+n.length+" intervals: ",t=0,r=n.length;t<r;t++){var i=n[t];t>0&&(e+=", "),e+=" ["+i.getLeft()+","+i.getRight()+")"}return e},r.clearAll=function(){n=[]},r.clean=function(e){if(isFinite(s)){if(0==s)return void clearAll();var t=0,r=n.length;if(i){e-=s;for(var o=0;o<r;o++){var a=n[o];if(a.getRight()>e)break;t++}}else{e+=s;for(var o=0;o<r;o++){var a=n[o];if(a.getRight()<e)break;t++}}t>0&&n.splice(0,t)}},r.findInterval=function(e){var r=n.length;if(i)for(var o=r-1;o>=0;o--){var a=n[o];if(a.getLeft()<=e)return a}else for(var o=r-1;o>=0;o--){var a=n[o];if(a.getLeft()>=e)return a}return t},r.interpolate=function(e,t){return r.findInterval(e).interpolate(e,t)},r.interpolateState=function(e,t,n,i){var o=r.findInterval(e);return i||(i=t.length),n||(n=0),o.interpolateState(e,t,n,i)},e.getInitialCondition?(t=EJSS_ODE_INTERPOLATION.initialConditionData(e),e.setStateHistory(r)):t=EJSS_ODE_INTERPOLATION.constantConditionData(e.getState()),r};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.EVENT_TYPE={STATE_EVENT:0,POSITIVE_EVENT:1,CROSSING_EVENT:2},EJSS_ODE_SOLVERS.EVENT_METHOD={BISECTION:0,SECANT:1},EJSS_ODE_SOLVERS.ERROR={NO_ERROR:0,INTERNAL_SOLVER_ERROR:1,EVENT_NOT_FOUND:2,ILLEGAL_EVENT_STATE:3,ZENO_EFFECT:4,TOO_MANY_STEPS_ERROR:5,DISCONTINUITY_PRODUCED_ERROR:6,DID_NOT_CONVERGE:7},EJSS_ODE_SOLVERS.DISCONTINUITY_CODE={DISCONTINUITY_PRODUCED_ERROR:0,NO_DISCONTINUITY_ALONG_STEP:1,DISCONTINUITY_ALONG_STEP:2,DISCONTINUITY_JUST_PASSED:3,DISCONTINUITY_EXACTLY_ON_STEP:4},EJSS_ODE_SOLVERS.InterpolatorEventSolver={},EJSS_ODE_SOLVERS.interpolatorEventSolver=function(e,t){function r(t,r){h?e.bestInterpolate(t,r):e.interpolate(t,r)}function n(){var n=t.getState(),i=e.getCurrentRate(),o=n[S];if(o+i[S]==o)return 0;var a=e.getMaximumTime(!1);return isNaN(a)?E.error(EJSS_ODE_SOLVERS.ERROR.INTERNAL_SOLVER_ERROR,"Error when stepping the solver at "+n[S]):o==a&&(a=e.internalStep(!1),isNaN(a))?E.error(EJSS_ODE_SOLVERS.ERROR.INTERNAL_SOLVER_ERROR,"Error when stepping the solver at max step at "+n[S]):(r(a,n),a-o)}function i(){var n=t.getState(),i=e.getCurrentRate(),o=n[S];if(o+i[S]==o)return 0;var a=n[S]+m,s=e.getMaximumTime(!1);if(isNaN(s))return E.error(EJSS_ODE_SOLVERS.ERROR.INTERNAL_SOLVER_ERROR,"Error when stepping the solver at "+n[S]);var l=0;if(R)for(;s<a;){if(s=e.internalStep(!1),isNaN(s))return E.error(EJSS_ODE_SOLVERS.ERROR.INTERNAL_SOLVER_ERROR,"Error when stepping the solver forwards at "+n[S]);if(++l>I){var u=n[S],g=e.bestInterpolate(a,new Array(c))[S];return E.error(EJSS_ODE_SOLVERS.ERROR.TOO_MANY_STEPS_ERROR,"The solver exceeded the maximum of "+I+" internal steps\nat "+g+", starting from "+u+" for an step of "+m)}}else for(;s>a;){if(s=e.internalStep(!1),isNaN(s))return E.error(EJSS_ODE_SOLVERS.ERROR.INTERNAL_SOLVER_ERROR,"Error when stepping the solver backwards at "+n[S]);if(++l>I)return E.error(EJSS_ODE_SOLVERS.ERROR.TOO_MANY_STEPS_ERROR,"The solver exceeded the number of internal steps at "+n[S])}return r(a,n),m}function o(){var n=t.getState();if(y>0&&J>y&&l(n))return 0;var i=n[S];if(i+e.getCurrentRate()[S]==i)return 0;var o=e.getMaximumTime(k);if(isNaN(o))return E.error(EJSS_ODE_SOLVERS.ERROR.INTERNAL_SOLVER_ERROR,"Error when stepping the solver at "+n[S]);if(i==o&&(o=e.internalStep(k),isNaN(o)))return E.error(EJSS_ODE_SOLVERS.ERROR.INTERNAL_SOLVER_ERROR,"Error when stepping the solver forwards at "+n[S]);null!=x&&(isNaN(x.getMaxAdvance())||(o=R?Math.min(o,x.getMaxAdvance()):Math.max(o,x.getMaxAdvance())));for(var a=R?Math.min(i+v,o):Math.max(i-v,o);;){var u=null;if(w=null,r(a,d),u=E.findFirstEvent(n,a,d),null==u&&null!=F&&F.getTime()<=a&&(u=F),null!=u){if(w=u,h)e.bestInterpolate(u.getTime(),n);else for(var g=0;g<c;g++)n[g]=d[g];var f=n[S];return u.action(),(E.reinitialize(),n=t.getState(),f!=n[S])?(J=0,x=null,w=null,u.reset(n),u.getTime()-i):(null!=x&&(Math.abs(G-u.getTime())<C?J++:J=0),x=u,G=u.getTime(),u.getTime()-i)}if(a==o){for(var g=0;g<c;g++)n[g]=d[g];return s(n[S]),o-i}a=R?Math.min(a+v,o):Math.max(a-v,o)}}function a(){var n=t.getState();if(y>0&&J>y&&l(n))return 0;var i=n[S];if(i+e.getCurrentRate()[S]==i)return 0;var o=i+m,a=e.getMaximumTime(k);if(isNaN(a))return E.error(EJSS_ODE_SOLVERS.ERROR.INTERNAL_SOLVER_ERROR,"Error when stepping the solver at "+n[S]);for(var u=R?Math.min(i+v,o):Math.max(i-v,o),g=0;;){var f=null;w=null;if(R?a<u:a>u){if(e.bestInterpolate(a,d),f=E.findFirstEvent(n,a,d),null==f&&(f=F),null==f){for(var p=0;p<c;p++)n[p]=d[p];if(s(n[S]),a=e.internalStep(k),isNaN(a))return E.error(EJSS_ODE_SOLVERS.ERROR.INTERNAL_SOLVER_ERROR,"Error when stepping the solver looking for an event at "+n[S]);if(++g>I)return E.error(EJSS_ODE_SOLVERS.ERROR.TOO_MANY_STEPS_ERROR,"The solver exceeded the number of internal steps at "+n[S]);continue}}else if(r(u,d),f=E.findFirstEvent(n,u,d),null==f&&null!=F&&F.time<=u&&(f=F),null==f){if(u==o){for(var p=0;p<c;p++)n[p]=d[p];return s(n[S]),o-i}u=R?Math.min(u+v,o):Math.max(u-v,o);continue}if(w=f,h)e.bestInterpolate(f.getTime(),n);else for(var p=0;p<c;p++)n[p]=d[p];var A=n[S],P=f.action();if(E.reinitialize(),g=0,n=t.getState(),A!=n[S])return J=0,x=null,w=null,f.reset(n),f.getTime()-i;if(null!=x&&(Math.abs(G-f.getTime())<C?(J++,D&&(P=!1)):J=0),x=f,G=f.getTime(),P)return f.getTime()-i;if(y>0&&J>y&&l(n))return f.getTime()-i;if(F=null,a=e.getMaximumTime(k),isNaN(f.getMaxAdvance())||(a=R?Math.min(a,f.getMaxAdvance()):Math.max(a,f.getMaxAdvance())),isNaN(a))return E.error(EJSS_ODE_SOLVERS.ERROR.INTERNAL_SOLVER_ERROR,"Error when stepping the solver after an event at "+n[S])}}function s(e){var t,r;for(r=O.length,t=0;t<r;t++){var n=O[t];n.findPosition(e,n.getH())}for(r=V.length,t=0;t<r;t++){var n=V[t];n.findPosition(e,n.getH())}}function l(e){if(L.length<=0)return E.error(EJSS_ODE_SOLVERS.ERROR.ZENO_EFFECT,"A Zeno-like effect has been detected.\nLast event was "+x.getProblem()+" which took place at "+G),!0;var t,r=!1,n=L.length;for(t=0;t<n;t++){L[t].zenoEffectAction(x.getProblem(),e)&&(r=!0)}return J=0,r}function u(e,t,r,n){r.splice(0,r.length);for(var i=O.length,o=0;o<i;o++){var a=O[o];switch(a.setH(a.getEvent().evaluate(t)),a.getCurrentPosition()){default:case EJSS_ODE_SOLVERS.ProblemData.POSITIVE:a.getH()<=0&&r.push(a);break;case EJSS_ODE_SOLVERS.ProblemData.SMALL_POSITIVE:if(a.getH()<=0&&(a.hasPositiveFlag()||a.getEventType()==EJSS_ODE_SOLVERS.EVENT_TYPE.STATE_EVENT))return a;break;case EJSS_ODE_SOLVERS.ProblemData.ZERO:if(a.getH()<0){if(a.hasPositiveFlag()||a.getEventType()==EJSS_ODE_SOLVERS.EVENT_TYPE.STATE_EVENT)return a}else if(a.getH()>0&&a.hasNegativeFlag()&&a.getEventType()==EJSS_ODE_SOLVERS.EVENT_TYPE.CROSSING_EVENT)return a;break;case EJSS_ODE_SOLVERS.ProblemData.SMALL_NEGATIVE:if(a.getEventType()==EJSS_ODE_SOLVERS.EVENT_TYPE.STATE_EVENT){if(a.getH()<=-a.getEvent().getTolerance())return a}else if(a.getEventType()==EJSS_ODE_SOLVERS.EVENT_TYPE.CROSSING_EVENT&&a.hasNegativeFlag()&&a.getH()>=0)return a;break;case EJSS_ODE_SOLVERS.ProblemData.NEGATIVE:if(a.getEventType()==EJSS_ODE_SOLVERS.EVENT_TYPE.CROSSING_EVENT)a.getH()>=0&&r.push(a);else if(a.getEventType()==EJSS_ODE_SOLVERS.EVENT_TYPE.STATE_EVENT)return E.error(EJSS_ODE_SOLVERS.ERROR.ILLEGAL_EVENT_STATE,"The system started from an illegal state at "+e+" for the state event "+a.getEvent()),a}}return null}function g(e,t,r){var n,i,o=e.length,a=r,s=r-t,l=(t+r)/2;if(R)for(n=0;n<o;n++){var u=e[n];switch(u.getEvent().getRootFindingMethod()){default:case EJSS_ODE_SOLVERS.EVENT_METHOD.BISECTION:a=Math.min(a,l);break;case EJSS_ODE_SOLVERS.EVENT_METHOD.SECANT:i=u.getHBefore(),a=Math.min(a,t-i*s/(u.getHAfter()-i))}}else for(n=0;n<o;n++){var u=e[n];switch(u.getEvent().getRootFindingMethod()){default:case EJSS_ODE_SOLVERS.EVENT_METHOD.BISECTION:a=Math.max(a,l);break;case EJSS_ODE_SOLVERS.EVENT_METHOD.SECANT:i=u.getHBefore(),a=Math.max(a,t-i*s/(u.getHAfter()-i))}}return a}var c,S,d,f,E={},p=!0,h=!1,m=.1,A=Number.NaN,P=Number.NaN,v=Number.POSITIVE_INFINITY,y=500,C=2*Number.MIN_VALUE,D=!0,I=1e4,R=m>0,_=EJSS_ODE_SOLVERS.ERROR.NO_ERROR,T="No error",N=0,O=[],M=[],b=[],G=Number.NaN,x=null,J=0,L=[],w=null,W=!1,k=!1,F=null,V=[],B=null,z=100,H=1e-8,Y=Number.NaN;return E.getEPSILON=function(){if(isNaN(Y)){for(Y=1;Y+1!=1;)Y/=2;Y*=2}return Y},E.setEnableExceptions=function(e){p=e},E.setBestInterpolation=function(e){h=e},E.setHistoryLength=function(t){e.getStateHistory().setLength(t)},E.setStepSize=function(t){m!=t&&(m=t,R=m>0,E.setInternalStepSize(e.getStepSize()))},E.getStepSize=function(){return m},E.setEstimateFirstStep=function(t){e.setEstimateFirstStep(t)},E.setInternalStepSize=function(t){e.setStepSize(R?Math.abs(t):-Math.abs(t))},E.setMaximumInternalStepSize=function(t){e.setMaximumStepSize(t)},E.setMaximumInternalSteps=function(e){I=e},E.setTolerances=function(t,r){e.setTolerances(A=Math.abs(t),P=Math.abs(r))},E.setTolerance=function(e){setTolerances(e,0)},E.getTolerance=function(){return Math.max(A,P)},E.setDDETolerance=function(e){H=e},E.getDDETolerance=function(){return H},E.setDDEIterations=function(e){z=e},E.getDDEIterations=function(){return z},E.addEvent=function(e){O.push(EJSS_ODE_SOLVERS.eventData(E,e,t.getState())),W=!0},E.removeEvent=function(e){for(var t=-1,r=O.length,n=0;n<r;n++){if(O[n].getEvent()==e){t=n;break}}if(t>=0){var i=O[t];x==i&&(x=null,J=0),w==i&&(w=null),O.splice(t,1)}W=k||O.length>0},E.addDiscontinuity=function(e){V.push(EJSS_ODE_SOLVERS.discontinuityData(E,e,t.getState())),k=!0,W=!0},E.removeDiscontinuity=function(e){for(var t=-1,r=V.length,n=0;n<r;n++){if(V[n].getDiscontinuity()==e){t=n;break}}t>=0&&V.splice(t,1),k=V.length>0,W=k||O.length>0},E.removeAllEvents=function(){O=[],V=[],k=!1,W=!1,null!=B&&E.addDiscontinuity(B)},E.setMaximumEventStep=function(e){v=Math.abs(e)},E.getMaximumEventStep=function(){return v},E.setCoalesceCloseEvents=function(e){D=e},E.isCoalesceCloseEvents=function(){return D},E.setEventProximityThreshold=function(e){C=e},E.getEventProximityThreshold=function(){return C},E.setZenoEffectDetection=function(e){y=e},E.getZenoEffectDetection=function(){return y},E.addZenoEffectListener=function(e){L.push(e)},E.removeZenoEffectListener=function(e){for(var t=L.length,r=0;r<t;r++)if(L[r]==e)return void L.splice(r,1)},E.setZeroZenoCounter=function(){J=0},E.getSolverEngine=function(){return e},E.getODE=function(){return t},E.getStateHistory=function(){return e.getStateHistory()},E.getErrorCode=function(){return _},E.getErrorMessage=function(){return T},E.getCounter=function(){return e.getCounter()},E.getNumberOfAttempts=function(){return N},E.getInternalStepSize=function(){return e.getInternalStepSize()},E.getIndependentVariableValue=function(){return t.getState()[S]},E.getCurrentTime=function(){return t.getState()[S]},E.getRunsForwards=function(){return R},E.getCurrentEventData=function(){return w},E.getLastEventData=function(){return x},E.getLastEventDataTime=function(){return G},E.initialize=function(r){var n,i,o;for(m=r,R=m>0,e.initialize(m),o=t.getState(),c=o.length,S=c-1,d=new Array(c),f=new Array(c),_=EJSS_ODE_SOLVERS.ERROR.NO_ERROR,T="No error",J=0,x=null,w=null,null!==B&&(B.initialize(o),E.removeDiscontinuity(B),E.addDiscontinuity(B)),i=O.length,n=0;n<i;n++)O[n].reset(o);for(i=V.length,n=0;n<i;n++)V[n].reset(o)},E.step=function(){return W?a():i()},E.maxStep=function(){return W?o():n()},E.userReinitialize=function(){w=null,E.reinitialize()},E.reinitialize=function(){var r,n,i=t.getState();for(e.reinitialize(i),_=EJSS_ODE_SOLVERS.ERROR.NO_ERROR,T="No error",null!=B&&B.reset(i),n=O.length,r=0;r<n;r++)O[r].reset(i);for(n=V.length,r=0;r<n;r++)V[r].reset(i);F=null},E.resetDiscontinuities=function(e){if(null!==B){B.reset(e);for(var t=V.length,r=0;r<t;r++)V[r].reset(e)}},E.checkDiscontinuity=function(e,t){for(var r=V.length,n=null,i=0;i<r;i++){var o=V[i],a=o.getDiscontinuity().evaluate(e);switch(o.setH(a),o.getCurrentPosition()){default:case EJSS_ODE_SOLVERS.ProblemData.POSITIVE:if(a<=0)return EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_ALONG_STEP;a<o.getDiscontinuity().getTolerance()&&(n=o);break;case EJSS_ODE_SOLVERS.ProblemData.SMALL_POSITIVE:if(a<=0&&o.hasPositiveFlag())return E.error(EJSS_ODE_SOLVERS.ERROR.ILLEGAL_EVENT_STATE,"The system started from an illegal state at "+e[S]+" for the discontinuity "+o.getDiscontinuity()),EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_PRODUCED_ERROR;break;case EJSS_ODE_SOLVERS.ProblemData.ZERO:
if(a<0&&o.hasPositiveFlag())return E.error(EJSS_ODE_SOLVERS.ERROR.ILLEGAL_EVENT_STATE,"The system started from an illegal state at "+e[S]+" for the discontinuity "+o.getDiscontinuity()),EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_PRODUCED_ERROR;if(a>0&&o.hasNegativeFlag())return E.error(EJSS_ODE_SOLVERS.ERROR.ILLEGAL_EVENT_STATE,"The system started from an illegal state at "+e[S]+" for the discontinuity "+o.getDiscontinuity()),EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_PRODUCED_ERROR;break;case EJSS_ODE_SOLVERS.ProblemData.SMALL_NEGATIVE:if(o.hasNegativeFlag()&&a>=0)return E.error(EJSS_ODE_SOLVERS.ERROR.ILLEGAL_EVENT_STATE,"The system started from an illegal state at "+e[S]+" for the discontinuity "+o.getDiscontinuity()),EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_PRODUCED_ERROR;break;case EJSS_ODE_SOLVERS.ProblemData.NEGATIVE:if(a>0)return EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_ALONG_STEP;a>-o.getDiscontinuity().getTolerance()&&(n=o)}}return null!=n?(t&&(F=n,F.setTime(e[S])),EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_EXACTLY_ON_STEP):EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.NO_DISCONTINUITY_ALONG_STEP},E.error=function(t,r){if(_=t,T=r,p)throw{name:"ODE Solver exception",solver:e,message:r};return Number.NaN},E.findFirstEvent=function(t,n,i){var o,a;N=0;var s=u(t[S],i,M,"at t1");if(null!=s){for(s.time=t[S],s.maxAdvance=n,o=0;o<c;o++)i[o]=t[o];return s}if(M.length<=0)return null;var l=!0;for(a=O.length,o=0;o<a;o++){var d=O[o];d.setHAfter(d.getH())}for(;l;){N++;var p=g(M,t[S],n);r(p,f);var h=u(t[S],f,b,"short");if(null!=h){for(h.time=t[S],h.maxAdvance=p,o=0;o<c;o++)i[o]=t[o];return h}if(b.length<=0){var m=null;for(a=M.length,o=0;o<a;o++){var d=M[o];if(d.getCurrentPosition()==EJSS_ODE_SOLVERS.ProblemData.POSITIVE){if(d.getH()<d.getEvent().getTolerance()){m=d;break}}else if(d.getH()>-d.getEvent().getTolerance()){m=d;break}}if(null!=m){for(m.time=p,m.maxAdvance=n,o=0;o<c;o++)i[o]=f[o];return m}for(o=0;o<c;o++)t[o]=f[o];for(a=O.length,o=0;o<a;o++){var d=O[o];d.findPosition(t[S],d.getH())}var A=u(t[S],i,M,"at tTest");if(null!=A){for(A.time=t[S],A.maxAdvance=n,o=0;o<c;o++)i[o]=t[o];return A}}else{var P=!0,m=null;for(a=b.length,o=0;o<a;o++){var v=b[o];if(v.getCurrentPosition()==EJSS_ODE_SOLVERS.ProblemData.POSITIVE){if(v.getH()<=-v.getEvent().getTolerance()){P=!1;break}m=v}else{if(v.getH()>=v.getEvent().getTolerance()){P=!1;break}m=v}}if(P&&null!=m){for(m.time=p,m.maxAdvance=n,o=0;o<c;o++)i[o]=f[o];return m}for(n=p,o=0;o<c;o++)i[o]=f[o];for(a=O.length,o=0;o<a;o++){var d=O[o];d.setHAfter(d.getH())}for(M=[],a=b.length,o=0;o<a;o++)M.push(b[o])}for(a=M.length,o=0;o<a;o++){var v=M[o];if(N>v.getEvent().getMaxIterations()){l=!1;break}}}var y=M[0];return E.error(EJSS_ODE_SOLVERS.ERROR.EVENT_NOT_FOUND,"Warning : Event not found after "+N+" attempts at t="+t[S]+" h="+y.getH()+".\nPlease check the code of your event, decrease the initial step size, the tolerance of the solver,\nor the event maximum step, or increase the maximum number of attempts.\nFirst event remaining in the queue: "+y.getEvent()),y.setTime((t[S]+n)/2),y.setMaxAdvance(Number.NaN),e.bestInterpolate(y.time,i),y},t.getDelays&&(B=EJSS_ODE_SOLVERS.ddeDiscontinuity(E,t)),e.setODE(E,t),E};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.BogackiShampine23={B3_1:2/9,B3_2:1/3,B3_3:4/9,B2_1:7/24,B2_2:.25,B2_3:1/3,B2_4:1/8},EJSS_ODE_SOLVERS.bogackiShampine23=function(){var e,t,r,n=EJSS_ODE_SOLVERS.solverEngineDiscreteTimeAdaptive(3),i=n.allocateOtherArrays;return n.getNumberOfEvaluations=function(){return 3},n.allocateOtherArrays=function(){i(),e=new Array(n.getDimension()),t=new Array(n.getDimension()),r=new Array(n.getDimension())},n.computeIntermediateStep=function(r,i){var o,a=r/2,s=n.getODE(),l=n.getInitialState(),u=n.getInitialRate(),g=n.getDimension(),c=g-1,S=(u[c],EJSS_ODE_SOLVERS.BogackiShampine23);for(o=0;o<g;o++)i[o]=l[o]+a*u[o];s.getRate(i,e);var d=.75*r;for(o=0;o<g;o++)i[o]=l[o]+d*e[o];for(s.getRate(i,t),o=0;o<c;o++)i[o]=l[o]+r*(S.B3_1*u[o]+S.B3_2*e[o]+S.B3_3*t[o]);i[c]=n.getInitialTime()+r*u[c]},n.computeCarefulIntermediateStep=function(r,i,o){var a,s=i/2,l=n.getODE(),u=n.getInitialState(),g=n.getInitialRate(),c=n.getDimension(),S=c-1,d=(g[S],EJSS_ODE_SOLVERS.BogackiShampine23),f=EJSS_ODE_SOLVERS.DISCONTINUITY_CODE;for(a=0;a<c;a++)o[a]=u[a]+s*g[a];switch(r.checkDiscontinuity(o,!1)){case f.DISCONTINUITY_PRODUCED_ERROR:return f.DISCONTINUITY_PRODUCED_ERROR;case f.DISCONTINUITY_JUST_PASSED:return f.DISCONTINUITY_JUST_PASSED;case f.DISCONTINUITY_ALONG_STEP:return f.DISCONTINUITY_ALONG_STEP;case f.DISCONTINUITY_EXACTLY_ON_STEP:case f.NO_DISCONTINUITY_ALONG_STEP:}l.getRate(o,e);var E=.75*i;for(a=0;a<c;a++)o[a]=u[a]+E*e[a];switch(r.checkDiscontinuity(o,!1)){case f.DISCONTINUITY_PRODUCED_ERROR:return f.DISCONTINUITY_PRODUCED_ERROR;case f.DISCONTINUITY_JUST_PASSED:return f.DISCONTINUITY_CODE.DISCONTINUITY_JUST_PASSED;case f.DISCONTINUITY_ALONG_STEP:return f.DISCONTINUITY_ALONG_STEP;case f.DISCONTINUITY_EXACTLY_ON_STEP:case f.NO_DISCONTINUITY_ALONG_STEP:}for(l.getRate(o,t),a=0;a<S;a++)o[a]=u[a]+i*(d.B3_1*g[a]+d.B3_2*e[a]+d.B3_3*t[a]);return o[S]=n.getInitialTime()+i*g[S],r.checkDiscontinuity(o,!0)},n.computeFinalRateAndCreateIntervalData=function(){var e=(n.getODE(),n.getInitialState()),t=n.getInitialRate(),r=n.getFinalState(),i=n.getFinalRate();return EJSS_ODE_INTERPOLATION.hermiteIntervalData(e,t,r,i)},n.computeApproximation=function(i){var o=n.getODE(),a=n.getTimeIndex(),s=n.getInitialState(),l=n.getInitialRate(),u=n.getFinalState(),g=n.getFinalRate();o.getRate(u,g);for(var c=EJSS_ODE_SOLVERS.BogackiShampine23,S=0;S<a;S++)r[S]=s[S]+i*(c.B2_1*l[S]+c.B2_2*e[S]+c.B2_3*t[S]+c.B2_4*g[S]);return r[a]=n.getInitialTime()+i*l[a],n.computeError(r)},n};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.CashKarp45={A_11:.2,A_21:.075,A_22:.225,A_31:.3,A_32:-.9,A_33:1.2,A_41:-11/54,A_42:2.5,A_43:-70/27,A_44:35/27,A_51:1631/55296,A_52:175/512,A_53:575/13824,A_54:44275/110592,A_55:253/4096,B4_1:2825/27648,B4_2:0,B4_3:18575/48384,B4_4:13525/55296,B4_5:277/14336,B4_6:.25,B5_1:37/378,B5_2:0,B5_3:250/621,B5_4:125/594,B5_5:0,B5_6:512/1771},EJSS_ODE_SOLVERS.cashKarp45=function(){var e,t,r,n,i,o,a=EJSS_ODE_SOLVERS.solverEngineDiscreteTimeAdaptive(5),s=a.allocateOtherArrays;return a.getNumberOfEvaluations=function(){return 6},a.allocateOtherArrays=function(){s(),e=new Array(a.getDimension()),t=new Array(a.getDimension()),r=new Array(a.getDimension()),n=new Array(a.getDimension()),i=new Array(a.getDimension()),o=new Array(a.getDimension())},a.computeIntermediateStep=function(o,s){var l,u=a.getODE(),g=a.getInitialState(),c=a.getInitialRate(),S=a.getDimension(),d=S-1,f=(c[d],EJSS_ODE_SOLVERS.CashKarp45);for(l=0;l<S;l++)s[l]=g[l]+o*f.A_11*c[l];for(u.getRate(s,e),l=0;l<S;l++)s[l]=g[l]+o*(f.A_21*c[l]+f.A_22*e[l]);for(u.getRate(s,t),l=0;l<S;l++)s[l]=g[l]+o*(f.A_31*c[l]+f.A_32*e[l]+f.A_33*t[l]);for(u.getRate(s,r),l=0;l<S;l++)s[l]=g[l]+o*(f.A_41*c[l]+f.A_42*e[l]+f.A_43*t[l]+f.A_44*r[l]);for(u.getRate(s,n),l=0;l<S;l++)s[l]=g[l]+o*(f.A_51*c[l]+f.A_52*e[l]+f.A_53*t[l]+f.A_54*r[l]+f.A_55*n[l]);for(u.getRate(s,i),l=0;l<d;l++)s[l]=g[l]+o*(f.B5_1*c[l]+f.B5_2*e[l]+f.B5_3*t[l]+f.B5_4*r[l]+f.B5_5*n[l]+f.B5_6*i[l]);s[d]=a.getInitialTime()+o*c[d]},a.computeCarefulIntermediateStep=function(o,s,l){var u,g=a.getODE(),c=a.getInitialState(),S=a.getInitialRate(),d=a.getDimension(),f=d-1,E=(S[f],EJSS_ODE_SOLVERS.CashKarp45),p=EJSS_ODE_SOLVERS.DISCONTINUITY_CODE;for(u=0;u<d;u++)l[u]=c[u]+s*E.A_11*S[u];switch(o.checkDiscontinuity(l,!1)){case p.DISCONTINUITY_PRODUCED_ERROR:return p.DISCONTINUITY_PRODUCED_ERROR;case p.DISCONTINUITY_JUST_PASSED:return p.DISCONTINUITY_JUST_PASSED;case p.DISCONTINUITY_ALONG_STEP:return p.DISCONTINUITY_ALONG_STEP;case p.DISCONTINUITY_EXACTLY_ON_STEP:case p.NO_DISCONTINUITY_ALONG_STEP:}for(g.getRate(l,e),u=0;u<d;u++)l[u]=c[u]+s*(E.A_21*S[u]+E.A_22*e[u]);switch(o.checkDiscontinuity(l,!1)){case p.DISCONTINUITY_PRODUCED_ERROR:return p.DISCONTINUITY_PRODUCED_ERROR;case p.DISCONTINUITY_JUST_PASSED:return p.DISCONTINUITY_CODE.DISCONTINUITY_JUST_PASSED;case p.DISCONTINUITY_ALONG_STEP:return p.DISCONTINUITY_ALONG_STEP;case p.DISCONTINUITY_EXACTLY_ON_STEP:case p.NO_DISCONTINUITY_ALONG_STEP:}for(g.getRate(l,t),u=0;u<d;u++)l[u]=c[u]+s*(E.A_31*S[u]+E.A_32*e[u]+E.A_33*t[u]);switch(o.checkDiscontinuity(l,!1)){case p.DISCONTINUITY_PRODUCED_ERROR:return p.DISCONTINUITY_PRODUCED_ERROR;case p.DISCONTINUITY_JUST_PASSED:return p.DISCONTINUITY_JUST_PASSED;case p.DISCONTINUITY_ALONG_STEP:return p.DISCONTINUITY_ALONG_STEP;case p.DISCONTINUITY_EXACTLY_ON_STEP:case p.NO_DISCONTINUITY_ALONG_STEP:}for(g.getRate(l,r),u=0;u<d;u++)l[u]=c[u]+s*(E.A_41*S[u]+E.A_42*e[u]+E.A_43*t[u]+E.A_44*r[u]);switch(o.checkDiscontinuity(l,!1)){case p.DISCONTINUITY_PRODUCED_ERROR:return p.DISCONTINUITY_PRODUCED_ERROR;case p.DISCONTINUITY_JUST_PASSED:return p.DISCONTINUITY_JUST_PASSED;case p.DISCONTINUITY_ALONG_STEP:return p.DISCONTINUITY_ALONG_STEP;case p.DISCONTINUITY_EXACTLY_ON_STEP:case p.NO_DISCONTINUITY_ALONG_STEP:}for(g.getRate(l,n),u=0;u<d;u++)l[u]=c[u]+s*(E.A_51*S[u]+E.A_52*e[u]+E.A_53*t[u]+E.A_54*r[u]+E.A_55*n[u]);switch(o.checkDiscontinuity(l,!1)){case p.DISCONTINUITY_PRODUCED_ERROR:return p.DISCONTINUITY_PRODUCED_ERROR;case p.DISCONTINUITY_JUST_PASSED:return p.DISCONTINUITY_JUST_PASSED;case p.DISCONTINUITY_ALONG_STEP:return p.DISCONTINUITY_ALONG_STEP;case p.DISCONTINUITY_EXACTLY_ON_STEP:case p.NO_DISCONTINUITY_ALONG_STEP:}for(g.getRate(l,i),u=0;u<f;u++)l[u]=c[u]+s*(E.B5_1*S[u]+E.B5_2*e[u]+E.B5_3*t[u]+E.B5_4*r[u]+E.B5_5*n[u]+E.B5_6*i[u]);return l[f]=a.getInitialTime()+s*S[f],o.checkDiscontinuity(l,!0)},a.computeFinalRateAndCreateIntervalData=function(){var e=a.getODE(),t=a.getInitialState(),r=a.getInitialRate(),n=a.getFinalState(),i=a.getFinalRate();return e.getRate(n,i),EJSS_ODE_INTERPOLATION.bootstrap2IntervalData(t,r,n,i,e)},a.computeApproximation=function(s){for(var l=a.getTimeIndex(),u=a.getInitialState(),g=a.getInitialRate(),c=EJSS_ODE_SOLVERS.CashKarp45,S=0;S<l;S++)o[S]=u[S]+s*(c.B4_1*g[S]+c.B4_2*e[S]+c.B4_3*t[S]+c.B4_4*r[S]+c.B4_5*n[S]+c.B4_6*i[S]);return o[l]=a.getInitialTime()+s*g[l],a.computeError(o)},a};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.Euler={},EJSS_ODE_SOLVERS.euler=function(){var e=EJSS_ODE_SOLVERS.solverEngineDiscreteTime();return e.getNumberOfEvaluations=function(){return 1},e.computeIntermediateStep=function(t,r){for(var n=e.getDimension(),i=e.getInitialState(),o=e.getInitialRate(),a=0;a<n;a++)r[a]=i[a]+t*o[a]},e.computeCarefulIntermediateStep=function(t,r,n){return e.computeIntermediateStep(r,n),t.checkDiscontinuity(n,!0)},e.computeFinalRateAndCreateIntervalData=function(){var t=e.getODE(),r=e.getInitialState(),n=e.getInitialRate(),i=e.getFinalState(),o=e.getFinalRate();return t.getRate(i,o),EJSS_ODE_INTERPOLATION.eulerIntervalData(r,n,i[e.getTimeIndex()])},e};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.Radau5={c1:(4-Math.sqrt(6))/10,c2:(4+Math.sqrt(6))/10,c1m1:(4-Math.sqrt(6))/10-1,c2m1:(4+Math.sqrt(6))/10-1,c1mc2:(4-Math.sqrt(6))/10-(4+Math.sqrt(6))/10};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.RungeKutta4={},EJSS_ODE_SOLVERS.rungeKutta4=function(){var e,t,r,n=EJSS_ODE_SOLVERS.solverEngineDiscreteTime();return n.getNumberOfEvaluations=function(){return 4},n.allocateOtherArrays=function(){e=new Array(n.getDimension()),t=new Array(n.getDimension()),r=new Array(n.getDimension())},n.computeIntermediateStep=function(i,o){var a,s=i/2,l=n.getODE(),u=n.getInitialState(),g=n.getInitialRate(),c=n.getDimension(),S=c-1,d=g[S];for(a=0;a<c;a++)o[a]=u[a]+s*g[a];for(l.getRate(o,e),a=0;a<c;a++)o[a]=u[a]+s*e[a];for(l.getRate(o,t),a=0;a<c;a++)o[a]=u[a]+i*t[a];for(l.getRate(o,r),a=0;a<S;a++)o[a]=u[a]+i*(g[a]+2*e[a]+2*t[a]+r[a])/6;o[S]=n.getInitialTime()+i*d},n.computeCarefulIntermediateStep=function(i,o,a){var s,l=o/2,u=n.getODE(),g=n.getInitialState(),c=n.getInitialRate(),S=n.getDimension(),d=S-1,f=c[d],E=EJSS_ODE_SOLVERS.DISCONTINUITY_CODE;for(s=0;s<S;s++)a[s]=g[s]+l*c[s];switch(i.checkDiscontinuity(a,!1)){case E.DISCONTINUITY_PRODUCED_ERROR:return E.DISCONTINUITY_PRODUCED_ERROR;case E.DISCONTINUITY_JUST_PASSED:return E.DISCONTINUITY_JUST_PASSED;case E.DISCONTINUITY_ALONG_STEP:return E.DISCONTINUITY_ALONG_STEP;case E.DISCONTINUITY_EXACTLY_ON_STEP:case E.NO_DISCONTINUITY_ALONG_STEP:}for(u.getRate(a,e),s=0;s<S;s++)a[s]=g[s]+l*e[s];switch(i.checkDiscontinuity(a,!1)){case E.DISCONTINUITY_PRODUCED_ERROR:return E.DISCONTINUITY_PRODUCED_ERROR;case E.DISCONTINUITY_JUST_PASSED:return E.DISCONTINUITY_JUST_PASSED;case E.DISCONTINUITY_ALONG_STEP:return E.DISCONTINUITY_ALONG_STEP;case E.DISCONTINUITY_EXACTLY_ON_STEP:case E.NO_DISCONTINUITY_ALONG_STEP:}for(u.getRate(a,t),s=0;s<S;s++)a[s]=g[s]+o*t[s];switch(i.checkDiscontinuity(a,!1)){case E.DISCONTINUITY_PRODUCED_ERROR:return E.DISCONTINUITY_PRODUCED_ERROR;case E.DISCONTINUITY_JUST_PASSED:return E.DISCONTINUITY_JUST_PASSED;case E.DISCONTINUITY_ALONG_STEP:return E.DISCONTINUITY_ALONG_STEP;case E.DISCONTINUITY_EXACTLY_ON_STEP:case E.NO_DISCONTINUITY_ALONG_STEP:}for(u.getRate(a,r),s=0;s<d;s++)a[s]=g[s]+o*(c[s]+2*e[s]+2*t[s]+r[s])/6;return a[d]=n.getInitialTime()+o*f,i.checkDiscontinuity(a,!0)},n.computeFinalRateAndCreateIntervalData=function(){var e=n.getODE(),t=n.getInitialState(),r=n.getInitialRate(),i=n.getFinalState(),o=n.getFinalRate();return e.getRate(i,o),EJSS_ODE_INTERPOLATION.bootstrapIntervalData(t,r,i,o,e)},n};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.SolverEngineDiscreteTime={},EJSS_ODE_SOLVERS.solverEngineDiscreteTime=function(){var e,t,r,n,i,o,a,s,l,u={},g=EJSS_ODE_SOLVERS.ERROR.NO_ERROR,c=0,S=.1,d=Number.POSITIVE_INFINITY,f=0,E=0;return u.getNumberOfEvaluations=function(){return 0},u.allocateOtherArrays=function(){},u.computeIntermediateStep=function(e,t){return null},u.computeCarefulIntermediateStep=function(e,t,r){return EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.NO_DISCONTINUITY_ALONG_STEP},u.computeFinalRateAndCreateIntervalData=function(){return null},u.getODE=function(){return a},u.getEventSolver=function(){return s},u.getDimension=function(){return e},u.getTimeIndex=function(){return t},u.getInitialTime=function(){return f},u.getInitialState=function(){return r},u.getInitialRate=function(){return n},u.getFinalState=function(){return i},u.getFinalRate=function(){return o},u.setFinalTime=function(e){E=e},u.getFinalTime=function(){return E},u.setErrorCode=function(e){g=e},u.addToEvaluations=function(e){c+=e},u.setODE=function(r,n){s=r,a=n;var i=a.getState();e=i.length,t=e-1,l=EJSS_ODE_INTERPOLATION.stateHistory(n),a.getMaximumDelay&&l.setMinimumLength(a.getMaximumDelay())},u.initialize=function(s){S=s;var g=a.getState();null!=r&&r.length==g.length||(e=g.length,t=e-1,r=new Array(e),n=new Array(e),i=new Array(e),o=new Array(e),u.allocateOtherArrays()),c=0,l.clearAll(),a.getMaximumDelay?l.setMinimumLength(Math.max(Math.abs(a.getMaximumDelay()),Math.abs(s))):l.setMinimumLength(s),u.reinitialize(g)},u.reinitialize=function(i){f=i[t];for(var o=0;o<e;o++)r[o]=i[o];a.getRate(r,n),E=Number.NaN,g=EJSS_ODE_SOLVERS.ERROR.NO_ERROR},u.getCurrentRate=function(){return n},u.setStepSize=function(e){S=e,a.getMaximumDelay?l.setMinimumLength(Math.max(Math.abs(a.getMaximumDelay()),Math.abs(e))):l.setMinimumLength(e)},u.setMaximumStepSize=function(e){d=Math.abs(e)},u.getMaximumStepSize=function(){return d},u.getStepSize=function(){return S},u.getInternalStepSize=function(){return E-f},u.setEstimateFirstStep=function(e){},u.setTolerances=function(e,t){},u.getMaximumTime=function(e){return g!=EJSS_ODE_SOLVERS.ERROR.NO_ERROR?Number.NaN:(isNaN(E)&&u.computeOneStep(e),E)},u.internalStep=function(t){var a;for(f=E,g=EJSS_ODE_SOLVERS.ERROR.NO_ERROR,a=0;a<e;a++)r[a]=i[a];for(a=0;a<e;a++)n[a]=o[a];return u.computeOneStep(t),E},u.getCounter=function(){return c},u.getStateHistory=function(){return l},u.interpolate=function(e,t){return l.interpolateState(e,t)},u.bestInterpolate=function(t,n){var o;if(isNaN(E))return null;if(t==E){for(o=0;o<e;o++)n[o]=i[o];return n}if(t==f){for(o=0;o<e;o++)n[o]=r[o];return n}return u.computeIntermediateStep(t-f,n),n},u.getActualStepSize=function(){return S},u.findTheDiscontinuity=function(e){for(var r=0,n=0,o=e,a=0,l=s.getDDEIterations(),g=s.getEPSILON();r<l&&!(Math.abs(n-o)<g);){var c=(n+o)/2;switch(u.computeCarefulIntermediateStep(s,c,i)){default:case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_PRODUCED_ERROR:return Number.NaN;case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.NO_DISCONTINUITY_ALONG_STEP:a=i[t],n=c;break;case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_EXACTLY_ON_STEP:return i[t];case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_JUST_PASSED:o-=(o-n)/4;break;case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_ALONG_STEP:o=c}r++}return u.computeCarefulIntermediateStep(s,a,i),a},u.computeOneStep=function(e){var r=S;if(e){switch(u.computeCarefulIntermediateStep(s,r,i)){case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_PRODUCED_ERROR:return void(E=Number.NaN);case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.NO_DISCONTINUITY_ALONG_STEP:case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_EXACTLY_ON_STEP:E=i[t];break;case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_JUST_PASSED:case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_ALONG_STEP:E=u.findTheDiscontinuity(r)}if(isNaN(E))return void(g=EJSS_ODE_SOLVERS.ERROR.DISCONTINUITY_PRODUCED_ERROR)}else u.computeIntermediateStep(r,i),E=i[t];c+=u.getNumberOfEvaluations(),l.clean(f),l.addIntervalData(u.computeFinalRateAndCreateIntervalData())},u};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.SolverEngineDiscreteTimeAdaptive={FAC1:.33,FAC2:6,BETA:0,SAFE:.9},EJSS_ODE_SOLVERS.solverEngineDiscreteTimeAdaptive=function(e){function t(e){var t=0;return 0!=e?(t=Math.pow(e,l),g=t/Math.exp(EJSS_ODE_SOLVERS.SolverEngineDiscreteTimeAdaptive.BETA*Math.log(u)),g=Math.max(1/EJSS_ODE_SOLVERS.SolverEngineDiscreteTimeAdaptive.FAC2,Math.min(1/EJSS_ODE_SOLVERS.SolverEngineDiscreteTimeAdaptive.FAC1,g/EJSS_ODE_SOLVERS.SolverEngineDiscreteTimeAdaptive.SAFE))):(t=1/EJSS_ODE_SOLVERS.SolverEngineDiscreteTimeAdaptive.FAC1,g=1/EJSS_ODE_SOLVERS.SolverEngineDiscreteTimeAdaptive.FAC2),e<=1?(u=Math.max(e,1e-4),i/g):i/Math.min(1/EJSS_ODE_SOLVERS.SolverEngineDiscreteTimeAdaptive.FAC1,t/EJSS_ODE_SOLVERS.SolverEngineDiscreteTimeAdaptive.SAFE)}function r(e){var t,r,n,i=s.getODE();if(e>=0){if(i.getDelays)for(t=i.getDelays(s.getInitialState()),n=t.length,r=0;r<n;r++)e=Math.min(e,t[r]/2);return Math.min(e,s.getMaximumStepSize())}if(i.getDelays)for(t=i.getDelays(s.getInitialState()),n=t.length,r=0;r<n;r++)e=Math.max(e,t[r]/2);return Math.max(e,-s.getMaximumStepSize())}function n(t){var r,n=s.getDimension(),i=s.getInitialState(),l=s.getInitialRate(),u=s.getODE(),g=t<0?-1:1;t=Math.abs(t);var c=0,S=0;for(r=0;r<n;r++){var d=o[r]+a[r]*Math.abs(i[r]),f=l[r]/d;c+=f*f,f=i[r]/d,S+=f*f}var E;if(E=c<=1e-10||S<=1e-10?1e-6:.01*Math.sqrt(S/c),E=g*Math.min(E,t),u.getDelays){var p=s.getEventSolver();p.resetDiscontinuities(i);for(var h=0,m=!1;!m;){for(r=0;r<n;r++)finalState[r]=i[r]+E*l[r];switch(p.checkDiscontinuity(finalState,!1)){case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_PRODUCED_ERROR:return Number.NaN;case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_JUST_PASSED:case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_ALONG_STEP:E/=2;break;case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_EXACTLY_ON_STEP:case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.NO_DISCONTINUITY_ALONG_STEP:m=!0}if(++h>100)return Number.NaN}}else for(r=0;r<n;r++)finalState[r]=i[r]+E*l[r];u.getRate(finalState,finalRate);var A=0;for(r=0;r<n;r++){var d=o[r]+a[r]*Math.abs(i[r]),f=(finalRate[r]-l[r])/d;A+=f*f}A=Math.sqrt(A)/E;var P,v=Math.max(Math.abs(A),Math.sqrt(c));return P=v<=1e-15?Math.max(1e-6,.001*Math.abs(E)):Math.exp(1/e*Math.log(.01/v)),E=g*Math.min(100*E,P),0!=t&&(E=g*Math.min(Math.abs(E),t)),E}var i,o,a,s=EJSS_ODE_SOLVERS.solverEngineDiscreteTime(),l=1/e-.75*EJSS_ODE_SOLVERS.SolverEngineDiscreteTimeAdaptive.BETA,u=1e-4,g=0,c=!1,S=Number.NaN,d=Number.NaN,f=s.reinitialize,E=s.setMaximumStepSize;return s.computeApproximation=function(e){},s.getAbsTol=function(){return o},s.getRelTol=function(){return a},s.allocateOtherArrays=function(){var e=s.getDimension();o=new Array(e),a=new Array(e),s.setTolerances(1e-6,1e-6)},s.reinitialize=function(e){f(e),i=r(c?n(s.getStepSize()):s.getStepSize())},s.setEstimateFirstStep=function(e){c=e},s.setMaximumStepSize=function(e){E(e),i=r(i)},s.setTolerances=function(e,t){var l,u=s.getDimension();if(e instanceof Array)for(S=d=Number.NaN,l=0;l<u;l++)o[l]=e[l],a[l]=t[l];else{if(S==e&&d==t)return;for(S=e,d=t,l=0;l<u;l++)o[l]=e,a[l]=t}mFinalTime=Number.NaN,mErrorCode=EJSS_ODE_SOLVERS.ERROR.NO_ERROR,i=r(c?n(s.getStepSize()):s.getStepSize())},s.computeOneStep=function(e){var n=s.getEventSolver(),o=s.getFinalState();mErrorCode=EJSS_ODE_SOLVERS.ERROR.NO_ERROR;for(var a=0;a<500;a++){if(e){switch(s.computeCarefulIntermediateStep(n,i,o)){case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_PRODUCED_ERROR:return void s.setFinalTime(Number.NaN);case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.NO_DISCONTINUITY_ALONG_STEP:case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_EXACTLY_ON_STEP:s.setFinalTime(o[s.getTimeIndex()]);break;case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_JUST_PASSED:case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_ALONG_STEP:var l=s.findTheDiscontinuity(i);s.setFinalTime(l),i=l-s.getInitialTime()}if(isNaN(s.getFinalTime()))return void s.setErrorCode(EJSS_ODE_SOLVERS.ERROR.DISCONTINUITY_PRODUCED_ERROR)}else s.computeIntermediateStep(i,o),s.setFinalTime(o[s.getTimeIndex()]);var u=s.computeApproximation(i);if(s.addToEvaluations(s.getNumberOfEvaluations()),u<=1)return s.getStateHistory().clean(s.getInitialTime()),s.getStateHistory().addIntervalData(s.computeFinalRateAndCreateIntervalData()),void(i=r(a>0?i>0?Math.min(i,t(u)):Math.max(i,t(u)):t(u)));i=r(i>0?Math.min(i,t(u)):Math.max(i,t(u)))}s.setFinalTime(Number.NaN),s.setErrorCode(EJSS_ODE_SOLVERS.ERROR.DID_NOT_CONVERGE)},s.getActualStepSize=function(){return i},s.computeError=function(e){for(var t=0,r=s.getDimension(),n=s.getInitialState(),i=s.getFinalState(),l=0;l<r;l++){var u=o[l]+a[l]*Math.max(Math.abs(i[l]),Math.abs(n[l])),g=(i[l]-e[l])/u;t+=g*g}return Math.sqrt(t/r)},s};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.DDEDiscontinuity={},EJSS_ODE_SOLVERS.ddeDiscontinuity=function(e,t){function r(r){var n,s=t.getDelays(r),l=s.length,u=o.length,g=r.length-1;if(e.getRunsForwards())for(n=0;n<l;n++)for(var c=r[g]-s[n]+i.getTolerance(),S=a[n];S<u;S++){var d=o[S];if(d>c){a[n]=S;break}}else for(n=0;n<l;n++)for(var c=r[g]-s[n]-i.getTolerance(),S=a[n];S<u;S++){var d=o[S];if(d<c){a[n]=S;break}}}function n(r){var n,o=r.length,a=o-1,l=i.getTolerance()/20,u=e.getDDEIterations(),g=e.getStateHistory(),c=0;if(e.getRunsForwards())for(;++c<u;){for(t.getRate(r,s),g.addIntervalData(EJSS_ODE_INTERPOLATION.eulerIntervalData(r,s,r[a]+l)),n=0;n<o;n++)r[n]+=l*s[n];var S=i.evaluate(r);if(S<0)return r[a]}else for(;++c<u;){for(t.getRate(r,s),g.addIntervalData(EJSS_ODE_INTERPOLATION.eulerIntervalData(r,s,r[a]-l)),n=0;n<o;n++)r[n]-=l*s[n];var S=evaluate(r);if(S>0)return r[a]}return Number.NaN}var i={},o=[],a=[],s=[];return i.initialize=function(r){e.getRunsForwards()?o.push(Number.NEGATIVE_INFINITY):o.push(Number.POSITIVE_INFINITY);var n=t.getInitialConditionDiscontinuities();if(null!=n)for(var l=n.length,u=0;u<l;u++)o.push(n[u]);o.push(r[r.length-1]);var g=t.getDelays(r);a=new Array(g.length),i.reset(r),s=new Array(r.length)},i.reset=function(e){for(var t=a.length,n=0;n<t;n++)a[n]=0;r(e)},i.evaluate=function(r){var n,i=r[r.length-1],s=t.getDelays(r),l=s.length;if(e.getRunsForwards()){var u=Number.POSITIVE_INFINITY;for(n=0;n<l;n++){var g=o[a[n]];u=Math.min(u,s[n]+g-i)}return u}var c=Number.NEGATIVE_INFINITY;for(n=0;n<l;n++){var g=o[a[n]];c=Math.max(c,s[n]+g-i)}return c},i.action=function(){var r=t.getState(),i=n(r);o.push(i);var a=e.findFirstEvent(r,i,r);return null!=a&&(mCurrentEventData=a,a.action()),!0},i.getTolerance=function(){return e.getDDETolerance()},i};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.ProblemData={POSITIVE:2,SMALL_POSITIVE:1,ZERO:0,SMALL_NEGATIVE:-1,NEGATIVE:-2},EJSS_ODE_SOLVERS.eventData=function(e,t,r){var n,i,o,a,s,l,u,g,c={},S=t.getTypeOfEvent(),d=r.length-1;return c.getEvent=function(){return t},c.getEventType=function(){return S},c.setH=function(e){l=e},c.getH=function(){return l},c.getTime=function(){return u},c.setTime=function(e){u=e},c.hasPositiveFlag=function(){return n},c.hasNegativeFlag=function(){return i},c.getHBefore=function(){return a},c.setHAfter=function(e){s=e},c.getHAfter=function(){return s},c.getCurrentPosition=function(){return o},c.getMaxAdvance=function(){return g},c.setMaxAdvance=function(e){g=e},c.action=function(){return t.action()},c.getProblem=function(){return t},c.reset=function(r){n=!1,i=!1;var o=t.evaluate(r);c.findPosition(r[d],o),e.getCurrentEventData()!=c&&(S==EJSS_ODE_SOLVERS.EVENT_TYPE.CROSSING_EVENT?o>0?n=!0:o<0&&(i=!0):S==EJSS_ODE_SOLVERS.EVENT_TYPE.POSITIVE_EVENT&&o>0&&(n=!0))},c.findPosition=function(r,s){if(a=s,a>=t.getTolerance()?(o=EJSS_ODE_SOLVERS.ProblemData.POSITIVE,n=!0):a>0?o=EJSS_ODE_SOLVERS.ProblemData.SMALL_POSITIVE:0==a?o=EJSS_ODE_SOLVERS.ProblemData.ZERO:a>-t.getTolerance()?o=EJSS_ODE_SOLVERS.ProblemData.SMALL_NEGATIVE:(o=EJSS_ODE_SOLVERS.ProblemData.NEGATIVE,i=!0),S==EJSS_ODE_SOLVERS.EVENT_TYPE.STATE_EVENT&&o==EJSS_ODE_SOLVERS.ProblemData.NEGATIVE){var l="The state event "+t+" is in an illegal state: "+a+" at "+r;null==e.getLastEventData()?l+="\nThere was no previous event":l+="\nLast previous event was "+e.getLastEventData().getProblem()+", which took place at "+e.getLastEventDataTime(),e.error(EJSS_ODE_SOLVERS.ERROR.ILLEGAL_EVENT_STATE,l)}},c.reset(r),c},EJSS_ODE_SOLVERS.discontinuityData=function(e,t,r){var n,i,o,a,s,l,u={},g=r.length-1;return u.getDiscontinuity=function(){return t},u.setH=function(e){s=e},u.getH=function(){return s},u.setTime=function(e){l=e},u.getTime=function(){return l},u.hasPositiveFlag=function(){return n},u.hasNegativeFlag=function(){return i},u.getHBefore=function(){return a},u.setHAfter=function(e){mHAfter=e},u.getHAfter=function(){return mHAfter},u.getCurrentPosition=function(){return o},u.getMaxAdvance=function(){return Number.NaN},u.action=function(){return t.action()},u.getProblem=function(){return t},u.reset=function(r){n=!1,i=!1;var o=t.evaluate(r);u.findPosition(r[g],o),e.getCurrentEventData()!=u&&(o>0?n=!0:o<0&&(i=!0))},u.findPosition=function(e,r){a=r,a>=t.getTolerance()?(o=EJSS_ODE_SOLVERS.ProblemData.POSITIVE,n=!0):a>0?o=EJSS_ODE_SOLVERS.ProblemData.SMALL_POSITIVE:0==a?o=EJSS_ODE_SOLVERS.ProblemData.ZERO:a>-t.getTolerance()?o=EJSS_ODE_SOLVERS.ProblemData.SMALL_NEGATIVE:(o=EJSS_ODE_SOLVERS.ProblemData.NEGATIVE,i=!0)},u.reset(r),u};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.ODEMultistepSolver={NO_ERROR:0,DID_NOT_CONVERGE:1},EJSS_ODE_SOLVERS.createODEMultistepSolver=function(e){function t(){var e=g.getTolerance(),t=l;(g.getStepSize()<=0||g.getStepSize()>l||l-g.getStepSize()==l)&&g.setStepSize(l);for(var r=0;t>e*l;){r++;var n=t;if(t<g.getStepSize()){var u=g.getStepSize();g.setStepSize(t);t-=g.step(),g.setStepSize(u)}else t-=g.step();if(g.getErrorCode()!=EJSS_ODE_SOLVERS.ODEMultistepSolver.NO_ERROR||Math.abs(n-t)<=Number.MIN_VALUE||e*l/10>g.getStepSize()||r>o){if(s="ODEMultiStep did not converge. Remainder="+t,i=EJSS_ODE_SOLVERS.ODEMultistepSolver.DID_NOT_CONVERGE,a)throw s;mMaxMessages>0&&(mMaxMessages--,console.log(s));break}}return t}function r(){var e=g.getTolerance(),t=l;(g.getStepSize()>=0||g.getStepSize()<l||l-g.getStepSize()==l)&&g.setStepSize(l);for(var r=0;t<e*l;){r++;var n=t;if(t>g.getStepSize()){var a=g.getStepSize();g.setStepSize(t);t-=g.step(),g.setStepSize(a)}else t-=g.step();if(g.getErrorCode()!=EJSS_ODE_SOLVERS.ODEMultistepSolver.NO_ERROR||Math.abs(n-t)<=Number.MIN_VALUE||e*l/10<g.getStepSize()||r>o){if(s="ODEMultiStep did not converge. Remainder="+t,i=EJSS_ODE_SOLVERS.ODEMultistepSolver.DID_NOT_CONVERGE,enableExceptions)throw s;mMaxMessages>0&&(mMaxMessages--,console.log(s))}}return t}var n={},i=EJSS_ODE_SOLVERS.ODEMultistepSolver.NO_ERROR,o=200,a=!1,s="",l=.1,u=EJSS_ODE_SOLVERS.createODEMultistepSolverInternalODE(e),g=EJSS_ODE_SOLVERS.createCashKarp45(u);return n.enableRuntimeExceptions=function(e){a=e},n.setMaxIterations=function(e){o=Math.max(1,e)},n.setTolerance=function(e){e=Math.abs(e),g.setTolerance(e)},n.getTolerance=function(){return g.getTolerance()},n.getErrorCode=function(){return i},n.initialize=function(e){mMaxMessages=4,s="",i=EJSS_ODE_SOLVERS.ODEMultistepSolver.NO_ERROR,l=e,u.setInitialConditions(),g.initialize(e)},n.setStepSize=function(e){mMaxMessages=4,l=e,e<0?g.setStepSize(Math.max(-Math.abs(g.getStepSize()),e)):g.setStepSize(Math.min(g.getStepSize(),e))},n.setMaximumNumberOfErrorMessages=function(e){mMaxMessages=e},n.getStepSize=function(){return l},n.step=function(){i=EJSS_ODE_SOLVERS.ODEMultistepSolver.NO_ERROR,u.setInitialConditions();var e=0;return e=l>0?t():r(),u.update(),l-e},n},EJSS_ODE_SOLVERS.createODEMultistepSolverInternalODE=function(e){var t={},r=[];return t.getRate=function(t,r){e.getRate(t,r)},t.getState=function(){return r},t.setInitialConditions=function(){var t=e.getState();if(null!=t){null!=r&&r.length==t.length||(r=new Array(t.length));for(var n=0,i=t.length;n<i;n++)r[n]=t[n]}},t.update=function(){for(var t=e.getState(),n=0,i=t.length;n<i;n++)t[n]=r[n]},t.setInitialConditions(),t},EJSS_ODE_SOLVERS.createCashKarp45=function(e){var t,r={},n=[[.2],[.075,.225],[.3,-.9,1.2],[-11/54,2.5,-70/27,35/27],[1631/55296,175/512,575/13824,44275/110592,253/4096]],i=[37/378,0,250/621,125/594,0,512/1771],o=[277/64512,0,-6925/370944,6925/202752,277/14336,-277/7084],a=EJSS_ODE_SOLVERS.ODEMultistepSolver.NO_ERROR,s=.01,l=0,u=[],g=[],c=1e-6,S=!1;return r.enableRuntimeExpecptions=function(e){S=e},r.setStepSize=function(e){s=e},r.getStepSize=function(){return s},r.setTolerance=function(e){if((c=Math.abs(e))<1e-12){var t="Error: Cash-Karp ODE solver tolerance cannot be smaller than 1.0e-12.";if(S)throw t;console.log(t),c=1e-12}},r.getTolerance=function(){return c},r.getErrorCode=function(){return a},r.initialize=function(t){s=t;var r=e.getState();if(null!=r&&l!=r.length){l=r.length,u=new Array(l),g=new Array(6);for(var n=0;n<6;n++)g[n]=new Array(l)}},r.step=function(){var r,d,f,E=10,p=s,h=0,m=e.getState();a=EJSS_ODE_SOLVERS.ODEMultistepSolver.NO_ERROR,e.getRate(m,g[0]);do{for(E--,p=s,f=1;f<6;f++){for(r=0;r<l;r++)for(u[r]=m[r],d=0;d<f;d++)u[r]=u[r]+s*n[f-1][d]*g[d][r];e.getRate(u,g[f])}for(h=0,r=0;r<l;r++){for(t=0,f=0;f<6;f++)t+=s*o[f]*g[f][r];h=Math.max(h,Math.abs(t))}if(h<=Number.MIN_VALUE&&(h=c/1e5),h>c){var A=.9*Math.pow(h/c,-.25);s*=Math.max(A,.1)}else if(h<c/10){var A=.9*Math.pow(h/c,-.2);A>1&&(s*=Math.min(A,10))}}while(h>c&&E>0);for(r=0;r<l;r++)for(f=0;f<6;f++)m[r]+=p*i[f]*g[f][r];if(0==E&&(a=EJSS_ODE_SOLVERS.ODEMultistepSolver.DID_NOT_CONVERGE,S))throw"DormanPrince45 ODE solver did not converge.";return p},r.initialize(s),r};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.createEulerODESolver=function(e){var t,r=EJSS_ODE_SOLVERS.createSolverInterpolatorDiscreteTime(e),n=r.initialize;return r.initialize=function(e){n(e),t=new Array(r.getDimension())},r.computeIntermediateStep=function(r,n){e.getRate(n,t);for(var i=0,o=n.length;i<o;i++)n[i]=n[i]+r*t[i];return n},r};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.createRungeKutta4ODESolver=function(e){var t,r,n,i,o,a=EJSS_ODE_SOLVERS.createSolverInterpolatorDiscreteTime(e),s=a.initialize;return a.initialize=function(e){s(e),t=new Array(a.getDimension()),r=new Array(a.getDimension()),n=new Array(a.getDimension()),i=new Array(a.getDimension()),o=new Array(a.getDimension())},a.computeIntermediateStep=function(a,s){e.getRate(s,r);for(var l=0,u=s.length;l<u;l++)t[l]=s[l],s[l]=t[l]+a*r[l]/2;e.getRate(s,n);for(var l=0,u=s.length;l<u;l++)s[l]=t[l]+a*n[l]/2;e.getRate(s,i)
;for(var l=0,u=s.length;l<u;l++)s[l]=t[l]+a*i[l];e.getRate(s,o);for(var l=0,u=s.length;l<u;l++)s[l]=t[l]+a*(r[l]+2*n[l]+2*i[l]+o[l])/6;return s},a};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.SolverInterpolatorDiscreteTime={},EJSS_ODE_SOLVERS.createSolverInterpolatorDiscreteTime=function(e){var t,r={},n=.1,i=(Number.POSITIVE_INFINITY,0);return r.getNumberOfEvaluations=function(){return 0},r.allocateOtherArrays=function(){},r.computeIntermediateStep=function(e,t){return null},r.computeCarefulIntermediateStep=function(e,t,r){return 0},r.setTolerance=function(e){i=Math.abs(e)},r.getDimension=function(){return t},r.initialize=function(r){n=r;var i=e.getState();t=i.length},r.step=function(){var t=e.getState();return r.computeIntermediateStep(n,t),0},r.setStepSize=function(e){n=e},r.getStepSize=function(){return n},r};var EJSS_CORE=EJSS_CORE||{};EJSS_CORE.createRemoteView=function(e,t,r,n){function i(e,t){if(c){void 0!==t?l.send(e+JSON.stringify(t)):l.send(e);var r=l.onmessage;l.onmessage=null,l.onmessage=r}}function o(e){console.log(" --\x3e Processing input: "+e);var t,r={};if("{"==e.charAt(0)){t=JSON.parse(e);var n="";if(t.hasOwnProperty("method")&&(n=t.method,"reset"==n?g._reset():"initialize"==n?g._initialize():void 0!=u&&(r=u.extract(e),d=r,s(g._update))),t.hasOwnProperty("apiVersion")){console.log("Metadata Obtained"),u=new wrapper(l,e);for(var i in f)u.get(f[i],!0)}}else a(e)}function a(e){var t;switch(e.charAt(0)){case"R":g._reset();break;case"I":g._initialize();break;case"U":d=JSON.parse(e.substring(1)),s(g._update);break;case"C":d=JSON.parse(e.substring(1)),s(g._collectData);break;case"M":t=JSON.parse(e.substring(1)),g[t.method]?g[t.method](t.data):console.log("View function: <"+t.method+"> with data: <"+t.data+"> ignored. View function does not exist.");break;case"P":t=JSON.parse(e.substring(1)),g[t.element]?g[t.element].setProperty(t.property,t.value):console.log("setProperty<"+t.property+"> with value: <"+t.value+"> to element <"+t.element+"> ignored. Element does not exist!");break;case"E":t=JSON.parse(e.substring(1)),g[t.element]?g[t.element][t.method](t.data):console.log("Message <"+t.method+"> to element <"+t.element+"> ignored. Element does not exist!");break;case"F":t=JSON.parse(e.substring(1)),g[t.element]?g[t.element][t.method](t.data):console.log("Message with object <"+t.method+"> to element <"+t.element+"> ignored. Element does not exist!");break;case"D":t=JSON.parse(e.substring(1)),m=t.variables,A=t.methods;break;default:console.log("Not known message: Ignoring")}}function s(e){e(),g._render()}var l,u,g=EJSS_CORE.createView(e),c=!1,S=0,d={},f=[],E=[],p=[],h=[],m=[],A=[],P="",v=!0,y=0,C="";if(g._23=function(){return"ConnectionWS"},g._connectToServer=function(){try{l=new WebSocket(C),console.log("Connecting... (readyState "+l.readyState+")"),l.onopen=function(e){c=!0,S=0,console.log("Openhd Event: "+e.type+" - Message: "+e.data),i("",{method:"getMetadata"})},l.onclose=function(e){S<10&&(window.setTimeout(function(){g._connectToServer()},500),S++),c=!1,console.log("Closehd Event: "+e.type+" - Message: "+e.data+" - Reopen: "+S)},l.onerror=function(e){c=!1,console.log("Errorhd Event: "+e.type+" - Message: "+e.data)},l.onmessage=function(e){o(e.data)}}catch(e){console.log(e)}g._update(),g._render()},g._getValue=function(e){return c?d[e]:g._10(e)},super_registerVariable=g._5,super_registerAction=g._7,super_startUp=g._11,g._11=function(){super_startUp(),g._connectToServer()},g._5=function(e,t,r){super_registerVariable(e,t),r?g._13(e,function(){return g._getValue(e)},null,t):(f.push(e),g._13(e,function(){return g._getValue(e)},function(t){p.push({name:e,value:t})},t))},g._7=function(e){super_registerAction(e),E.push(e),g._setAction(e,function(t){h.push({name:e,argument:t})})},g._18=function(){g._16();var e={},t={};if(p.length>0){for(var r in p)p[r].hasOwnProperty("name")&&(e[r]=p[r].name),t[r]=p[r].value;u.set(e,t,"")}if(h.length>0)for(var n in h)u.callAction(h[n].name,[h[n].argument]);p=[],h=[]},g._17=function(){return h.length},g.getLinkingURL=function(){return P},g.createLinkingButtons=function(){g._9(EJSS_INTERFACE.button,"_linkingButton_").setAction("OnClick",function(){var e=g.getLinkingURL();window.alert(e.toString())}).setProperties({Text:"@",FontSize:"8px"}),g._9(EJSS_INTERFACE.button,"_qrButton_").setAction("OnClick",function(){var e=encodeURIComponent(g.getLinkingURL()),t="https://chart.googleapis.com/chart?cht=qr&chl="+e+"&chs=400";window.open(t,"_blank")}).setProperties({Text:"QR",FontSize:"8px"})},g.hiddenLinkingButtons=function(){_view._linkingButton_.setVisibility("hidden"),_view._qrButton_.setVisibility("hidden")},g.showLinkingButtons=function(){_view._linkingButton_.setVisibility("visible"),_view._qrButton_.setVisibility("visible")},-1!=window.location.protocol.indexOf("file"))void 0!==t&&null!==t&&0!=t||(t=8800),C="ws://localhost:"+t,v=!1;else{if(history.state&&(y=history.state.mServerModelPort,v=!1),void 0===r||null===r||""==r){var D=window.location.host,I=window.location.protocol;r=I+"//"+D+"/ejsS_library/models"}if(void 0===n||null===n||""==n){var R=window.location.href.lastIndexOf("/_view");n=window.location.href.slice(r.length,R)}var _=new XMLHttpRequest;y>0?_.open("GET",r+"/broker.php?model="+n+"&port="+y,!0):_.open("GET",r+"/broker.php?model="+n,!0),_.onreadystatechange=function(){if(4==_.readyState&&200==_.status){var e=JSON.parse(_.responseText);C=e.webserver,P=r+"/linking.php?model="+n+"&port="+e.port,v&&g.createLinkingButtons(),g._11()}else console.log("WARNING: server no response!")},_.send()}return g};var EJSS_TOOLS=EJSS_TOOLS||{};EJSS_TOOLS.addToArray=function(e,t,r){EJSS_TOOLS.removeFromArray(e,t),r>=0?e.splice(r,0,t):e.push(t)},EJSS_TOOLS.arrayObjectIndexOf=function(e,t){return e.indexOf(t)},EJSS_TOOLS.removeFromArray=function(e,t){var r=e.indexOf(t);r>=0&&e.splice(r,1)},EJSS_TOOLS.compareArrays=function(e,t){if(!e||!t)return!1;if(!e instanceof Array||!t instanceof Array)return e==t;if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]instanceof Array&&t[r]instanceof Array){if(!EJSS_TOOLS.compareArrays(e[r],t[r]))return!1}else if(e[r]!=t[r])return!1;return!0};var EJSS_TOOLS=EJSS_TOOLS||{};EJSS_TOOLS.ConnectionWS={},EJSS_TOOLS.connectionWS=function(e){function t(e,t){switch(e){case"onopen":a.onopen=function(e){t(e)};break;case"onmessage":a.onmessage=function(e){t(e)};break;case"onclose":a.onclose=function(e){t(e)};break;case"onerror":a.onerror=function(e){t(e)}}}function r(e){var t=e.data.split(" ");u[t[0]]=e.data.substring(t[0].length+1)}function n(e){s=!0,console.log("Openhd Event: "+e.type+" - Message: "+e.data)}function i(e){s=!1,console.log("Closehd Event: "+e.type+" - Message: "+e.data)}function o(e){s=!1,console.log("Errorhd Event: "+e.type+" - Message: "+e.data)}var a,s,l={},u={};return l._23=function(){return"ConnectionWS"},l.get=function(e){var t=u[e];if(void 0!==t||null==t)return t},l.set=function(e,t){if(console.log("set:"+e+":"+t.toString()),console.log("set:is open="+s),s){var r=e+" "+t.toString();a.send(r),l.reset()}},l.reset=function(){var e=a.onmessage;a.onmessage=null,a.onmessage=e},function(){try{a=new WebSocket(e),console.log("Connecting... (readyState "+a.readyState+")")}catch(e){console.log(e)}}(),t("onopen",n),t("onclose",i),t("onerror",o),t("onmessage",r),l};var EJSS_TOOLS=EJSS_TOOLS||{};EJSS_TOOLS.Decode={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",hex_to_ascii:function(e){for(var t=e.toString(),r="",n=0;n<t.length;n+=2)r+=String.fromCharCode(parseInt(t.substr(n,2),16));return r},decode:function(e){e=""+e;var t,r,n,i,o,a,s,l="",u=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<e.length;)i=this._keyStr.indexOf(e.charAt(u++)),o=this._keyStr.indexOf(e.charAt(u++)),a=this._keyStr.indexOf(e.charAt(u++)),s=this._keyStr.indexOf(e.charAt(u++)),t=i<<2|o>>4,r=(15&o)<<4|a>>2,n=(3&a)<<6|s,l+=String.fromCharCode(t),64!=a&&(l+=String.fromCharCode(r)),64!=s&&(l+=String.fromCharCode(n));return l=EJSS_TOOLS.Decode._utf8_decode(l)},_utf8_decode:function(e){for(var t="",r=0,n=c1=c2=0;r<e.length;)n=e.charCodeAt(r),n<128?(t+=String.fromCharCode(n),r++):n>191&&n<224?(c2=e.charCodeAt(r+1),t+=String.fromCharCode((31&n)<<6|63&c2),r+=2):(c2=e.charCodeAt(r+1),c3=e.charCodeAt(r+2),t+=String.fromCharCode((15&n)<<12|(63&c2)<<6|63&c3),r+=3);return t}};var EJSS_TOOLS=EJSS_TOOLS||{};EJSS_TOOLS.DisplayColors={phaseColors:{},lineColors:["rgb(255,0,0)","rgb(0,240,0)","rgb(0,0,255)","rgb(240,240,0)","rgb(0,240,240)","rgb(255,0,255)"],markerColors:["rgb(255,0,0)","rgb(0,240,0)","rgb(0,0,255)","rgb(240,240,0)","rgb(0,240,240)","rgb(255,0,255)"],arrayColors:{black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,160],darkcyan:[0,240,240],darkgray:[64,64,64],darkgreen:[0,240,0],darkgrey:[64,64,64],darkyellow:[240,240,0],gray:[125,125,125],green:[0,255,0],grey:[125,125,125],lightblue:[173,216,230],lightgray:[192,192,192],lightgrey:[192,192,192],magenta:[255,0,255],maroon:[128,0,0],olive:[128,128,0],orange:[255,165,0],pink:[255,175,175],purple:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]},getLineColor:function(e){var t=EJSS_TOOLS.DisplayColors.lineColors[e];if(void 0===t){t="hsl("+360*e/12%360+",100%,50%)",EJSS_TOOLS.DisplayColors.lineColors[e]=t}return t},getMarkerColor:function(e){var t=EJSS_TOOLS.DisplayColors.markerColors[e];if(void 0===t){t="hsl("+360*e/12%360+",100%,100%)",EJSS_TOOLS.DisplayColors.markerColors[e]=t}return t},getArrayColor:function(e){if(e=e.toLowerCase(),0==e.indexOf("rgb"))var t=e.substring(4,e.length-1).replace(/ /g,"").split(",");else if(0==e.indexOf("#")){e=e.slice(1),e=e.toUpperCase();for(var r,n,i="0123456789ABCDEF",t=new Array(3),o=0,a=0;a<6;a+=2)r=i.indexOf(e.charAt(a)),n=i.indexOf(e.charAt(a+1)),t[o]=16*r+n,o++}else{var t=EJSS_TOOLS.DisplayColors.arrayColors[e];void 0===t&&(t=EJSS_TOOLS.DisplayColors.arrayColors.black)}return[t[0]/255,t[1]/255,t[2]/255]}};var EJSS_TOOLS=EJSS_TOOLS||{};EJSS_TOOLS.Worker=function(){function e(e,t){if(e){var r=new XMLHttpRequest;r.open("GET",e),r.onreadystatechange=function(){4==r.readyState&&200==r.status?t(r.responseText):console.log("Warning: impossible to read "+e)},r.send()}else t("")}var t={};if("undefined"==typeof Worker)return t;if(!window.Worker)return t;if(!window.URL)return t;if(window.navigator.userAgent.indexOf("MSIE ")>0||window.navigator.userAgent.indexOf("Trident")>0)return t;t.dummy=function(e){var e=e.data.params;t.postMessage({result:"dummy"})};var r=new Blob(['onmessage=function (oEvent) { \t\tpostMessage({ \t\t\t"id": oEvent.data.id, \t\t\t"evaluated": eval(oEvent.data.code) \t\t}); \t}   '],{type:"text/javascript"}),n=window.URL.createObjectURL(r),i=[],o=new Worker(n);o.onmessage=function(e){i[e.data.id]&&i[e.data.id](e.data.evaluated),delete i[e.data.id]},t.runCode=function(e,t){i.push(t||null),o.postMessage({id:i.length-1,code:e})};var a={};return t.runFunction=function(t,r,n,i,o){if("function"==typeof r)if(void 0===a[t])e(o,function(e){var o=e;o+=";onmessage="+r.toString();var s=new Blob([o],{type:"text/javascript"}),l=window.URL.createObjectURL(s);a[t]=l;var u=new Worker(l);u.postMessage({id:t,params:n}),u.onmessage=function(e){i&&i(e.data)}});else{var s=a[t],l=new Worker(s);l.postMessage({id:t,params:n})}},t.runMultipleFunction=function(t,r,n,i,o,s){if("function"==typeof n&&i instanceof Array&&i.length>=r)if(void 0===a[t])e(s,function(e){var s=e;s+=";onmessage="+n.toString();var l=new Blob([s],{type:"text/javascript"}),u=window.URL.createObjectURL(l);a[t]=u;for(var g=0;g<r;g++){var c=new Worker(u),e=[];c.onmessage=function(t){e.push(t.data),e.length==r&&o&&o(e)},c.postMessage({id:t,params:i[g]})}});else for(var l=a[t],u=0;u<r;u++){var g=new Worker(l),c=[];g.onmessage=function(e){c.push(e.data),c.length==r&&o&&o(c)},g.postMessage({id:t,params:i[u]})}},t}();var EJSS_TOOLS=EJSS_TOOLS||{};EJSS_TOOLS.enumeration=function(e){var t=function(){throw"Can't Instantiate Enumerations"},r=t.prototype={constructor:t,toString:function(){return this.name},valueOf:function(){return this.value},toJSON:function(){return this.name}};t.values=[];for(var n in e){var i=inherit(r);i.name=n,i.value=e[n],t[n]=i,t.values.push(i)}return t.foreach=function(e,t){for(var r=0;r<this.values.length;r++)e.call(t,this.values[r])},t};var EJSS_TOOLS=EJSS_TOOLS||{};EJSS_TOOLS.File={JSLoaded:"",loadJSfile:function(e,t){if(-1!=EJSS_TOOLS.File.JSLoaded.indexOf("["+e+"]"))return console.log("File already loaded "+e),void t();EJSS_TOOLS.File.JSLoaded+="["+e+"]";var r=document.createElement("script");r.setAttribute("type","text/javascript"),r.setAttribute("src",e),void 0!==t&&(r.onload=t),document.getElementsByTagName("head")[0].appendChild(r)},plainName:function(e){var t=e.lastIndexOf("/");return t>=0&&(e=e.substring(t+1)),t=e.indexOf("."),t>0&&(e=e.substring(0,t)),e},download:function(e,t){var r=document.createElement("a");r.setAttribute("href","data:application/ejss;charset=utf-8,"+encodeURIComponent(t)),r.setAttribute("download",e),r.click()},loadScript:function(e){var t=document.createElement("script");t.type="text/javascript",t.src=e,document.getElementsByTagName("head")[0].appendChild(t)},loadJSONFile:function(e,t){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState&&200==r.status){var e=JSON.parse(r.responseText);t(e)}},r.open("GET",e,!0),r.send()},requestShortUrl:function(e,t){var r=escape("http://urlecho.appspot.com/echo?status=200&Content-Type=text/plain&body="+e);if(EJSS_TOOLS.File.CALLBACK=t,EJSS_TOOLS.File.callFunction=function(e){EJSS_TOOLS.File.CALLBACK(e.shortUrl)},null==document.getElementById("__rtShortUrl")){var n=document.createElement("script");n.type="text/javascript",n.id="__rtShortUrl",n.innerHTML="function rtShortUrl(data) { EJSS_TOOLS.File.callFunction(data); }",document.getElementsByTagName("head")[0].appendChild(n)}var i=document.getElementById("_requestShortUrl");null!=i&&document.getElementsByTagName("head")[0].removeChild(i),i=document.createElement("script"),i.id="_requestShortUrl",i.type="text/javascript",i.src="http://b1t.co/Site/api/External/MakeUrlWithGet?callback=rtShortUrl&url="+r,document.getElementsByTagName("head")[0].appendChild(i)}};var EJSS_TOOLS=EJSS_TOOLS||{};EJSS_TOOLS.JsonrpcBuilder={template:{METHOD:"${METHOD}",PARAMS:"${PARAMS}",ID:"${ID}",REQUEST:'{jsonrpc: "2.0", method: ${METHOD}, params: ${PARAMS}, id: ${ID}}',RESPONSE_OK:'{jsonrpc: "2.0", result: ${RESULT}, params: ${PARAMS}, id: ${ID}}',RESPONSE_ERROR:'{jsonrpc: "2.0", method: ${METHOD}, params: ${PARAMS}, id: ${ID}}',ERROR:'{code: "2.0", message: ${MESSAGE}, data: ${DATA}}'},request:function(e,t,r){if(t&&!(t instanceof Array))throw new InvalidParamsException;var n={jsonrpc:"2.0",method:e};return t&&(n.params=t),r&&(n.id=r),n},response:function(e,t){return{jsonrpc:"2.0",result:e,id:t}},responseWithError:function(e,t){return{jsonrpc:"2.0",error:e,id:t}},error:function(e,t,r){return{code:e,message:t,data:r}},parseResponse:function(e){var t=null;try{t=JSON.parse(e)}catch(e){console.log(e)}return null!=t?t.result:null}};var EJSS_TOOLS=EJSS_TOOLS||{};EJSS_TOOLS.JsonrpcClient={methods:{connect:"connect",open:"open",getMetadata:"getMetadata",getValue:"getValue",setValue:"setValue",close:"close",disconnect:"disconnect"}},EJSS_TOOLS.jsonrpcClient=function(e,t){function r(e){for(var t="",r="abcdefghijklmnopqrstuvwxyz",n=0;n<e;n++)t+=r.charAt(Math.floor(Math.random()*r.length));return t}function n(e,t,n,i){var a=i||r(12);n&&(d[a]=n);var s=S.request(e,t,a);o.send(JSON.stringify(s))}function i(){o.onopen=function(e){a&&a(e),console.log("Openhd Event: "+e.type+" - Message: "+e.data)},o.onmessage=function(e){var t=JSON.parse(e.data);u&&u(d),t.id&&d[t.id]&&d[t.id](t.result)},o.onclose=function(e){s&&s(message),console.log("Closehd Event: "+message.type+" - Message: "+message.data)},o.onerror=function(e){l&&l(e),console.log("Errorhd Event: "+e.type+" - Message: "+e.data)}}var o,a,s,l,u,g={},c=EJSS_TOOLS.JsonrpcClient,S=EJSS_TOOLS.JsonrpcBuilder,d={};return g.connect=function(e){return n(c.methods.connect,null,e)},g.open=function(e){return n(c.methods.open,null,e)},g.getValue=function(e,t){return n(c.methods.getValue,[e],t)},g.setValue=function(e,t){return n(c.methods.setValue,e,t)},g.getMetadata=function(e){return n(c.methods.getMetadata,null,e)},g.disconnect=function(e){return n(c.methods.disconnect,null,e)},g.close=function(e){return n(c.methods.close,null,e)},g.init=function(r,n,g,c){try{a=r,l=g,s=c,u=n;var S="ws://"+e;t&&(S+=":"+t),o=new WebSocket(S),i(),console.log("Connecting... (readyState "+o.readyState+")")}catch(e){console.log(e)}},g.finish=function(){try{o.close()}catch(e){console.log(e)}},g};var EJSS_TOOLS=EJSS_TOOLS||{};EJSS_TOOLS.Mathematics={TWO_PI:6.2831852,TO_RADIANS:Math.PI/180,LOG10SCALE:1/Math.log(10),cosineAndSine:[],cosineAndSineForDegrees:function(e){(e%=360)<0&&(e+=360);var t=this.cosineAndSine[e];if(void 0===t){var r=e*this.TO_RADIANS;t=[Math.cos(r),Math.sin(r)]}return t},radians:function(e){return e*Math.PI/180},degrees:function(e){var t=180*e/Math.PI,r=t%360;return t=360*r<0?r+360:r},norm:function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r]*e[r];return Math.sqrt(t)},crossProduct:function(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]},normalize:function(e){var t=EJSS_TOOLS.Mathematics.norm(e);return 0==t?e:[e[0]/t,e[1]/t,e[2]/t]},normalTo:function(e){if(0==e[0])return[1,0,0];if(0==e[1])return[0,1,0];if(0==e[2])return[0,0,1];var t=EJSS_TOOLS.Mathematics.norm(e);return[-e[1]/t,e[0]/t,0]},rotate:function(e,t,r){var n=Math.cos(r),i=Math.sin(r);return[n*(t[0]-e[0])+i*(t[1]-e[1])+e[0],n*(t[1]-e[1])-i*(t[0]-e[0])+e[1]]}},sensors={iOS_accelerometer:{x:0,y:0,z:0},iOS_gyroscope:{x:0,y:0,z:0},setAccelerometer:function(accvalue){var value=JSON.parse(accvalue),accelerometer=eval(value.result);window.innerWidth>window.innerHeight?sensors.iOS_accelerometer={x:accelerometer.y,y:-accelerometer.x,z:accelerometer.z}:sensors.iOS_accelerometer=accelerometer},setGyroscope:function(gyrvalue){var value=JSON.parse(gyrvalue),gyroscope=eval(value.result);window.innerWidth>window.innerHeight?sensors.iOS_gyroscope={x:gyroscope.y,y:-gyroscope.x,z:gyroscope.z}:sensors.iOS_gyroscope=gyroscope},iOS_staccelerometer:{x:0,y:0,z:0},iOS_stgyroscope:{x:0,y:0,z:0},iOS_stmagnetometer:{x:0,y:0,z:0},iOS_sthumidity:0,iOS_sttempamb:0,iOS_sttempir:0,iOS_stpressure:0,setSensorTag:function(stvalue){var value=JSON.parse(stvalue),results=eval(value.result);sensors.iOS_staccelerometer={x:results.accx,y:results.accy,z:results.accz},sensors.iOS_stgyroscope={x:results.gyrox,y:results.gyroy,z:results.gyroz},sensors.iOS_stmagnetometer={x:results.magx,y:results.magy,z:results.magz},sensors.iOS_sthumidity=results.hum,sensors.iOS_sttempamb=results.tamb,sensors.iOS_sttempir=results.tir,sensors.iOS_stpressure=results.press},calliOSFunction:function(e,t,r,n){var i="ejss://",o={};o.functionname=e,r&&(o.success=r),n&&(o.error=n),t&&(o.args=t),i+=JSON.stringify(o),window.location=i},isSupportedSensorTag:function(){return/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent)},runSensorTag:function(e,t){if(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent)){var r=[];r[0]=e,r[1]=t,sensors.calliOSFunction("runSensorTag",r,"sensors.setSensorTag")}},stopSensorTag:function(){/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent)&&sensors.calliOSFunction("stopSensorTag")},getSensorTagAccelerometer:function(){return sensors.iOS_staccelerometer},getSensorTagGyroscope:function(){return sensors.iOS_stgyroscope},getSensorTagMagnetometer:function(){return sensors.iOS_stmagnetometer},getSensorTagTempAmb:function(){return sensors.iOS_sttempamb},getSensorTagTempIR:function(){return sensors.iOS_sttempir},getSensorTagPressure:function(){return sensors.iOS_stpressure},getSensorTagHumidity:function(){return sensors.iOS_sthumidity},isAccelerometer:function(){var e=window.android&&window.android.isAccelerometer(),t=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);return e||t},runAccelerometer:function(){var e=window.android&&window.android.isAccelerometer(),t=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);e?window.android.runAccelerometer():t&&sensors.calliOSFunction("runAccelerometer","","sensors.setAccelerometer")},stopAccelerometer:function(){var e=window.android&&window.android.isAccelerometer(),t=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);e?window.android.stopAccelerometer():t&&sensors.calliOSFunction("stopAccelerometer")},getAccelerometer:function(){var is_Androidwebview=window.android&&window.android.isAccelerometer(),is_iOSwebview=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);if(is_Androidwebview){var value=eval(window.android.getAccelerometer());return window.innerWidth>window.innerHeight?value:{x:value.y,y:-value.x,z:value.z}}return is_iOSwebview?sensors.iOS_accelerometer:{x:0,y:0,z:0}},isGyroscope:function(){var e=window.android&&window.android.isGyroscope(),t=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);return e||t},runGyroscope:function(){var e=window.android&&window.android.isGyroscope(),t=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);e?window.android.runGyroscope():t&&sensors.calliOSFunction("runGyroscope","","sensors.setGyroscope")},stopGyroscope:function(){var e=window.android&&window.android.isGyroscope(),t=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);e?window.android.stopGyroscope():t&&sensors.calliOSFunction("stopGyroscope")},getGyroscope:function(){var is_Androidwebview=window.android&&window.android.isGyroscope(),is_iOSwebview=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);if(is_Androidwebview){var value=eval(window.android.getGyroscope());return window.innerWidth>window.innerHeight?value:{x:value.y,y:-value.x,z:value.z}}return is_iOSwebview?sensors.iOS_gyroscope:{x:0,y:0,z:0}},isGravity:function(){return window.android&&window.android.isGravity()},runGravity:function(){window.android&&window.android.isGravity()&&window.android.runGravity()},stopGravity:function(){window.android&&window.android.isGravity()&&window.android.stopGravity()},getGravity:function(){return window.android&&window.android.isGravity()?window.android.getGravity():{x:0,y:0,z:0}},isLinearAcceleration:function(){return window.android&&window.android.isLinearAcceleration()},runLinearAcceleration:function(){window.android&&window.android.isLinearAcceleration()&&window.android.runLinearAcceleration()},stopLinearAcceleration:function(){window.android&&window.android.isLinearAcceleration()&&window.android.stopLinearAcceleration()},getLinearAcceleration:function(){return window.android&&window.android.isLinearAcceleration()?window.android.getLinearAcceleration():{x:0,y:0,z:0}},isRotationVector:function(){return window.android&&window.android.isRotationVector()},runRotationVector:function(){window.android&&window.android.isRotationVector()&&window.android.runRotationVector()},stopRotationVector:function(){window.android&&window.android.isRotationVector()&&window.android.stopRotationVector()},getRotationVector:function(){return window.android&&window.android.isRotationVector()?window.android.getRotationVector():{x:0,y:0,z:0}},isMagneticField:function(){return window.android&&window.android.isMagneticField()},runMagneticField:function(){window.android&&window.android.isMagneticField()&&window.android.runMagneticField()},stopMagneticField:function(){window.android&&window.android.isMagneticField()&&window.android.stopMagneticField()},getMagneticField:function(){return window.android&&window.android.isMagneticField()?window.android.getMagneticField():{x:0,y:0,z:0}},isAmbientTemperature:function(){return window.android&&window.android.isAmbientTemperature()},runAmbientTemperature:function(){window.android&&window.android.isAmbientTemperature()&&window.android.runAmbientTemperature()},stopAmbientTemperature:function(){window.android&&window.android.isAmbientTemperature()&&window.android.stopAmbientTemperature()},getAmbientTemperature:function(){return window.android&&window.android.isAmbientTemperature()?window.android.getAmbientTemperature():0},isLight:function(){return window.android&&window.android.isLight()},runLight:function(){window.android&&window.android.isLight()&&window.android.runLight()},stopLight:function(){window.android&&window.android.isLight()&&window.android.stopLight()},getLight:function(){return window.android&&window.android.isLight()?window.android.getLight():0},isPressure:function(){return window.android&&window.android.isPressure()},runPressure:function(){window.android&&window.android.isPressure()&&window.android.runPressure()},stopPressure:function(){window.android&&window.android.isPressure()&&window.android.stopPressure()},getPressure:function(){return window.android&&window.android.isPressure()?window.android.getPressure():0},isHumidity:function(){return window.android&&window.android.isHumidity()},runHumidity:function(){window.android&&window.android.isHumidity()&&window.android.runHumidity()},stopHumidity:function(){window.android&&window.android.isHumidity()&&window.android.stopHumidity()},getHumidity:function(){return window.android&&window.android.isHumidity()?window.android.getHumidity():0}},_smartDevice.prototype={metadata:"",apis:[],models:"",modelsTemplate:[],apisFn:[],loadMetadata:function(e){this.metadata=JSON.parse(e)},loadModels:function(){this.models=this.metadata.models},loadApis:function(){this.apis=this.metadata.apis},getModelTemplate:function(e){if(this.models.hasOwnProperty(e)){var t=JSON.parse(JSON.stringify(this.models[e])),e=t.id;t.properties;return t}return writeToScreen('<span style="color: red;">ERROR:</span> '+e+" is not a key -> Model Not found"),null},generateMethodCall:function(e){for(var t=0;t<this.apis.length;t++)for(var r=this.apis[t],n=r.operations,i=0;i<n.length;i++){var o=n[i];if(o.nickname==e||void 0==e){var a,s=o.parameters[0],l=this.getModelTemplate(s.type),u=l.properties;l.hasOwnProperty("required")&&(a=l.required);var g="{",c=[],S=!1;for(var d in u)S?g+=",":S=!0,g+="'"+d+"' : "+d,c.push(d);g+="}";var f="{";if(void 0!=a)for(var E in a)f+="if( "+a[E]+"== undefined)  { \nconsole.log('Required parameter, "+a[E]+" : must be an input'); \nreturn null;} \n";f+="this.websocket.send(JSON.stringify("+g+"))",f+="}",this[o.nickname]=new Function(c,f)}}return!0},generateModelFilling:function(e){for(var t in this.models)if(t==e||void 0==e){var r,n=this.models[t],i=n.properties;n.hasOwnProperty("required")&&(r=n.required);var o=[],a="";a+="{\n",a+="\t var json2send=this.getModelTemplate('"+t+"').properties;\n";for(var s in i)o.push(s),a+="\t if( "+s+" != undefined)  { \n",a+="\t\t json2send['"+s+"']="+s+";  \n",a+="\t }else{\n",a+="\t\t delete json2send."+s+";\n",a+="\t }\n";if(void 0!=r)for(var l in r)a+="\t if( "+l+"== undefined)  { \n\t\t console.log('Required parameter, "+l+" : must be an input'); \n\t\t return null; \n",a+="\t }\n";a+="\t return json2send;",a+="}",this["fill"+t]=new Function(o,a)}return!0},bindFunctions:function(){},searchMethod:function(e){for(var t=0;t<this.apis.length;t++)for(var r=this.apis[t],n=r.operations,i=0;i<n.length;i++){var o=n[i];if(o.nickname==e)return o}},isValidMessage:function(e,t){var r=e;if(r.hasOwnProperty("method"))var n=this.searchMethod(r.method);else{if(void 0==t)return!1;var n=this.searchMethod(t)}for(var i=this.getModelTemplate(n.type),o=!1,a="",s=0;s<i.required.length;s++){if(a=i.required[s],!r.hasOwnProperty(a))return o=!1,console.log("Error processinMessage : "+e+" -> Property : "+a+" is a required field"),o;o=!0}return o},extract:function(e,t){if(this.isValidMessage(t)){for(var r={},n=0;n<e.length;n++)name=e[n],r[name]=t[name];return r}}},wrapper.prototype={methods:{connect:"connect",disconnect:"disconnect",get:"get",set:"set",callAction:"callAction",extract:"extract",eval:"eval",open:"open",step:"step"},post:function(e,t){(void 0!=e||t.hasOwnProperty("method"))&&(void 0==e||t.hasOwnProperty("method")||(t.method=e),websocket.send(t))},sync:function(e){void 0!=e&&e(response)},connect:function(e){this.smartdevice=new _smartDevice(fullData),this.smartdevice.loadApis(),this.smartdevice.loadModels(),this.smartdevice.generateMethodCall()},disconnect:function(e){},get:function(e,t,r){void 0===t||0==t?this.smartdevice.getSensorData("getSensorData",e):this.smartdevice.getSensorData("getSensorData",e,[this.smartdevice.fillConfigurationItem("updateFrequency",2)])},set:function(e,t,r,n){1==e.length?this.smartdevice.sendActuatorData(r,"sendActuatorData","modelVars",[e],[t]):this.smartdevice.sendActuatorData(r,"sendActuatorData","modelVars",e,t)},callAction:function(e,t,r){this.smartdevice.callAction("","callAction","modelMethods",e,t)},extract:function(e,t){var r=JSON.parse(e),n={};if(r.hasOwnProperty("method")){var i=r.method,o={};if("getSensorData"==i)n=["sensorId","responseData"];else if("sendActuatorData"==i)n=["lastMeasured","accessrole","payload","observerMode"];else if("getSensorMetadata"==i)n=["sensors"];else if("getActuatorMetadata"==i)n=["actuators"];else if("getActionsMetadata"==i)n=["sensors"];else if("callAction"==i)n=["method","callerName","nickName","params"];else{if("actionDataResponse"!=i)return void console.log("The method : "+r.method+" is not handled in this wrapper. \nWill be ignored.");n=["method","nickName"]}}return o=this.smartdevice.extract(n,r),this.toEjssReadable(i,o)},eval:function(e,t){},open:function(e,t){},step:function(e,t){},toEjssReadable:function(e,t){if("getSensorData"==e){for(var r={},n=t.responseData.valueNames,i=t.responseData.data,o=0;o<n.length;o++)r[n[o]]=i[o];return r}return"sendActuatorData"==e||("getSensorMetadata"==e?t:"getActuatorMetadata"==e?t:"getActionsMetadata"==e?t:"callAction"==e?t:"actionDataResponse"==e?t:void console.log("The method : "+e+" is nor handled in this wrapper. \nWill be ignored."))}};var EJSS_CORE=EJSS_CORE||{};EJSS_CORE.createView=function(e){function t(e,t){return e.match("^"+t)==t}var r,n,i,o,a,s={},l={},u={},g=[],c=[],S=[],d=[],f=[],E=[],p=[],h=[],m=[],A=[],P=[],v=[],y=!1,C=!0,D=[],I=[],R=!1,_=[],T=[],N=[];return s._1=function(){s[e].innerHTML="",l={},u={},g=[],c=[],D=[],S=[],d=[],f=[],E=[],p=[],m=[],A=[],P=[],v=[],h=[],y=!1,C=!0},s._2=function(e){n=e},s._3=function(e,r){if(null==e||e.length<=0)return e;if(t(e,"local:"))return e;if(t(e,"data:"))return e;if(t(e,"http:")||t(e,"https:")||t(e,"ws:"))return e;if("undefined"!=typeof __base64Images){var o=__base64Images[e];if(o)return o}if(i&&!t(e,i)&&"/"==e.charAt(0)?e=i+"images"+e:n&&!t(e,n)&&"/"!=e.charAt(0)&&(e=n+e),r&&t(window.location.protocol,"ibooks")){var a=window.location.pathname;a=a.substring(0,a.lastIndexOf("/")),t(e,"./")&&(e=e.substring(2)),e=window.location.protocol+"://"+window.location.host+"/"+a+"/"+e}return e},s._4=function(e){i=e},s._showDocument=function(e){window.open(s._3(e))},s._addDescriptionPage=function(e,t){_[e]=t},s._openDescriptionPage=function(e){var t=_[e];t?window.open(s._3(t)):console.log("Desription page not found: "+e)},s._5=function(e,t){l[e]={getter:null,setter:null,listeners:[],collectors:[],value:t}},s._5s=function(e){for(var t=0;t<e.length;t++)s._5(e[t])},s._7=function(e){u[e]={action:null}},s._7s=function(e){for(var t=0;t<e.length;t++)s._7(e[t])},s._9=function(e,t,r,n){var i=EJSS_CORE.promoteToControlElement(e(t,n),s,t);return i.render&&f.push(i),i.touch&&E.push(i),i.dataCollected&&p.push(i),i.reset&&S.push(i),i.initialize&&d.push(i),i.enableEPub&&m.push(i),i.adjustPosition&&A.push(i),t&&(s[t]=i),r&&i.setProperty("Parent",r),i},s._10=function(e){
var t=l[e];if(void 0!==t)return t.value},s._11=function(){s._reset(),s._15(),s._initialize(),s._update(),s._render()},s._setRootProperty=function(e,t,r){switch(t){case"RunAlways":e.setRunAlways(r);break;case"OnBlur":s._addOnBlurAction(r);break;case"OnFocus":s._addOnFocusAction(r);break;case"InnerHTML":s._setInnerHTML(r);break;default:console.log("WARNING: View property not registered : "+t)}},s._12=function(e){r=e},s._13=function(e,t,r,n){var i=l[e];if(i){i.getter=t,i.setter=r,i.value=n;var o=c.indexOf(i);i.getter?i.listeners.length>0&&o<0&&c.push(i):o>=0&&c.splice(o,1),o=D.indexOf(i),i.value?i.listeners.length>0&&o<0&&D.push(i):o>=0&&D.splice(o,1)}else console.log("WARNING: view._setAccessors() - Variable not found : "+e);return i},s._setAction=function(e,t){var r=u[e];return r?r.action=t:console.log("WARNING: view._setAction() - Action not found : "+e),r},s._14=function(e){C=e},s._reset=function(){for(var e=0,t=S.length;e<t;e++)S[e].reset()},s._15=function(){for(var e=0,t=D.length;e<t;e++){var r=D[e],n=r.value;if(n)for(var i=r.listeners,o=0,a=i.length;o<a;o++)i[o](n)}},s._initialize=function(){for(var e=0,t=d.length;e<t;e++)d[e].initialize()},s._update=function(){var e,t;for(e=0,t=c.length;e<t;e++)for(var r=c[e],n=r.listeners,i=r.getter(),o=0,a=n.length;o<a;o++)n[o](i);for(e=0,t=g.length;e<t;e++){var s=g[e];s.propertySetter(s.getter())}},s._collectData=function(){var e,t;for(e=0,t=c.length;e<t;e++)for(var r=c[e],n=r.collectors,i=r.getter(),o=0,a=n.length;o<a;o++)n[o](i);for(e=0,t=g.length;e<t;e++){var s=g[e];s.isCollector&&s.propertySetter(s.getter())}for(e=0,t=p.length;e<t;e++)p[e].dataCollected()},s._render=function(){for(var e=0,t=f.length;e<t;e++)f[e].render()},s._touch=function(){for(var e=0,t=E.length;e<t;e++)E[e].touch()},s._enableEPub=function(){if("undefined"!=typeof _isEPub&&_isEPub)for(var e=0,t=m.length;e<t;e++)m[e].enableEPub()},s._addFontResizeListener=function(e){P.push(e)},s._fontResized=function(e,t,r){for(var n=0,i=A.length;n<i;n++)A[n].adjustPosition();if(e)for(var o=0,a=P.length;o<a;o++)P[o](e,t,r)},s._addResizeListener=function(e){v.push(e)},s._resized=function(e,t){for(var r=0,n=A.length;r<n;r++)A[r].adjustPosition();for(var i=0,o=v.length;i<o;i++)v[i](e,t)},s._16=function(e,t,r){var n=h.length;if(n<=0)return!1;y=!0;for(var i=0;i<n;i++){var o=h[i];if(s.isRegInteractions()){var a=o.interaction;a.data=o.data,a.runCount=e,a.runTime=t,a.isPlaying=r,a.timeStamp=Date.now(),s.pushRegInteractions(a)}o.data&&o.data.info?o.what(o.data.info,o.data):o.what(o.data)}return h=[],y=!1,!0},s._17=function(){return h.length},s._addOnBlurAction=function(e){T.push(e)},s._onBlur=function(){for(var e=0,t=T.length;e<t;e++)T[e]()},s._addOnFocusAction=function(e){N.push(e)},s._onFocus=function(){for(var e=0,t=N.length;e<t;e++)N[e]()},s._setInnerHTML=function(e){void 0===a&&(a=document.createElement("div"),document.body.appendChild(a)),a.innerHTML=e},s._18=function(){r&&C&&r()},s._19=function(e,t,r){var n=l[e];return n?(n.listeners.indexOf(t)<0&&(n.listeners.push(t),r&&n.collectors.push(t)),n.getter&&c.indexOf(n)<0&&c.push(n),n.value&&D.indexOf(n)<0&&D.push(n)):console.log("WARNING: view._19() - Variable not found : "+e),n},s._20=function(e,t,r){for(var n=!1,i=0,o=g.length;i<o;i++){var a=g[i];if(a.propertySetter===t){a.getter=e,n=!0;break}}return n||g.push({getter:e,propertySetter:t,isCollector:r}),n},s._21=function(e){var t=u[e];return t||console.log("WARNING: view._21() - Action not found : "+e),t},s._22=function(e,t,n){if(!r)return void e(t);!y&&C&&h.push({what:e,data:t,interaction:n})},s._format=function(e,t){var r=t.indexOf("."),n=0;return r>=0&&(n=Number(t.length-r-1)),parseFloat(e).toFixed(n)},s.print=function(e){var t=document.getElementsByTagName("textarea");t.length?t[0].innerHTML=e:console.log(e)},s._setVisible=function(t){document.getElementById(e).style.display=t?"inherit":"none"},s._switchVisibility=function(){s._setVisible("none"==document.getElementById(e).style.display)},s.serialize=function(){var e={};for(key in s)s[key].serialize&&(e[key]=s[key].serialize());return e},s.unserialize=function(e){for(key in e)s[key]&&s[key].unserialize?s[key].unserialize(e[key]):console.log("Impossible unserialize: "+key)},s.registerInteractions=function(e){I=[],o=e,R=!0},s.unregisterInteractions=function(){R=!1},s.getRegInteractions=function(){return I},s.isRegInteractions=function(){return R},s.pushRegInteractions=function(e){void 0!==o?o.send(JSON.stringify(e)):I.push(e)},s[e]=document.getElementById(e),s},EJSS_CORE.promoteToControlElement=function(e,t,r){r=r||"unnamed";var n={},i={};return e.getView=function(){return t},e._0=function(e){r=e},e.getName=function(){return r},e.getResourcePath=function(e){return t._3(e)},e.registerProperty=function(t,r,i){return n[t]={setter:r,getter:i,variable:null,variableSetter:null},e},e.registerAction=function(t,r,n,o){return i[t]={action:null,helper:r,process:n},o&&e.setAction(t,o),e},e.setProperty=function(t,r){if(i[t])return e.setAction(t,r);var o=n[t];return o?o.setter(r):console.log("WARNING: ControlElement setProperty() - Property not registered : "+t+" for element : "+e.getName()),e},e.setProperties=function(t){for(var r in t)e.setProperty(r,t[r]);return e},e.linkProperty=function(r,i,o){var a=n[r];if(!a)return console.log("WARNING: ControlElement linkProperty() - Element property not registered : "+r+" for element : "+e.getName()),e;if("string"==typeof i){var s=t._19(i,a.setter,e.dataCollected);if(!s)return console.log("WARNING: ControlElement linkProperty() - element : "+e.getName()+" - property :"+r+" - View variable not registered : "+i),e;"InputOnly"===o||(a.variable=s),a.variableSetter=null}else t._20(i,a.setter,e.dataCollected),a.variableSetter=o,a.variable=null;return e},e.linkProperties=function(t){for(var r in t)e.linkProperty(r,t[r]);return e},e.setAction=function(r,n){var o=i[r];if(!o)return console.log("WARNING: ControlElement setAction() - action not registered : "+r+" for element : "+e.getName),e;if("string"==typeof n){var a=t._21(n);if(!a)return console.log("WARNING: ControlElement setAction() - element : "+e.getName()+" - View action not registered : "+n),e;o.action=a}else o.action={action:n};return e},e.setActions=function(t){for(var r in t)e.setAction(r,t[r]);return e},e.invokeAction=function(r){var n={};t.isRegInteractions()&&(n={action:r,element:e.getName(),timeStamp:Date.now()});var o=i[r];if(o&&(o.process&&t._22(o.process,null,n),o.action)){var a=o.helper?o.helper():null;t._22(o.action.action,a,n)}return e},e.invokeImmediateAction=function(t){var r=i[t];if(r&&(r.process&&r.process(null),r.action)){var n=r.helper?r.helper():null;r.action.action(n)}return e},e.propertiesChanged=function(){for(var t=0,r=arguments.length;t<r;t++)e.propertyChanged(arguments[t]);return e},e.propertyChanged=function(r,i){var o={};t.isRegInteractions()&&(o={property:r,element:e.getName(),timeStamp:Date.now()});var a=n[r];if(a){var s=a.variableSetter;if(s||a.variable&&(s=a.variable.setter),s||a.setter&&(s=a.setter),s){var l=void 0!==i?i:a.getter();t._22(s,l,o)}}return e},e.immediatePropertyChanged=function(t,r){var i=n[t];if(i){var o=i.variableSetter;if(o||i.variable&&(o=i.variable.setter),o||i.setter&&(o=i.setter),o){o(void 0!==r?r:i.getter())}}return e},e.reportInteractions=function(r,n){var i,o;if(r)for(i=0,o=r.length;i<o;i++)e.invokeAction(r[i]);if(n)for(i=0,o=n.length;i<o;i++)e.propertiesChanged(n[i]);return t._17()>0&&t._18(),e},e.getProperty=function(e,t){var r=n[e];if(r&&r.getter)return r.getter()},e.getProperties=function(){return n},e.registerProperty("name",e._0,e.getName),e.registerProperties&&e.registerProperties(e),e};

/* _inputParameters: an object with different values for the model parameters */
function SHM14_v2(_topFrame,_libraryPath,_codebasePath, _inputParameters) {
  var _model = EJSS_CORE.createAnimation();
  var _view;
  var _isPlaying = false;
  var _isPaused = true;
  var _isMobile = (navigator===undefined) ? false : navigator.userAgent.match(/iPhone|iPad|iPod|Android|BlackBerry|Opera Mini|IEMobile/i);

var _stringProperties = {};
  var _tools = {
    showInputDialog : EJSS_INTERFACE.BoxPanel.showInputDialog,
    showOkDialog : EJSS_INTERFACE.BoxPanel.showOkDialog,
    showOkCancelDialog : EJSS_INTERFACE.BoxPanel.showOkCancelDialog
  };

  function _play()  { _isPaused = false; _isPlaying = true;  _model.play();  }
  function _pause() { _isPaused = true;  _isPlaying = false; _model.pause(); }
  function _step()  { _pause();  _model.step(); }
  function _reset() { _model.reset();  _isPaused = _model.isPaused(); _isPlaying = _model.isPlaying(); }
  _model._play  = _play;
  _model._pause = _pause;
  _model._step  = _step;
  _model._reset = _reset;
  function _update() { _model.update(); }
  function _initialize() { _model.initialize(); }
  function _setFPS(_fps) { _model.setFPS(_fps); }
  function _setDelay(_delay) { _model.setDelay(_delay); }
  function _setStepsPerDisplay(_spd) { _model.setStepsPerDisplay(_spd); }
  function _setUpdateView(_updateView) { _model.setUpdateView(_updateView); }
  function _setAutoplay(_auto) { _model.setAutoplay(_auto); }
  function _println(_message) { console.log(_message); }

  function _breakAfterThisPage() { _model.setShouldBreak(true); }

  function _resetSolvers() { if (_model.resetSolvers) _model.resetSolvers(); }

  function _saveText(name,type,content) { if (_model.saveText) _model.saveText(name,type,content); }

  function _saveState(name) { if (_model.saveState) _model.saveState(name); }

  function _saveImage(name,panelname) { if (_model.saveImage) _model.saveImage(name,panelname); }

  function _readState(url,type) { if (_model.readState) _model.readState(url,type); }

  function _readText(url,type,varname) { if (_model.readText) _model.readText(url,type,varname); }

  function _getStringProperty(propertyName) {
    var _value = _stringProperties[propertyName];
    if (_value===undefined) return propertyName;
    else return _value;
  }
  var __pagesEnabled = [];
  function _setPageEnabled(pageName,enabled) { __pagesEnabled[pageName] = enabled; }

  var xmin; // EjsS Model.Variables.Var Table.xmin
  var xmax; // EjsS Model.Variables.Var Table.xmax
  var ymin; // EjsS Model.Variables.Var Table.ymin
  var ymax; // EjsS Model.Variables.Var Table.ymax
  var rangex; // EjsS Model.Variables.Var Table.rangex
  var rangey; // EjsS Model.Variables.Var Table.rangey
  var sizex; // EjsS Model.Variables.Var Table.sizex
  var sizey; // EjsS Model.Variables.Var Table.sizey
  var selected; // EjsS Model.Variables.Var Table.selected
  var text; // EjsS Model.Variables.Var Table.text
  var pi; // EjsS Model.Variables.Var Table.pi
  var y1; // EjsS Model.Variables.Var Table.y1
  var ysize; // EjsS Model.Variables.Var Table.ysize

  var isAndroid; // EjsS Model.Variables.layout.isAndroid
  var selectedview; // EjsS Model.Variables.layout.selectedview
  var iOS; // EjsS Model.Variables.layout.iOS
  var iPad; // EjsS Model.Variables.layout.iPad
  var iPhone; // EjsS Model.Variables.layout.iPhone
  var Width; // EjsS Model.Variables.layout.Width
  var Width1; // EjsS Model.Variables.layout.Width1
  var Height; // EjsS Model.Variables.layout.Height
  var Width2; // EjsS Model.Variables.layout.Width2
  var xvst; // EjsS Model.Variables.layout.xvst
  var vvst; // EjsS Model.Variables.layout.vvst
  var avst; // EjsS Model.Variables.layout.avst
  var world; // EjsS Model.Variables.layout.world
  var graph; // EjsS Model.Variables.layout.graph
  var disabledworld; // EjsS Model.Variables.layout.disabledworld
  var disabled; // EjsS Model.Variables.layout.disabled

  var m; // EjsS Model.Variables.simplespring.m
  var k; // EjsS Model.Variables.simplespring.k
  var l; // EjsS Model.Variables.simplespring.l
  var x; // EjsS Model.Variables.simplespring.x
  var xs; // EjsS Model.Variables.simplespring.xs
  var y; // EjsS Model.Variables.simplespring.y
  var vx; // EjsS Model.Variables.simplespring.vx
  var vxs; // EjsS Model.Variables.simplespring.vxs
  var vxstored; // EjsS Model.Variables.simplespring.vxstored
  var t; // EjsS Model.Variables.simplespring.t
  var tcst; // EjsS Model.Variables.simplespring.tcst
  var X; // EjsS Model.Variables.simplespring.X
  var T; // EjsS Model.Variables.simplespring.T
  var dt; // EjsS Model.Variables.simplespring.dt
  var w; // EjsS Model.Variables.simplespring.w
  var a; // EjsS Model.Variables.simplespring.a
  var f; // EjsS Model.Variables.simplespring.f
  var nt; // EjsS Model.Variables.simplespring.nt
  var counterA; // EjsS Model.Variables.simplespring.counterA
  var counterB; // EjsS Model.Variables.simplespring.counterB
  var pointB; // EjsS Model.Variables.simplespring.pointB
  var arraypointB; // EjsS Model.Variables.simplespring.arraypointB
  var tpointB; // EjsS Model.Variables.simplespring.tpointB
  var tarraypointB; // EjsS Model.Variables.simplespring.tarraypointB
  var pointA; // EjsS Model.Variables.simplespring.pointA
  var tpointA; // EjsS Model.Variables.simplespring.tpointA
  var arraypointA; // EjsS Model.Variables.simplespring.arraypointA
  var tarraypointA; // EjsS Model.Variables.simplespring.tarraypointA
  var textA; // EjsS Model.Variables.simplespring.textA
  var textB; // EjsS Model.Variables.simplespring.textB
  var apointA; // EjsS Model.Variables.simplespring.apointA
  var apointB; // EjsS Model.Variables.simplespring.apointB

  var b; // EjsS Model.Variables.advancedspring.b
  var amplitude; // EjsS Model.Variables.advancedspring.amplitude
  var frequency; // EjsS Model.Variables.advancedspring.frequency
  var potentialEnergy; // EjsS Model.Variables.advancedspring.potentialEnergy
  var kineticEnergy; // EjsS Model.Variables.advancedspring.kineticEnergy
  var totalEnergy; // EjsS Model.Variables.advancedspring.totalEnergy
  var afrequency; // EjsS Model.Variables.advancedspring.afrequency
  var Hertz; // EjsS Model.Variables.advancedspring.Hertz

  var xmaxs; // EjsS Model.Variables.max.xmaxs
  var vmaxs; // EjsS Model.Variables.max.vmaxs
  var amaxs; // EjsS Model.Variables.max.amaxs
  var Emaxs; // EjsS Model.Variables.max.Emaxs

  var selectedmodel; // EjsS Model.Variables.functionY.selectedmodel
  var xmodel; // EjsS Model.Variables.functionY.xmodel
  var showmodel; // EjsS Model.Variables.functionY.showmodel
  var functionY; // EjsS Model.Variables.functionY.functionY
  var phi; // EjsS Model.Variables.functionY.phi
  var Acalculated; // EjsS Model.Variables.functionY.Acalculated
  var solutionY; // EjsS Model.Variables.functionY.solutionY

  var _privateOdesList;
  var _ODEi_evolution1;

  function _serialize() { return _model.serialize(); }

  _model._userSerialize = function() {
    return {
      xmin : xmin,
      xmax : xmax,
      ymin : ymin,
      ymax : ymax,
      rangex : rangex,
      rangey : rangey,
      sizex : sizex,
      sizey : sizey,
      selected : selected,
      text : text,
      pi : pi,
      y1 : y1,
      ysize : ysize,
      isAndroid : isAndroid,
      selectedview : selectedview,
      iOS : iOS,
      iPad : iPad,
      iPhone : iPhone,
      Width : Width,
      Width1 : Width1,
      Height : Height,
      Width2 : Width2,
      xvst : xvst,
      vvst : vvst,
      avst : avst,
      world : world,
      graph : graph,
      disabledworld : disabledworld,
      disabled : disabled,
      m : m,
      k : k,
      l : l,
      x : x,
      xs : xs,
      y : y,
      vx : vx,
      vxs : vxs,
      vxstored : vxstored,
      t : t,
      tcst : tcst,
      X : X,
      T : T,
      dt : dt,
      w : w,
      a : a,
      f : f,
      nt : nt,
      counterA : counterA,
      counterB : counterB,
      pointB : pointB,
      arraypointB : arraypointB,
      tpointB : tpointB,
      tarraypointB : tarraypointB,
      pointA : pointA,
      tpointA : tpointA,
      arraypointA : arraypointA,
      tarraypointA : tarraypointA,
      textA : textA,
      textB : textB,
      apointA : apointA,
      apointB : apointB,
      b : b,
      amplitude : amplitude,
      frequency : frequency,
      potentialEnergy : potentialEnergy,
      kineticEnergy : kineticEnergy,
      totalEnergy : totalEnergy,
      afrequency : afrequency,
      Hertz : Hertz,
      xmaxs : xmaxs,
      vmaxs : vmaxs,
      amaxs : amaxs,
      Emaxs : Emaxs,
      selectedmodel : selectedmodel,
      xmodel : xmodel,
      showmodel : showmodel,
      functionY : functionY,
      phi : phi,
      Acalculated : Acalculated,
      solutionY : solutionY
    };
  };

  function _serializePublic() { return _model.serializePublic(); }

  _model._userSerializePublic = function() {
    return {
      xmin : xmin,
      xmax : xmax,
      ymin : ymin,
      ymax : ymax,
      rangex : rangex,
      rangey : rangey,
      sizex : sizex,
      sizey : sizey,
      selected : selected,
      text : text,
      pi : pi,
      y1 : y1,
      ysize : ysize,
      isAndroid : isAndroid,
      selectedview : selectedview,
      iOS : iOS,
      iPad : iPad,
      iPhone : iPhone,
      Width : Width,
      Width1 : Width1,
      Height : Height,
      Width2 : Width2,
      xvst : xvst,
      vvst : vvst,
      avst : avst,
      world : world,
      graph : graph,
      disabledworld : disabledworld,
      disabled : disabled,
      m : m,
      k : k,
      l : l,
      x : x,
      xs : xs,
      y : y,
      vx : vx,
      vxs : vxs,
      vxstored : vxstored,
      t : t,
      tcst : tcst,
      X : X,
      T : T,
      dt : dt,
      w : w,
      a : a,
      f : f,
      nt : nt,
      counterA : counterA,
      counterB : counterB,
      pointB : pointB,
      arraypointB : arraypointB,
      tpointB : tpointB,
      tarraypointB : tarraypointB,
      pointA : pointA,
      tpointA : tpointA,
      arraypointA : arraypointA,
      tarraypointA : tarraypointA,
      textA : textA,
      textB : textB,
      apointA : apointA,
      apointB : apointB,
      b : b,
      amplitude : amplitude,
      frequency : frequency,
      potentialEnergy : potentialEnergy,
      kineticEnergy : kineticEnergy,
      totalEnergy : totalEnergy,
      afrequency : afrequency,
      Hertz : Hertz,
      xmaxs : xmaxs,
      vmaxs : vmaxs,
      amaxs : amaxs,
      Emaxs : Emaxs,
      selectedmodel : selectedmodel,
      xmodel : xmodel,
      showmodel : showmodel,
      functionY : functionY,
      phi : phi,
      Acalculated : Acalculated,
      solutionY : solutionY
    };
  };

  _model._readParameters = function(json) {
    if(typeof json.xmin != "undefined") xmin = json.xmin;
    if(typeof json.xmax != "undefined") xmax = json.xmax;
    if(typeof json.ymin != "undefined") ymin = json.ymin;
    if(typeof json.ymax != "undefined") ymax = json.ymax;
    if(typeof json.rangex != "undefined") rangex = json.rangex;
    if(typeof json.rangey != "undefined") rangey = json.rangey;
    if(typeof json.sizex != "undefined") sizex = json.sizex;
    if(typeof json.sizey != "undefined") sizey = json.sizey;
    if(typeof json.selected != "undefined") selected = json.selected;
    if(typeof json.text != "undefined") text = json.text;
    if(typeof json.pi != "undefined") pi = json.pi;
    if(typeof json.y1 != "undefined") y1 = json.y1;
    if(typeof json.ysize != "undefined") ysize = json.ysize;
    if(typeof json.isAndroid != "undefined") isAndroid = json.isAndroid;
    if(typeof json.selectedview != "undefined") selectedview = json.selectedview;
    if(typeof json.iOS != "undefined") iOS = json.iOS;
    if(typeof json.iPad != "undefined") iPad = json.iPad;
    if(typeof json.iPhone != "undefined") iPhone = json.iPhone;
    if(typeof json.Width != "undefined") Width = json.Width;
    if(typeof json.Width1 != "undefined") Width1 = json.Width1;
    if(typeof json.Height != "undefined") Height = json.Height;
    if(typeof json.Width2 != "undefined") Width2 = json.Width2;
    if(typeof json.xvst != "undefined") xvst = json.xvst;
    if(typeof json.vvst != "undefined") vvst = json.vvst;
    if(typeof json.avst != "undefined") avst = json.avst;
    if(typeof json.world != "undefined") world = json.world;
    if(typeof json.graph != "undefined") graph = json.graph;
    if(typeof json.disabledworld != "undefined") disabledworld = json.disabledworld;
    if(typeof json.disabled != "undefined") disabled = json.disabled;
    if(typeof json.m != "undefined") m = json.m;
    if(typeof json.k != "undefined") k = json.k;
    if(typeof json.l != "undefined") l = json.l;
    if(typeof json.x != "undefined") x = json.x;
    if(typeof json.xs != "undefined") xs = json.xs;
    if(typeof json.y != "undefined") y = json.y;
    if(typeof json.vx != "undefined") vx = json.vx;
    if(typeof json.vxs != "undefined") vxs = json.vxs;
    if(typeof json.vxstored != "undefined") vxstored = json.vxstored;
    if(typeof json.t != "undefined") t = json.t;
    if(typeof json.tcst != "undefined") tcst = json.tcst;
    if(typeof json.X != "undefined") X = json.X;
    if(typeof json.T != "undefined") T = json.T;
    if(typeof json.dt != "undefined") dt = json.dt;
    if(typeof json.w != "undefined") w = json.w;
    if(typeof json.a != "undefined") a = json.a;
    if(typeof json.f != "undefined") f = json.f;
    if(typeof json.nt != "undefined") nt = json.nt;
    if(typeof json.counterA != "undefined") counterA = json.counterA;
    if(typeof json.counterB != "undefined") counterB = json.counterB;
    if(typeof json.pointB != "undefined") pointB = json.pointB;
    if(typeof json.arraypointB != "undefined") arraypointB = json.arraypointB;
    if(typeof json.tpointB != "undefined") tpointB = json.tpointB;
    if(typeof json.tarraypointB != "undefined") tarraypointB = json.tarraypointB;
    if(typeof json.pointA != "undefined") pointA = json.pointA;
    if(typeof json.tpointA != "undefined") tpointA = json.tpointA;
    if(typeof json.arraypointA != "undefined") arraypointA = json.arraypointA;
    if(typeof json.tarraypointA != "undefined") tarraypointA = json.tarraypointA;
    if(typeof json.textA != "undefined") textA = json.textA;
    if(typeof json.textB != "undefined") textB = json.textB;
    if(typeof json.apointA != "undefined") apointA = json.apointA;
    if(typeof json.apointB != "undefined") apointB = json.apointB;
    if(typeof json.b != "undefined") b = json.b;
    if(typeof json.amplitude != "undefined") amplitude = json.amplitude;
    if(typeof json.frequency != "undefined") frequency = json.frequency;
    if(typeof json.potentialEnergy != "undefined") potentialEnergy = json.potentialEnergy;
    if(typeof json.kineticEnergy != "undefined") kineticEnergy = json.kineticEnergy;
    if(typeof json.totalEnergy != "undefined") totalEnergy = json.totalEnergy;
    if(typeof json.afrequency != "undefined") afrequency = json.afrequency;
    if(typeof json.Hertz != "undefined") Hertz = json.Hertz;
    if(typeof json.xmaxs != "undefined") xmaxs = json.xmaxs;
    if(typeof json.vmaxs != "undefined") vmaxs = json.vmaxs;
    if(typeof json.amaxs != "undefined") amaxs = json.amaxs;
    if(typeof json.Emaxs != "undefined") Emaxs = json.Emaxs;
    if(typeof json.selectedmodel != "undefined") selectedmodel = json.selectedmodel;
    if(typeof json.xmodel != "undefined") xmodel = json.xmodel;
    if(typeof json.showmodel != "undefined") showmodel = json.showmodel;
    if(typeof json.functionY != "undefined") functionY = json.functionY;
    if(typeof json.phi != "undefined") phi = json.phi;
    if(typeof json.Acalculated != "undefined") Acalculated = json.Acalculated;
    if(typeof json.solutionY != "undefined") solutionY = json.solutionY;
  };

  _model._readParametersPublic = function(json) {
    if(typeof json.xmin != "undefined") xmin = json.xmin;
    if(typeof json.xmax != "undefined") xmax = json.xmax;
    if(typeof json.ymin != "undefined") ymin = json.ymin;
    if(typeof json.ymax != "undefined") ymax = json.ymax;
    if(typeof json.rangex != "undefined") rangex = json.rangex;
    if(typeof json.rangey != "undefined") rangey = json.rangey;
    if(typeof json.sizex != "undefined") sizex = json.sizex;
    if(typeof json.sizey != "undefined") sizey = json.sizey;
    if(typeof json.selected != "undefined") selected = json.selected;
    if(typeof json.text != "undefined") text = json.text;
    if(typeof json.pi != "undefined") pi = json.pi;
    if(typeof json.y1 != "undefined") y1 = json.y1;
    if(typeof json.ysize != "undefined") ysize = json.ysize;
    if(typeof json.isAndroid != "undefined") isAndroid = json.isAndroid;
    if(typeof json.selectedview != "undefined") selectedview = json.selectedview;
    if(typeof json.iOS != "undefined") iOS = json.iOS;
    if(typeof json.iPad != "undefined") iPad = json.iPad;
    if(typeof json.iPhone != "undefined") iPhone = json.iPhone;
    if(typeof json.Width != "undefined") Width = json.Width;
    if(typeof json.Width1 != "undefined") Width1 = json.Width1;
    if(typeof json.Height != "undefined") Height = json.Height;
    if(typeof json.Width2 != "undefined") Width2 = json.Width2;
    if(typeof json.xvst != "undefined") xvst = json.xvst;
    if(typeof json.vvst != "undefined") vvst = json.vvst;
    if(typeof json.avst != "undefined") avst = json.avst;
    if(typeof json.world != "undefined") world = json.world;
    if(typeof json.graph != "undefined") graph = json.graph;
    if(typeof json.disabledworld != "undefined") disabledworld = json.disabledworld;
    if(typeof json.disabled != "undefined") disabled = json.disabled;
    if(typeof json.m != "undefined") m = json.m;
    if(typeof json.k != "undefined") k = json.k;
    if(typeof json.l != "undefined") l = json.l;
    if(typeof json.x != "undefined") x = json.x;
    if(typeof json.xs != "undefined") xs = json.xs;
    if(typeof json.y != "undefined") y = json.y;
    if(typeof json.vx != "undefined") vx = json.vx;
    if(typeof json.vxs != "undefined") vxs = json.vxs;
    if(typeof json.vxstored != "undefined") vxstored = json.vxstored;
    if(typeof json.t != "undefined") t = json.t;
    if(typeof json.tcst != "undefined") tcst = json.tcst;
    if(typeof json.X != "undefined") X = json.X;
    if(typeof json.T != "undefined") T = json.T;
    if(typeof json.dt != "undefined") dt = json.dt;
    if(typeof json.w != "undefined") w = json.w;
    if(typeof json.a != "undefined") a = json.a;
    if(typeof json.f != "undefined") f = json.f;
    if(typeof json.nt != "undefined") nt = json.nt;
    if(typeof json.counterA != "undefined") counterA = json.counterA;
    if(typeof json.counterB != "undefined") counterB = json.counterB;
    if(typeof json.pointB != "undefined") pointB = json.pointB;
    if(typeof json.arraypointB != "undefined") arraypointB = json.arraypointB;
    if(typeof json.tpointB != "undefined") tpointB = json.tpointB;
    if(typeof json.tarraypointB != "undefined") tarraypointB = json.tarraypointB;
    if(typeof json.pointA != "undefined") pointA = json.pointA;
    if(typeof json.tpointA != "undefined") tpointA = json.tpointA;
    if(typeof json.arraypointA != "undefined") arraypointA = json.arraypointA;
    if(typeof json.tarraypointA != "undefined") tarraypointA = json.tarraypointA;
    if(typeof json.textA != "undefined") textA = json.textA;
    if(typeof json.textB != "undefined") textB = json.textB;
    if(typeof json.apointA != "undefined") apointA = json.apointA;
    if(typeof json.apointB != "undefined") apointB = json.apointB;
    if(typeof json.b != "undefined") b = json.b;
    if(typeof json.amplitude != "undefined") amplitude = json.amplitude;
    if(typeof json.frequency != "undefined") frequency = json.frequency;
    if(typeof json.potentialEnergy != "undefined") potentialEnergy = json.potentialEnergy;
    if(typeof json.kineticEnergy != "undefined") kineticEnergy = json.kineticEnergy;
    if(typeof json.totalEnergy != "undefined") totalEnergy = json.totalEnergy;
    if(typeof json.afrequency != "undefined") afrequency = json.afrequency;
    if(typeof json.Hertz != "undefined") Hertz = json.Hertz;
    if(typeof json.xmaxs != "undefined") xmaxs = json.xmaxs;
    if(typeof json.vmaxs != "undefined") vmaxs = json.vmaxs;
    if(typeof json.amaxs != "undefined") amaxs = json.amaxs;
    if(typeof json.Emaxs != "undefined") Emaxs = json.Emaxs;
    if(typeof json.selectedmodel != "undefined") selectedmodel = json.selectedmodel;
    if(typeof json.xmodel != "undefined") xmodel = json.xmodel;
    if(typeof json.showmodel != "undefined") showmodel = json.showmodel;
    if(typeof json.functionY != "undefined") functionY = json.functionY;
    if(typeof json.phi != "undefined") phi = json.phi;
    if(typeof json.Acalculated != "undefined") Acalculated = json.Acalculated;
    if(typeof json.solutionY != "undefined") solutionY = json.solutionY;
  };

  function _unserializePublic(json) { return _model.unserializePublic(json); }

  _model._userUnserializePublic = function(json) {
    _model._readParametersPublic(json);
   _resetSolvers();
   _model.update();
  };

  function _unserialize(json) { return _model.unserialize(json); }

  _model._userUnserialize = function(json) {
    _model._readParameters(json);
   _resetSolvers();
   _model.update();
  };

  _model.addToReset(function() {
    __pagesEnabled["Init Page"] = true;
    __pagesEnabled["undefined"] = true;
    __pagesEnabled["svg"] = true;
    __pagesEnabled["drawaxes"] = true;
    __pagesEnabled["functionY"] = true;
    __pagesEnabled["Evol Page"] = true;
    __pagesEnabled["Event"] = true;
    __pagesEnabled["FixRel Page"] = true;
    __pagesEnabled["axes"] = true;
    __pagesEnabled["model"] = true;
    __pagesEnabled["FixRel Page 2"] = true;
  });

  _model.addToReset(function() {
    xmin = -2.5; // EjsS Model.Variables.Var Table.xmin
    xmax = 2.5; // EjsS Model.Variables.Var Table.xmax
    ymin = -0.5; // EjsS Model.Variables.Var Table.ymin
    ymax = 0.5; // EjsS Model.Variables.Var Table.ymax
    rangex = xmax-xmin; // EjsS Model.Variables.Var Table.rangex
    rangey = ymax-ymin; // EjsS Model.Variables.Var Table.rangey
    sizex = rangex/20; // EjsS Model.Variables.Var Table.sizex
    sizey = rangey/20; // EjsS Model.Variables.Var Table.sizey
    selected = new Array(1); // EjsS Model.Variables.Var Table.selected
    (function () {
      var _i0;
      for (_i0=0; _i0<1; _i0+=1) {  // EjsS Model.Variables.Var Table.selected
        selected[_i0] = "shm_with_xo=0,vo=1.257";  // EjsS Model.Variables.Var Table.selected
      }
    }());
    text = "select dropdown menu and \nclick play"; // EjsS Model.Variables.Var Table.text
    pi = Math.PI; // EjsS Model.Variables.Var Table.pi
    y1 = sizey*5/2; // EjsS Model.Variables.Var Table.y1
    ysize = 0.2; // EjsS Model.Variables.Var Table.ysize
  });

  _model.addToReset(function() {
    isAndroid = checkAndroid(); // EjsS Model.Variables.layout.isAndroid
    selectedview = new Array(1); // EjsS Model.Variables.layout.selectedview
    (function () {
      var _i0;
      for (_i0=0; _i0<1; _i0+=1) {  // EjsS Model.Variables.layout.selectedview
        selectedview[_i0] = "both";  // EjsS Model.Variables.layout.selectedview
      }
    }());
    iOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream; // EjsS Model.Variables.layout.iOS
    iPad = /iPad/.test(navigator.userAgent) && !window.MSStream; // EjsS Model.Variables.layout.iPad
    iPhone = /iPhone|iPod/.test(navigator.userAgent) && !window.MSStream; // EjsS Model.Variables.layout.iPhone
    Width = (_isEPub)?"400":"100%"; // EjsS Model.Variables.layout.Width
    Height = (_isEPub)?"500":"100%"; // EjsS Model.Variables.layout.Height
    xvst = true; // EjsS Model.Variables.layout.xvst
    vvst = false; // EjsS Model.Variables.layout.vvst
    avst = false; // EjsS Model.Variables.layout.avst
    world = true; // EjsS Model.Variables.layout.world
    graph = true; // EjsS Model.Variables.layout.graph
    disabledworld = false; // EjsS Model.Variables.layout.disabledworld
    disabled = false; // EjsS Model.Variables.layout.disabled
  });

  _model.addToReset(function() {
    m = 1; // EjsS Model.Variables.simplespring.m
    k = pi*pi/25; // EjsS Model.Variables.simplespring.k
    l = 0; // EjsS Model.Variables.simplespring.l
    x = 0; // EjsS Model.Variables.simplespring.x
    xs = x; // EjsS Model.Variables.simplespring.xs
    y = 0; // EjsS Model.Variables.simplespring.y
    vx = 0.1257; // EjsS Model.Variables.simplespring.vx
    vxs = 0; // EjsS Model.Variables.simplespring.vxs
    vxstored = 0; // EjsS Model.Variables.simplespring.vxstored
    t = 0; // EjsS Model.Variables.simplespring.t
    X = x-l; // EjsS Model.Variables.simplespring.X
    T = 2*pi*Math.sqrt(m/k); // EjsS Model.Variables.simplespring.T
    dt = T/100; // EjsS Model.Variables.simplespring.dt
    w = 2*pi/T; // EjsS Model.Variables.simplespring.w
    a = -w^2*x; // EjsS Model.Variables.simplespring.a
    nt = 10; // EjsS Model.Variables.simplespring.nt
    counterA = 0; // EjsS Model.Variables.simplespring.counterA
    counterB = 1; // EjsS Model.Variables.simplespring.counterB
    pointB = 0; // EjsS Model.Variables.simplespring.pointB
    arraypointB = new Array(nt); // EjsS Model.Variables.simplespring.arraypointB
    (function () {
      var _i0;
      for (_i0=0; _i0<nt; _i0+=1) {  // EjsS Model.Variables.simplespring.arraypointB
        arraypointB[_i0] = 0;  // EjsS Model.Variables.simplespring.arraypointB
      }
    }());
    tpointB = 0; // EjsS Model.Variables.simplespring.tpointB
    tarraypointB = new Array(nt); // EjsS Model.Variables.simplespring.tarraypointB
    (function () {
      var _i0;
      for (_i0=0; _i0<nt; _i0+=1) {  // EjsS Model.Variables.simplespring.tarraypointB
        tarraypointB[_i0] = 0;  // EjsS Model.Variables.simplespring.tarraypointB
      }
    }());
    pointA = 0; // EjsS Model.Variables.simplespring.pointA
    tpointA = 0; // EjsS Model.Variables.simplespring.tpointA
    arraypointA = new Array(nt); // EjsS Model.Variables.simplespring.arraypointA
    (function () {
      var _i0;
      for (_i0=0; _i0<nt; _i0+=1) {  // EjsS Model.Variables.simplespring.arraypointA
        arraypointA[_i0] = 0;  // EjsS Model.Variables.simplespring.arraypointA
      }
    }());
    tarraypointA = new Array(nt); // EjsS Model.Variables.simplespring.tarraypointA
    (function () {
      var _i0;
      for (_i0=0; _i0<nt; _i0+=1) {  // EjsS Model.Variables.simplespring.tarraypointA
        tarraypointA[_i0] = 0;  // EjsS Model.Variables.simplespring.tarraypointA
      }
    }());
    textA = new Array(nt); // EjsS Model.Variables.simplespring.textA
    (function () {
      var _i0;
      for (_i0=0; _i0<nt; _i0+=1) {  // EjsS Model.Variables.simplespring.textA
        textA[_i0] = "";  // EjsS Model.Variables.simplespring.textA
      }
    }());
    textB = new Array(nt); // EjsS Model.Variables.simplespring.textB
    (function () {
      var _i0;
      for (_i0=0; _i0<nt; _i0+=1) {  // EjsS Model.Variables.simplespring.textB
        textB[_i0] = "";  // EjsS Model.Variables.simplespring.textB
      }
    }());
    apointA = -k/m*(pointA-l); // EjsS Model.Variables.simplespring.apointA
    apointB = -k/m*(pointB-l); // EjsS Model.Variables.simplespring.apointB
  });

  _model.addToReset(function() {
    b = 0; // EjsS Model.Variables.advancedspring.b
    amplitude = 0.5; // EjsS Model.Variables.advancedspring.amplitude
    frequency = 0; // EjsS Model.Variables.advancedspring.frequency
    potentialEnergy = 0; // EjsS Model.Variables.advancedspring.potentialEnergy
    kineticEnergy = 0; // EjsS Model.Variables.advancedspring.kineticEnergy
    totalEnergy = 0; // EjsS Model.Variables.advancedspring.totalEnergy
    afrequency = 0; // EjsS Model.Variables.advancedspring.afrequency
    Hertz = 0; // EjsS Model.Variables.advancedspring.Hertz
  });

  _model.addToReset(function() {
    xmaxs = 3; // EjsS Model.Variables.max.xmaxs
    vmaxs = 2; // EjsS Model.Variables.max.vmaxs
    amaxs = 2; // EjsS Model.Variables.max.amaxs
    Emaxs = 2; // EjsS Model.Variables.max.Emaxs
  });

  _model.addToReset(function() {
    selectedmodel = new Array(1); // EjsS Model.Variables.functionY.selectedmodel
    (function () {
      var _i0;
      for (_i0=0; _i0<1; _i0+=1) {  // EjsS Model.Variables.functionY.selectedmodel
        selectedmodel[_i0] = "0";  // EjsS Model.Variables.functionY.selectedmodel
      }
    }());
    xmodel = 0; // EjsS Model.Variables.functionY.xmodel
    functionY = "0"; // EjsS Model.Variables.functionY.functionY
    phi = Math.atan(-(w*x)/vxs); // EjsS Model.Variables.functionY.phi
    Acalculated = Math.sqrt(xs*xs+vxs/(w)*vxs/(w)); // EjsS Model.Variables.functionY.Acalculated
  });

  if (_inputParameters) {
    _inputParameters = _model.parseInputParameters(_inputParameters);
    if (_inputParameters) _model.addToReset(function() { _model._readParameters(_inputParameters); });
  }

  _model.addToReset(function() {
    _privateOdesList=[];
    _ODEi_evolution1 = _ODE_evolution1();
    _privateOdesList.push(_ODEi_evolution1);
  });

  _model.addToReset(function() {
    _model.setAutoplay(false);
    _model.setPauseOnPageExit(true);
    _model.setFPS(20);
    _model.setStepsPerDisplay(1);
  });

  function externalForce (time) {  // > CustomCode.Lib Page:1
  return amplitude * Math.sin(2*pi*Hertz *time);  // > CustomCode.Lib Page:2
  }  // > CustomCode.Lib Page:3
  /*  // > CustomCode.Lib Page:4
  public double externalForce (double time) {  // > CustomCode.Lib Page:5
  return amplitude * Math.sin(frequency*time);  // > CustomCode.Lib Page:6
  }  // > CustomCode.Lib Page:7
  */  // > CustomCode.Lib Page:8

  function changeOrientation() {  // > CustomCode.changeOrientation:1
     // > CustomCode.changeOrientation:2
  var k =0.98 ; // k control height 1 is for full screen, 0.9 shorten etc  // > CustomCode.changeOrientation:3
  // check platform for Apps  // > CustomCode.changeOrientation:4
  var iOSapp =  (typeof parent.device != 'undefined' && parent.device.platform == "iOS");  // > CustomCode.changeOrientation:5
  var Androidapp = (typeof parent.device != 'undefined' && parent.device.platform == "Android");  // > CustomCode.changeOrientation:6
     // > CustomCode.changeOrientation:7
  // check platform for web browsers  // > CustomCode.changeOrientation:8
  var iOS =/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;  // > CustomCode.changeOrientation:9
  var iPad =/iPad/.test(navigator.userAgent) && !window.MSStream;  // > CustomCode.changeOrientation:10
  var iPhone = /iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;  // > CustomCode.changeOrientation:11
  var Android= /Android|android/i.test(navigator.userAgent);  // > CustomCode.changeOrientation:12
     // > CustomCode.changeOrientation:13
     // > CustomCode.changeOrientation:14
  switch (window.orientation) {  // > CustomCode.changeOrientation:15
    case 0:  // > CustomCode.changeOrientation:16
    case 180:  // > CustomCode.changeOrientation:17
      this.screenOrientation = 'portrait';  // > CustomCode.changeOrientation:18
      if (iOSapp){ // does not seems to work  // > CustomCode.changeOrientation:19
        //   return Math.max(window.screen.width,window.screen.height)*0.9;  // > CustomCode.changeOrientation:20
        return window.screen.height*0.8;  //0.1 for app and 0.1 for nonfullscreenapp    // > CustomCode.changeOrientation:21
        // return window.screen.height;  // > CustomCode.changeOrientation:22
        //  return window.innerHeight;  // > CustomCode.changeOrientation:23
        // return document.documentElement.clientHeight;  // > CustomCode.changeOrientation:24
      }  // > CustomCode.changeOrientation:25
        // > CustomCode.changeOrientation:26
      else {  // > CustomCode.changeOrientation:27
        // return Math.max(window.innerWidth,window.innerHeight)*0.9;  // > CustomCode.changeOrientation:28
        return window.innerHeight*k;  // > CustomCode.changeOrientation:29
      }  // > CustomCode.changeOrientation:30
      break;  // > CustomCode.changeOrientation:31
    case 90:  // > CustomCode.changeOrientation:32
    case -90:  // > CustomCode.changeOrientation:33
      this.screenOrientation = 'landscape';  // > CustomCode.changeOrientation:34
     // > CustomCode.changeOrientation:35
      if (iOSapp){ // App  // > CustomCode.changeOrientation:36
        return window.screen.width*0.8;    // > CustomCode.changeOrientation:37
        // return window.screen.height;  // > CustomCode.changeOrientation:38
        //  return window.innerHeight;  // > CustomCode.changeOrientation:39
        //  return document.documentElement.clientHeight;  // > CustomCode.changeOrientation:40
      }  // > CustomCode.changeOrientation:41
        // > CustomCode.changeOrientation:42
      else { // browser Android and PC  // > CustomCode.changeOrientation:43
        // return Math.min(window.innerWidth,window.innerHeight)*0.9;  // > CustomCode.changeOrientation:44
        // alert("browser Android and PC");  // > CustomCode.changeOrientation:45
        return window.innerHeight*k;  // > CustomCode.changeOrientation:46
      }  // > CustomCode.changeOrientation:47
      break;  // > CustomCode.changeOrientation:48
    default:  // > CustomCode.changeOrientation:49
      this.screenOrientation = 'unknown';  // > CustomCode.changeOrientation:50
      //       return (iPad)?""+(window.screen.width+window.screen.height)*0.4:((iPhone)?""+window.screen.width:_view._format(window.innerHeight*0.9,"0"));  // > CustomCode.changeOrientation:51
      return window.innerHeight*k;  // > CustomCode.changeOrientation:52
  }  // > CustomCode.changeOrientation:53
     // > CustomCode.changeOrientation:54
  }  // > CustomCode.changeOrientation:55
     // > CustomCode.changeOrientation:56

  //code reference: http://davidwalsh.name/detect-android  // > CustomCode.android:1
  function checkAndroid () {  // > CustomCode.android:2
    var ua = navigator.userAgent.toLowerCase();  // > CustomCode.android:3
    return ua.indexOf("android") > -1; //&& ua.indexOf("mobile");  // > CustomCode.android:4
  }  // > CustomCode.android:5

  //https://developer.mozilla.org/en-US/docs/Web/Guide/API/DOM/Using_full_screen_mode  // > CustomCode.fullscreen:1
  // does not work for iOS   // > CustomCode.fullscreen:2
  /*jslint browser:true */  // > CustomCode.fullscreen:3
  function toggleFullScreen() {  // > CustomCode.fullscreen:4
    if (!document.fullscreenElement &&    // alternative standard method  // > CustomCode.fullscreen:5
        !document.mozFullScreenElement && !document.webkitFullscreenElement && !document.msFullscreenElement ) {  // current working methods  // > CustomCode.fullscreen:6
      if (document.documentElement.requestFullscreen) {  // > CustomCode.fullscreen:7
        document.documentElement.requestFullscreen();  // > CustomCode.fullscreen:8
      } else if (document.documentElement.msRequestFullscreen) {  // > CustomCode.fullscreen:9
        document.documentElement.msRequestFullscreen();  // > CustomCode.fullscreen:10
      } else if (document.documentElement.mozRequestFullScreen) {  // > CustomCode.fullscreen:11
        document.documentElement.mozRequestFullScreen();  // > CustomCode.fullscreen:12
      } else if (document.documentElement.webkitRequestFullscreen) {  // > CustomCode.fullscreen:13
        document.documentElement.webkitRequestFullscreen();  // > CustomCode.fullscreen:14
      }  // > CustomCode.fullscreen:15
    } else {  // > CustomCode.fullscreen:16
      if (document.exitFullscreen) {  // > CustomCode.fullscreen:17
        document.exitFullscreen();  // > CustomCode.fullscreen:18
      } else if (document.msExitFullscreen) {  // > CustomCode.fullscreen:19
        document.msExitFullscreen();  // > CustomCode.fullscreen:20
      } else if (document.mozCancelFullScreen) {  // > CustomCode.fullscreen:21
        document.mozCancelFullScreen();  // > CustomCode.fullscreen:22
      } else if (document.webkitExitFullscreen) {  // > CustomCode.fullscreen:23
        document.webkitExitFullscreen();  // > CustomCode.fullscreen:24
      }  // > CustomCode.fullscreen:25
    }  // > CustomCode.fullscreen:26
  }  // > CustomCode.fullscreen:27

  _model.addToInitialization(function() {
    if (!__pagesEnabled["Init Page"]) return;
        // > Initialization.Init Page:1
      xs = x; // loop to find x stored  // > Initialization.Init Page:2
      vxs=vx;  // > Initialization.Init Page:3
    // for labels X and Y  // > Initialization.Init Page:4
    counterA = 0;  // > Initialization.Init Page:5
    if ( x >0) {  // > Initialization.Init Page:6
      pointA = x;  // > Initialization.Init Page:7
      for (var counter=0; counter<nt /* Iterations */ ; counter++) {  // > Initialization.Init Page:8
      arraypointA[counter] = pointA;  // > Initialization.Init Page:9
    }  // > Initialization.Init Page:10
      pointB = -pointA;  // > Initialization.Init Page:11
      }  // > Initialization.Init Page:12
      else if ( x <0) {  // > Initialization.Init Page:13
      pointB = x;  // > Initialization.Init Page:14
      for (var counter=0; counter<nt /* Iterations */ ; counter++) {  // > Initialization.Init Page:15
      arraypointB[counter] = pointB;  // > Initialization.Init Page:16
    }  // > Initialization.Init Page:17
      pointA = -pointB;  // > Initialization.Init Page:18
      }  // > Initialization.Init Page:19
  });

  _model.addToInitialization(function() {
    if (!__pagesEnabled["undefined"]) return;
    if (Width1==undefined){   // > Initialization.undefined:1
      Width1="100%";  // > Initialization.undefined:2
      }  // > Initialization.undefined:3
      if (Width2==undefined){   // > Initialization.undefined:4
      Width2="0%";  // > Initialization.undefined:5
      }  // > Initialization.undefined:6
  });

  _model.addToInitialization(function() {
    if (!__pagesEnabled["svg"]) return;
    var container = document.createElement('div');  // > Initialization.svg:1
    var svggradient = '<svg xmlns="http://www.w3.org/2000/svg" version="1.1"><defs>'+  // > Initialization.svg:2
      '  <radialGradient id="mygrandient" cx="50%" cy="50%" r="80%" fx="30%" fy="30%">'+  // > Initialization.svg:3
      '    <stop offset="0%" style="stop-color:rgb(0,255,255); stop-opacity:1" />'+  // > Initialization.svg:4
      '    <stop offset="100%" style="stop-color:rgb(0,0,255);stop-opacity:1" />'+  // > Initialization.svg:5
      '  </radialGradient>'+  // > Initialization.svg:6
      '</defs></svg>';  // > Initialization.svg:7
    container.innerHTML = svggradient;  // > Initialization.svg:8
    document.body.appendChild(container);  // > Initialization.svg:9
    //"url(#mygrandient)"  // > Initialization.svg:10
  });

  _model.addToInitialization(function() {
    if (!__pagesEnabled["drawaxes"]) return;
    _view.plottingPanelxvst.getAxisY().setScalePrecision(2);  // > Initialization.drawaxes:1
    //_view.plottingPanelxvst.getAxisY().setScalePrecision(3);  // > Initialization.drawaxes:2
    _view.plottingPanel.getAxisX().setPosition([0,0.2]);  // > Initialization.drawaxes:3
    _view.plottingPanel.getTitleX().setPosition([0.48,0.225]);  // > Initialization.drawaxes:4
    _view.plottingPanelxvst.getAxisX().setPosition([0,0.5]);  // > Initialization.drawaxes:5
    _view.plottingPanelxvst.getTitleX().setPosition([0.95,0.5]);  // > Initialization.drawaxes:6
    _view.plottingPanelxvst.getAxisY().setPosition([0.045,0]);  // > Initialization.drawaxes:7
    _view.plottingPanelxvst.getTitleY().setPosition([0.11,0.85]);  // > Initialization.drawaxes:8
  });

  _model.addToInitialization(function() {
    if (!__pagesEnabled["functionY"]) return;
    phi=Math.atan((w*x)/vxs);  // > Initialization.functionY:1
    Acalculated =Math.sqrt(xs*xs+vxs/(w)*vxs/(w));  // > Initialization.functionY:2
    /*  // > Initialization.functionY:3
    "hint: X = "+_view._format(Acalculated,"0.0")+"*sin(" +_view._format(w,"0.00")+"*t+("+_view._format(phi,"0.00")+"))"  // > Initialization.functionY:4
    "hint: V = ("+_view._format(Acalculated,"0.0")+")*("+_view._format(w,"0.00")+")*cos(" +_view._format(w,"0.00")+"*t+("+_view._format(phi,"0.00")+"))"  // > Initialization.functionY:5
    "hint: A = -("+_view._format(Acalculated,"0.0")+")*("+_view._format(w,"0.00")+")*("+_view._format(w,"0.00")+")*sin(" +_view._format(w,"0.00")+"*t+("+_view._format(phi,"0.00")+"))"  // > Initialization.functionY:6
    "hint V = ("+_view._format(w,"0.0")+")*sqrt("+_view._format(Acalculated,"0.0")+"^2 -  x^2) "  // > Initialization.functionY:7
    "hint V = -("+_view._format(w,"0.0")+")*sqrt("+_view._format(Acalculated,"0.0")+"^2 -  x^2) "  // > Initialization.functionY:8
    "hint: A = -"+_view._format(w,"0.00")+"*x"  // > Initialization.functionY:9
    */  // > Initialization.functionY:10
  });

  _model.addToInitialization(function() {
    _initializeSolvers();
  });

  _model.addToEvolution(function() {
    if (!__pagesEnabled["Evol Page"]) return;
    _ODEi_evolution1.step();
  });

  _model.addToFixedRelations(function() { _isPaused = _model.isPaused(); _isPlaying = _model.isPlaying(); });

  _model.addToFixedRelations(function() {
    if (!__pagesEnabled["FixRel Page"]) return;
    a=-k/m*(x-l) - b*vx/m + externalForce(t)/m;  // > FixedRelations.FixRel Page:1
    potentialEnergy = 0.5*k*(x-l)*(x-l); // PE = 0.5*k*x^2  // > FixedRelations.FixRel Page:2
    kineticEnergy = 0.5*m*vx*vx;  // KE = 0.5*m*v^2  // > FixedRelations.FixRel Page:3
    totalEnergy = potentialEnergy + kineticEnergy; // TE = KE+ PE  // > FixedRelations.FixRel Page:4
    T= 2*pi*Math.sqrt(m/k);  // > FixedRelations.FixRel Page:5
    f = 1/T;  // > FixedRelations.FixRel Page:6
    w = 2*pi/T;  // > FixedRelations.FixRel Page:7
  });

  _model.addToFixedRelations(function() {
    if (!__pagesEnabled["axes"]) return;
    if (_model.isPlaying()===true) { //NEED this for conflict with initialize page values  // > FixedRelations.axes:1
    _view.plottingPanelxvst.getAxisX().setAbsoluteY(_view.plottingPanelxvst.getGrid().getFixedTickY());  // > FixedRelations.axes:2
    _view.plottingPanelxvst.getAxisY().setAbsoluteX(_view.plottingPanelxvst.getGrid().getFixedTickX());  // > FixedRelations.axes:3
    }  // > FixedRelations.axes:4
  });

  _model.addToFixedRelations(function() {
    if (!__pagesEnabled["model"]) return;
    xmodel=_view.fField.evaluate({ t : t, x : xmodel });   // > FixedRelations.model:1
  });

  _model.addToFixedRelations(function() {
    if (!__pagesEnabled["FixRel Page 2"]) return;
    if(vx*vxstored<0&&vx<0){  // > FixedRelations.FixRel Page 2:1
     pointA = Math.max(pointA,Math.abs(x-l));  // > FixedRelations.FixRel Page 2:2
     tpointA = t;  // > FixedRelations.FixRel Page 2:3
      counterA = counterA+1;  // > FixedRelations.FixRel Page 2:4
      tarraypointA[counterA] = t;  // > FixedRelations.FixRel Page 2:5
      arraypointA[counterA]=pointA;  // > FixedRelations.FixRel Page 2:6
      textA[counterA] = "A";  // > FixedRelations.FixRel Page 2:7
    //    textA[counterA] = "A"+counterA ;  // > FixedRelations.FixRel Page 2:8
    }  // > FixedRelations.FixRel Page 2:9
    else if(vx*vxstored<0&&vx>0){  // > FixedRelations.FixRel Page 2:10
     pointB =-Math.max(pointA,Math.abs(x-l));   // > FixedRelations.FixRel Page 2:11
     tpointB = t;  // > FixedRelations.FixRel Page 2:12
      counterB = counterB+1;  // > FixedRelations.FixRel Page 2:13
      tarraypointB[counterB] = t;  // > FixedRelations.FixRel Page 2:14
      arraypointB[counterB]=pointB;  // > FixedRelations.FixRel Page 2:15
     // textB[counterB] = "B"+counterB ;  // > FixedRelations.FixRel Page 2:16
     textB[counterB] = "B";  // > FixedRelations.FixRel Page 2:17
    }  // > FixedRelations.FixRel Page 2:18
    // else T1[nc]=t*2.;// first half period  // > FixedRelations.FixRel Page 2:19
    vxstored = vx; // to store value of omega  // > FixedRelations.FixRel Page 2:20
  });

  _model.addToFixedRelations(function() { _isPaused = _model.isPaused(); _isPlaying = _model.isPlaying(); });

  function _initializeSolvers() {
    for (var i=0,n=_privateOdesList.length; i<n; i++) _privateOdesList[i].initializeSolver();
  }

  function _automaticResetSolvers() {
    for (var i=0,n=_privateOdesList.length; i<n; i++) _privateOdesList[i].automaticResetSolver();
  }

  _model.resetSolvers = function() {
    for (var i=0,n=_privateOdesList.length; i<n; i++) _privateOdesList[i].resetSolver();
  };

  function _getODE(_odeName) {
    if (_odeName=="Evol Page") return _ODEi_evolution1;
    return null;
  }

  function _getEventSolver(_odeName) {
    var ode = _getODE(_odeName);
    if (ode===null) return null;
    return ode.getEventSolver();
  }

  function _setSolverClass(_odeName, _engine) {
    var ode = _getODE(_odeName);
    if (ode===null) return;
    if (!_engine.setODE) {
      var classname = _engine.toLowerCase();
      if      (classname.indexOf("boga")>=0)   _engine = EJSS_ODE_SOLVERS.bogackiShampine23;
      else if (classname.indexOf("cash")>=0)   _engine = EJSS_ODE_SOLVERS.cashKarp45;
      else if (classname.indexOf("dopri5")>=0) _engine = EJSS_ODE_SOLVERS.dopri5;
      else if (classname.indexOf("dopri8")>=0) _engine = EJSS_ODE_SOLVERS.dopri853;
      else if (classname.indexOf("richa")>=0)  _engine = EJSS_ODE_SOLVERS.eulerRichardson;
      else if (classname.indexOf("euler")>=0)  _engine = EJSS_ODE_SOLVERS.euler;
      else if (classname.indexOf("fehlberg87")>=0) _engine = EJSS_ODE_SOLVERS.fehlberg87;
      else if (classname.indexOf("fehlberg8")>=0)  _engine = EJSS_ODE_SOLVERS.fehlberg8;
      else if (classname.indexOf("radau")>=0)   _engine = EJSS_ODE_SOLVERS.radau5;
      else if (classname.indexOf("runge")>=0)  _engine = EJSS_ODE_SOLVERS.rungeKutta4;
      else if (classname.indexOf("rk4")>=0)    _engine = EJSS_ODE_SOLVERS.rungeKutta4;
      else if (classname.indexOf("verlet")>=0) _engine = EJSS_ODE_SOLVERS.velocityVerlet;
    }
    if (_engine) ode.setSolverClass(_engine);
  }

  function _ODE_evolution1() {
    var __odeSelf = {};
    var __eventSolver;
    var __solverClass = EJSS_ODE_SOLVERS.rungeKutta4;
    var __state=[];
    var _ODE_evolution1_Event1;
    var __ignoreErrors=false;
    var __mustInitialize=true;
    var __isEnabled=true;
    var __mustUserReinitialize=false;
    var __mustReinitialize=true;


    __odeSelf.setSolverClass = function(__aSolverClass) {
      __solverClass = __aSolverClass;
      __instantiateSolver();
    };

    function __instantiateSolver() {
      __state=[];
      __pushState();
      __eventSolver = EJSS_ODE_SOLVERS.interpolatorEventSolver(__solverClass(),__odeSelf);
      __mustInitialize = true;
    }

    __odeSelf.setEnabled = function(_enabled) { __isEnabled = _enabled; };

    __odeSelf.getIndependentVariableValue = function() { return __eventSolver.getIndependentVariableValue(); };

    __odeSelf.getInternalStepSize = function() { return __eventSolver.getInternalStepSize(); };

    __odeSelf.isAccelerationIndependentOfVelocity = function() { return false; };

    __odeSelf.initializeSolver = function() {
      if (__arraysChanged()) { __instantiateSolver(); __odeSelf.initializeSolver(); return; }
      __pushState();
      __eventSolver.initialize(dt);
      __eventSolver.setBestInterpolation(false);
      __eventSolver.setMaximumInternalSteps(10000);
      __eventSolver.removeAllEvents();
      if (__pagesEnabled["Event"]) __eventSolver.addEvent(_ODE_evolution1_Event1());
      __eventSolver.setEstimateFirstStep(false);
      __eventSolver.setEnableExceptions(false);
      __eventSolver.setTolerances(0.00001,0.00001);
      __mustReinitialize = true;
      __mustInitialize = false;
    };

    function __pushState() {
      // Copy our variables to __state[] 
        var __j=0;
        var __n=0;
        var __cIn=0;
        if (__state[__cIn]!=x) __mustReinitialize = true;
        __state[__cIn++] = x;
        if (__state[__cIn]!=vx) __mustReinitialize = true;
        __state[__cIn++] = vx;
        if (__state[__cIn]!=t) __mustReinitialize = true;
        __state[__cIn++] = t;
    }

    function __arraysChanged () {
      return false;
    }

    __odeSelf.getEventSolver = function() {
      return __eventSolver;
    };

    __odeSelf.resetSolver = function() {
      __mustUserReinitialize = true;
    };

    __odeSelf.automaticResetSolver = function() {
      __mustReinitialize = true;
    };

    function __errorAction () {
      if (__ignoreErrors) return;
      console.log (__eventSolver.getErrorMessage());
      _pause();
      // Make sure the solver is reinitialized;
      __mustReinitialize = true;
    }

    __odeSelf.step = function() { return __privateStep(false); };

    __odeSelf.solverStep = function() { return __privateStep(true); };

    function __privateStep(__takeMaximumStep) {
      if (!__isEnabled) return 0;
      if (dt===0) return 0;
      if (__mustInitialize) __odeSelf.initializeSolver();
      if (__arraysChanged()) { __instantiateSolver(); __odeSelf.initializeSolver(); }
      __eventSolver.setStepSize(dt);
      __eventSolver.setInternalStepSize(dt);
      __eventSolver.setMaximumInternalSteps(10000);
      __eventSolver.setTolerances(0.00001,0.00001);
      __pushState();
      if (__mustUserReinitialize) { 
        __eventSolver.userReinitialize();
        __mustUserReinitialize = false;
        __mustReinitialize = false;
        if (__eventSolver.getErrorCode()!=EJSS_ODE_SOLVERS.ERROR.NO_ERROR) __errorAction();
      }
      else if (__mustReinitialize) { 
        __eventSolver.reinitialize();
        __mustReinitialize = false;
        if (__eventSolver.getErrorCode()!=EJSS_ODE_SOLVERS.ERROR.NO_ERROR) __errorAction();
      }
      var __stepTaken = __takeMaximumStep ? __eventSolver.maxStep() : __eventSolver.step();
      // Extract our variables from __state
        var __i=0;
        var __cOut=0;
        x = __state[__cOut++];
        vx = __state[__cOut++];
        t = __state[__cOut++];
      // Check for error
      if (__eventSolver.getErrorCode()!=EJSS_ODE_SOLVERS.ERROR.NO_ERROR) __errorAction();
      return __stepTaken;
    }

    __odeSelf.getState = function() { return __state; };

    __odeSelf.getRate = function(_aState,_aRate) {
      // Extract our variables from _aState
        var __i=0;
        var __cOut=0;
        var x = _aState[__cOut++];
        var vx = _aState[__cOut++];
        var t = _aState[__cOut++];
      // Compute the rate
        var __cRate=0;
        _aRate[__cRate++] = vx; // Rate for ODE: Evol Page:x
        _aRate[__cRate++] = -k/m*(x-l) - b*vx/m + externalForce(t)/m; // Rate for ODE: Evol Page:vx
        _aRate[__cRate++] = 1; // independent variable
        return _aRate;
    }; //end of getRate

    _ODE_evolution1_Event1 = function() {
      var _eventSelf = {};

      _eventSelf.getTypeOfEvent = function() { return EJSS_ODE_SOLVERS.EVENT_TYPE.CROSSING_EVENT; };

      _eventSelf.getRootFindingMethod = function() { return EJSS_ODE_SOLVERS.EVENT_METHOD.BISECTION; };

      _eventSelf.getMaxIterations = function() { return 100; };

      _eventSelf.getTolerance = function() { return 1.0e-5; };

      _eventSelf.evaluate = function(_aState) { 
      // Extract our variables from _aState
        var __i=0;
        var __cOut=0;
        var x = _aState[__cOut++];
        var vx = _aState[__cOut++];
        var t = _aState[__cOut++];
        return t-T-0.0001;  // > Event zero-condition for page Evol Page:1
      };

      _eventSelf.action = function() { 
      // Extract our variables from __state
        var __i=0;
        var __cOut=0;
        x = __state[__cOut++];
        vx = __state[__cOut++];
        t = __state[__cOut++];
        var _returnValue = __userDefinedAction();
      // Copy our variables to __state[] 
        var __j=0;
        var __n=0;
        var __cIn=0;
        __state[__cIn++] = x;
        __state[__cIn++] = vx;
        __state[__cIn++] = t;
        return _returnValue;
      };

      function __userDefinedAction() {
        _pause();  // > Event action for page Evol Page:1
        return true;
      }

      return _eventSelf;
    }; // End of event

    __instantiateSolver();

    return __odeSelf;
  }

  function _historic_x(__time) {
    var __index = 0;
    return _ODEi_evolution1.getEventSolver().getStateHistory().interpolate(__time,__index);
  }

  function _historic_vx(__time) {
    var __index = 0 + 1;
    return _ODEi_evolution1.getEventSolver().getStateHistory().interpolate(__time,__index);
  }

    _model._resized = function(_width,_height) {
      _view._resized(_width,_height);
  }; // end of _resized
    _model._fontResized = function(iBase,iSize,iDelta) {
      _view._fontResized(iBase,iSize,iDelta);
  }; // end of _fontResized

  function _getViews() {
    var _viewsInfo = [];
    var _counter = 0;
    _viewsInfo[_counter++] = { name : "HtmlView Page", width : 800, height : 600 };
    return _viewsInfo;
  } // end of _getViews

  function _selectView(_viewNumber) {
    _view = null;
    _view = new SHM14_v2_View(_topFrame,_viewNumber,_libraryPath,_codebasePath);
    var _view_super_reset = _view._reset;
    _view._reset = function() {
      _view_super_reset();
      switch(_viewNumber) {
        case -10 : break; // make Lint happy
        default :
        case 0:
          _view.fullscreen.linkProperty("Height",  function() { return Height; }, function(_v) { Height = _v; } ); // HtmlView Page linking property 'Height' for element 'fullscreen'
          _view.fullscreen.linkProperty("Width",  function() { return Width; }, function(_v) { Width = _v; } ); // HtmlView Page linking property 'Width' for element 'fullscreen'
          _view.plottingPanel.linkProperty("Height",  function() { return changeOrientation(); }, function(_v) { changeOrientation() = _v; } ); // HtmlView Page linking property 'Height' for element 'plottingPanel'
          _view.plottingPanel.linkProperty("Width",  function() { return Width1; }, function(_v) { Width1 = _v; } ); // HtmlView Page linking property 'Width' for element 'plottingPanel'
          _view.plottingPanel.linkProperty("MaximumY",  function() { return ymax; }, function(_v) { ymax = _v; } ); // HtmlView Page linking property 'MaximumY' for element 'plottingPanel'
          _view.plottingPanel.linkProperty("MaximumX",  function() { return xmax; }, function(_v) { xmax = _v; } ); // HtmlView Page linking property 'MaximumX' for element 'plottingPanel'
          _view.plottingPanel.linkProperty("TRMessage",  function() { return _isMobile?"":"Spring (k=(Ï€^2)/25 N/m) - Mass (m=1 kg) \nModel  side view"; } ); // HtmlView Page linking property 'TRMessage' for element 'plottingPanel'
          _view.plottingPanel.linkProperty("MinimumX",  function() { return xmin; }, function(_v) { xmin = _v; } ); // HtmlView Page linking property 'MinimumX' for element 'plottingPanel'
          _view.plottingPanel.linkProperty("MinimumY",  function() { return ymin; }, function(_v) { ymin = _v; } ); // HtmlView Page linking property 'MinimumY' for element 'plottingPanel'
          _view.plottingPanel.linkProperty("Visibility",  function() { return world===true; } ); // HtmlView Page linking property 'Visibility' for element 'plottingPanel'
          _view.plottingPanel.linkProperty("TLMessage",  function() { return text; }, function(_v) { text = _v; } ); // HtmlView Page linking property 'TLMessage' for element 'plottingPanel'
          _view.plottingPanel.linkProperty("BRMessage",  function() { return "xo="+_view._format(pointA,"0.00") + "m," +"\nT="+_view._format(T,"0.00")+ "s,"+"\nf="+_view._format(f,"0.00")+ "1/s"+",\nÏ‰="+_view._format(w,"0.00")+ "rad/s ,"   +"\nt = "+_view._format(t,"0.00")+ " s "; } ); // HtmlView Page linking property 'BRMessage' for element 'plottingPanel'
          _view.leftwall.linkProperty("SizeX",  function() { return sizex; }, function(_v) { sizex = _v; } ); // HtmlView Page linking property 'SizeX' for element 'leftwall'
          _view.leftwall.linkProperty("X",  function() { return xmin; }, function(_v) { xmin = _v; } ); // HtmlView Page linking property 'X' for element 'leftwall'
          _view.leftwall.linkProperty("Y",  function() { return y; }, function(_v) { y = _v; } ); // HtmlView Page linking property 'Y' for element 'leftwall'
          _view.leftwall.linkProperty("SizeY",  function() { return sizey*5; } ); // HtmlView Page linking property 'SizeY' for element 'leftwall'
          _view.floor.linkProperty("SizeX",  function() { return -xmin; } ); // HtmlView Page linking property 'SizeX' for element 'floor'
          _view.floor.linkProperty("Y",  function() { return -sizey*5/2; } ); // HtmlView Page linking property 'Y' for element 'floor'
          _view.floor.linkProperty("SizeY",  function() { return ysize; }, function(_v) { ysize = _v; } ); // HtmlView Page linking property 'SizeY' for element 'floor'
          _view.floor2.linkProperty("SizeX",  function() { return xmax; }, function(_v) { xmax = _v; } ); // HtmlView Page linking property 'SizeX' for element 'floor2'
          _view.floor2.linkProperty("Y",  function() { return -sizey*5/2; } ); // HtmlView Page linking property 'Y' for element 'floor2'
          _view.floor2.linkProperty("SizeY",  function() { return ysize; }, function(_v) { ysize = _v; } ); // HtmlView Page linking property 'SizeY' for element 'floor2'
          _view.mass3.linkProperty("SizeX",  function() { return sizex*2; } ); // HtmlView Page linking property 'SizeX' for element 'mass3'
          _view.mass3.linkProperty("X",  function() { return x; }, function(_v) { x = _v; } ); // HtmlView Page linking property 'X' for element 'mass3'
          _view.mass3.linkProperty("Y",  function() { return y; }, function(_v) { y = _v; } ); // HtmlView Page linking property 'Y' for element 'mass3'
          _view.mass3.linkProperty("SizeY",  function() { return sizey*5; } ); // HtmlView Page linking property 'SizeY' for element 'mass3'
          _view.mass3.setAction("OnDrag", _initialize); // HtmlView Page setting action 'OnDrag' for element 'mass3'
          _view.svg.linkProperty("SizeX",  function() { return sizex*2; } ); // HtmlView Page linking property 'SizeX' for element 'svg'
          _view.svg.linkProperty("X",  function() { return x; }, function(_v) { x = _v; } ); // HtmlView Page linking property 'X' for element 'svg'
          _view.svg.linkProperty("Y",  function() { return y; }, function(_v) { y = _v; } ); // HtmlView Page linking property 'Y' for element 'svg'
          _view.svg.linkProperty("SizeY",  function() { return sizey*5; } ); // HtmlView Page linking property 'SizeY' for element 'svg'
          _view.svg.setAction("OnDrag", _initialize); // HtmlView Page setting action 'OnDrag' for element 'svg'
          _view.mass2.linkProperty("X",  function() { return x; }, function(_v) { x = _v; } ); // HtmlView Page linking property 'X' for element 'mass2'
          _view.mass2.linkProperty("Y",  function() { return y; }, function(_v) { y = _v; } ); // HtmlView Page linking property 'Y' for element 'mass2'
          _view.mass2.setAction("OnDrag", function(_data,_info) {
  x = Math.round(x*10)/10;
  vx=0;
  if (x <=-2) x = -2;
  if (x >=2) x = 2;
  //selected[0]="user_defined";
  _view.comboBox.setSelectedOptions(["user_defined"]);

}); // HtmlView Page setting action 'OnDrag' for element 'mass2'
          _view.model2.linkProperty("X",  function() { return xmodel; }, function(_v) { xmodel = _v; } ); // HtmlView Page linking property 'X' for element 'model2'
          _view.model2.linkProperty("Y",  function() { return y; }, function(_v) { y = _v; } ); // HtmlView Page linking property 'Y' for element 'model2'
          _view.model2.linkProperty("Visibility",  function() { return showmodel; }, function(_v) { showmodel = _v; } ); // HtmlView Page linking property 'Visibility' for element 'model2'
          _view.model2.setAction("OnDrag", _initialize); // HtmlView Page setting action 'OnDrag' for element 'model2'
          _view.arrow.linkProperty("SizeX",  function() { return x; }, function(_v) { x = _v; } ); // HtmlView Page linking property 'SizeX' for element 'arrow'
          _view.arrow.linkProperty("Y",  function() { return -sizey*5/1.5; } ); // HtmlView Page linking property 'Y' for element 'arrow'
          _view.arrow.linkProperty("Visibility",  function() { return xvst; }, function(_v) { xvst = _v; } ); // HtmlView Page linking property 'Visibility' for element 'arrow'
          _view.P.linkProperty("X",  function() { return x; }, function(_v) { x = _v; } ); // HtmlView Page linking property 'X' for element 'P'
          _view.P.linkProperty("Y",  function() { return y; }, function(_v) { y = _v; } ); // HtmlView Page linking property 'Y' for element 'P'
          _view.pointA.linkProperty("X",  function() { return pointA; }, function(_v) { pointA = _v; } ); // HtmlView Page linking property 'X' for element 'pointA'
          _view.pointA.linkProperty("Y",  function() { return y; }, function(_v) { y = _v; } ); // HtmlView Page linking property 'Y' for element 'pointA'
          _view.pointB2.linkProperty("X",  function() { return pointB; }, function(_v) { pointB = _v; } ); // HtmlView Page linking property 'X' for element 'pointB2'
          _view.pointB2.linkProperty("Y",  function() { return y; }, function(_v) { y = _v; } ); // HtmlView Page linking property 'Y' for element 'pointB2'
          _view.pointO.linkProperty("X",  function() { return l; }, function(_v) { l = _v; } ); // HtmlView Page linking property 'X' for element 'pointO'
          _view.pointO.linkProperty("Y",  function() { return y; }, function(_v) { y = _v; } ); // HtmlView Page linking property 'Y' for element 'pointO'
          _view.arrow22.linkProperty("SizeX",  function() { return a; }, function(_v) { a = _v; } ); // HtmlView Page linking property 'SizeX' for element 'arrow22'
          _view.arrow22.linkProperty("X",  function() { return x; }, function(_v) { x = _v; } ); // HtmlView Page linking property 'X' for element 'arrow22'
          _view.arrow22.linkProperty("Y",  function() { return sizey*5/1.5; } ); // HtmlView Page linking property 'Y' for element 'arrow22'
          _view.arrow22.linkProperty("Visibility",  function() { return avst; }, function(_v) { avst = _v; } ); // HtmlView Page linking property 'Visibility' for element 'arrow22'
          _view.x.linkProperty("X",  function() { return x; }, function(_v) { x = _v; } ); // HtmlView Page linking property 'X' for element 'x'
          _view.x.linkProperty("Y",  function() { return -sizey*5/1.5+0.01; } ); // HtmlView Page linking property 'Y' for element 'x'
          _view.x.linkProperty("Text",  function() { return "x = "+_view._format(x,"0.00")+ " m "; } ); // HtmlView Page linking property 'Text' for element 'x'
          _view.x.linkProperty("Visibility",  function() { return xvst; }, function(_v) { xvst = _v; } ); // HtmlView Page linking property 'Visibility' for element 'x'
          _view.velocity.linkProperty("SizeX",  function() { return vx; }, function(_v) { vx = _v; } ); // HtmlView Page linking property 'SizeX' for element 'velocity'
          _view.velocity.linkProperty("X",  function() { return x; }, function(_v) { x = _v; } ); // HtmlView Page linking property 'X' for element 'velocity'
          _view.velocity.linkProperty("Y",  function() { return y+sizey*5/2; } ); // HtmlView Page linking property 'Y' for element 'velocity'
          _view.velocity.linkProperty("Visibility",  function() { return vvst; }, function(_v) { vvst = _v; } ); // HtmlView Page linking property 'Visibility' for element 'velocity'
          _view.velocity.setAction("OnDrag", function(_data,_info) {
  vx = Math.round(vx*10)/10;
  selected[0]="user_defined";

}); // HtmlView Page setting action 'OnDrag' for element 'velocity'
          _view.v.linkProperty("X",  function() { return x; }, function(_v) { x = _v; } ); // HtmlView Page linking property 'X' for element 'v'
          _view.v.linkProperty("Y",  function() { return y+sizey*5/2+0.01; } ); // HtmlView Page linking property 'Y' for element 'v'
          _view.v.linkProperty("Text",  function() { return "v = "+_view._format(vx,"0.00")+ " m/s "; } ); // HtmlView Page linking property 'Text' for element 'v'
          _view.v.linkProperty("Visibility",  function() { return vvst; }, function(_v) { vvst = _v; } ); // HtmlView Page linking property 'Visibility' for element 'v'
          _view.a.linkProperty("X",  function() { return x; }, function(_v) { x = _v; } ); // HtmlView Page linking property 'X' for element 'a'
          _view.a.linkProperty("Y",  function() { return y+sizey*5/1.5+0.01; } ); // HtmlView Page linking property 'Y' for element 'a'
          _view.a.linkProperty("Text",  function() { return "a = "+_view._format(a,"0.00")+ " m/sÂ² "; } ); // HtmlView Page linking property 'Text' for element 'a'
          _view.a.linkProperty("Visibility",  function() { return avst; }, function(_v) { avst = _v; } ); // HtmlView Page linking property 'Visibility' for element 'a'
          _view.spring.linkProperty("Radius",  function() { return sizey*3; } ); // HtmlView Page linking property 'Radius' for element 'spring'
          _view.spring.linkProperty("SizeX",  function() { return -xmin+x-2*sizex; } ); // HtmlView Page linking property 'SizeX' for element 'spring'
          _view.spring.linkProperty("X",  function() { return xmin+sizex; } ); // HtmlView Page linking property 'X' for element 'spring'
          _view.spring2.linkProperty("Radius",  function() { return sizey*3; } ); // HtmlView Page linking property 'Radius' for element 'spring2'
          _view.spring2.linkProperty("SizeX",  function() { return -xmax+x+2*sizex-externalForce(t); } ); // HtmlView Page linking property 'SizeX' for element 'spring2'
          _view.spring2.linkProperty("X",  function() { return xmax-sizex+externalForce(t); } ); // HtmlView Page linking property 'X' for element 'spring2'
          _view.drivingforce.linkProperty("SizeX",  function() { return externalForce(t); } ); // HtmlView Page linking property 'SizeX' for element 'drivingforce'
          _view.drivingforce.linkProperty("X",  function() { return x; }, function(_v) { x = _v; } ); // HtmlView Page linking property 'X' for element 'drivingforce'
          _view.drivingforce.linkProperty("Y",  function() { return y+sizey; } ); // HtmlView Page linking property 'Y' for element 'drivingforce'
          _view.rightwallplunger2.linkProperty("SizeX",  function() { return sizex; }, function(_v) { sizex = _v; } ); // HtmlView Page linking property 'SizeX' for element 'rightwallplunger2'
          _view.rightwallplunger2.linkProperty("X",  function() { return xmax+externalForce(t); } ); // HtmlView Page linking property 'X' for element 'rightwallplunger2'
          _view.rightwallplunger2.linkProperty("Y",  function() { return y; }, function(_v) { y = _v; } ); // HtmlView Page linking property 'Y' for element 'rightwallplunger2'
          _view.rightwallplunger2.linkProperty("SizeY",  function() { return sizey*5; } ); // HtmlView Page linking property 'SizeY' for element 'rightwallplunger2'
          _view.plottingPanelxvst.linkProperty("Height",  function() { return changeOrientation(); }, function(_v) { changeOrientation() = _v; } ); // HtmlView Page linking property 'Height' for element 'plottingPanelxvst'
          _view.plottingPanelxvst.linkProperty("Width",  function() { return Width2; }, function(_v) { Width2 = _v; } ); // HtmlView Page linking property 'Width' for element 'plottingPanelxvst'
          _view.plottingPanelxvst.linkProperty("TRMessage",  function() { return "hint: X = "+_view._format(Acalculated,"0.0")+"*sin(" +_view._format(w,"0.00")+"*t+("+_view._format(phi,"0.00")+"))"+"\nhint: V = ("+_view._format(Acalculated,"0.0")+")*("+_view._format(w,"0.00")+")*cos(" +_view._format(w,"0.00")+"*t+("+_view._format(phi,"0.00")+"))"+"\nhint: A = -("+_view._format(Acalculated,"0.0")+")*("+_view._format(w,"0.00")+")*("+_view._format(w,"0.00")+")*sin(" +_view._format(w,"0.00")+"*t+("+_view._format(phi,"0.00")+"))"; } ); // HtmlView Page linking property 'TRMessage' for element 'plottingPanelxvst'
          _view.plottingPanelxvst.linkProperty("XTickStep",  function() { return T/4; } ); // HtmlView Page linking property 'XTickStep' for element 'plottingPanelxvst'
          _view.plottingPanelxvst.linkProperty("MaximumX",  function() { return T; }, function(_v) { T = _v; } ); // HtmlView Page linking property 'MaximumX' for element 'plottingPanelxvst'
          _view.plottingPanelxvst.linkProperty("Visibility",  function() { return graph===true; } ); // HtmlView Page linking property 'Visibility' for element 'plottingPanelxvst'
          _view.plottingPanelxvst.linkProperty("BLMessage",  function() { return ""+_view.plottingPanelxvst.getRealWorldYMax(); } ); // HtmlView Page linking property 'BLMessage' for element 'plottingPanelxvst'
          _view.plottingPanelxvst.linkProperty("BRMessage",  function() { return " x = " + _view._format(x,"0.00") + " m , " +"\nv = " + _view._format(vx,"0.00") + " m/s " +"\na = " + _view._format(a,"0.00") + " m/sÂ² "+" ,\nt = "+_view._format(t,"0.00")+ " s "; } ); // HtmlView Page linking property 'BRMessage' for element 'plottingPanelxvst'
          _view.analyticCurve.linkProperty("FunctionY",  function() { return functionY; }, function(_v) { functionY = _v; } ); // HtmlView Page linking property 'FunctionY' for element 'analyticCurve'
          _view.analyticCurve.linkProperty("Maximum",  function() { return Math.max(t,T); } ); // HtmlView Page linking property 'Maximum' for element 'analyticCurve'
          _view.trail.linkProperty("Active",  function() { return t>0; } ); // HtmlView Page linking property 'Active' for element 'trail'
          _view.trail.linkProperty("Connected",  function() { return t>0; } ); // HtmlView Page linking property 'Connected' for element 'trail'
          _view.trail.linkProperty("InputX",  function() { return t; }, function(_v) { t = _v; } ); // HtmlView Page linking property 'InputX' for element 'trail'
          _view.trail.linkProperty("Visibility",  function() { return xvst; }, function(_v) { xvst = _v; } ); // HtmlView Page linking property 'Visibility' for element 'trail'
          _view.trail.linkProperty("InputY",  function() { return x; }, function(_v) { x = _v; } ); // HtmlView Page linking property 'InputY' for element 'trail'
          _view.trailDot2.linkProperty("X",  function() { return t; }, function(_v) { t = _v; } ); // HtmlView Page linking property 'X' for element 'trailDot2'
          _view.trailDot2.linkProperty("Y",  function() { return x; }, function(_v) { x = _v; } ); // HtmlView Page linking property 'Y' for element 'trailDot2'
          _view.trailDot2.linkProperty("Visibility",  function() { return xvst; }, function(_v) { xvst = _v; } ); // HtmlView Page linking property 'Visibility' for element 'trailDot2'
          _view.arrow2.linkProperty("Visibility",  function() { return xvst; }, function(_v) { xvst = _v; } ); // HtmlView Page linking property 'Visibility' for element 'arrow2'
          _view.arrow2.linkProperty("SizeY",  function() { return x; }, function(_v) { x = _v; } ); // HtmlView Page linking property 'SizeY' for element 'arrow2'
          _view.P2.linkProperty("X",  function() { return t; }, function(_v) { t = _v; } ); // HtmlView Page linking property 'X' for element 'P2'
          _view.P2.linkProperty("Y",  function() { return x; }, function(_v) { x = _v; } ); // HtmlView Page linking property 'Y' for element 'P2'
          _view.pointA2.linkProperty("X",  function() { return tpointA; }, function(_v) { tpointA = _v; } ); // HtmlView Page linking property 'X' for element 'pointA2'
          _view.pointA2.linkProperty("Y",  function() { return pointA; }, function(_v) { pointA = _v; } ); // HtmlView Page linking property 'Y' for element 'pointA2'
          _view.textSetA.linkProperty("NumberOfElements",  function() { return nt; }, function(_v) { nt = _v; } ); // HtmlView Page linking property 'NumberOfElements' for element 'textSetA'
          _view.textSetA.linkProperty("X",  function() { return tarraypointA; }, function(_v) { tarraypointA = _v; } ); // HtmlView Page linking property 'X' for element 'textSetA'
          _view.textSetA.linkProperty("Y",  function() { return arraypointA; }, function(_v) { arraypointA = _v; } ); // HtmlView Page linking property 'Y' for element 'textSetA'
          _view.textSetA.linkProperty("Text",  function() { return textA; }, function(_v) { textA = _v; } ); // HtmlView Page linking property 'Text' for element 'textSetA'
          _view.textSetB.linkProperty("NumberOfElements",  function() { return nt; }, function(_v) { nt = _v; } ); // HtmlView Page linking property 'NumberOfElements' for element 'textSetB'
          _view.textSetB.linkProperty("X",  function() { return tarraypointB; }, function(_v) { tarraypointB = _v; } ); // HtmlView Page linking property 'X' for element 'textSetB'
          _view.textSetB.linkProperty("Y",  function() { return arraypointB; }, function(_v) { arraypointB = _v; } ); // HtmlView Page linking property 'Y' for element 'textSetB'
          _view.textSetB.linkProperty("Text",  function() { return textB; }, function(_v) { textB = _v; } ); // HtmlView Page linking property 'Text' for element 'textSetB'
          _view.pointB22.linkProperty("X",  function() { return tpointB; }, function(_v) { tpointB = _v; } ); // HtmlView Page linking property 'X' for element 'pointB22'
          _view.pointB22.linkProperty("Y",  function() { return pointB; }, function(_v) { pointB = _v; } ); // HtmlView Page linking property 'Y' for element 'pointB22'
          _view.pointO2.linkProperty("X",  function() { return t; }, function(_v) { t = _v; } ); // HtmlView Page linking property 'X' for element 'pointO2'
          _view.pointO2.linkProperty("Y",  function() { return l; }, function(_v) { l = _v; } ); // HtmlView Page linking property 'Y' for element 'pointO2'
          _view.trail2.linkProperty("Active",  function() { return t>0; } ); // HtmlView Page linking property 'Active' for element 'trail2'
          _view.trail2.linkProperty("Connected",  function() { return t>0; } ); // HtmlView Page linking property 'Connected' for element 'trail2'
          _view.trail2.linkProperty("InputX",  function() { return t; }, function(_v) { t = _v; } ); // HtmlView Page linking property 'InputX' for element 'trail2'
          _view.trail2.linkProperty("Visibility",  function() { return vvst; }, function(_v) { vvst = _v; } ); // HtmlView Page linking property 'Visibility' for element 'trail2'
          _view.trail2.linkProperty("InputY",  function() { return vx; }, function(_v) { vx = _v; } ); // HtmlView Page linking property 'InputY' for element 'trail2'
          _view.trailDot22.linkProperty("X",  function() { return t; }, function(_v) { t = _v; } ); // HtmlView Page linking property 'X' for element 'trailDot22'
          _view.trailDot22.linkProperty("Y",  function() { return vx; }, function(_v) { vx = _v; } ); // HtmlView Page linking property 'Y' for element 'trailDot22'
          _view.trailDot22.linkProperty("Visibility",  function() { return vvst; }, function(_v) { vvst = _v; } ); // HtmlView Page linking property 'Visibility' for element 'trailDot22'
          _view.trail3.linkProperty("Active",  function() { return t>0; } ); // HtmlView Page linking property 'Active' for element 'trail3'
          _view.trail3.linkProperty("Connected",  function() { return t>0; } ); // HtmlView Page linking property 'Connected' for element 'trail3'
          _view.trail3.linkProperty("InputX",  function() { return t; }, function(_v) { t = _v; } ); // HtmlView Page linking property 'InputX' for element 'trail3'
          _view.trail3.linkProperty("Visibility",  function() { return avst; }, function(_v) { avst = _v; } ); // HtmlView Page linking property 'Visibility' for element 'trail3'
          _view.trail3.linkProperty("InputY",  function() { return a; }, function(_v) { a = _v; } ); // HtmlView Page linking property 'InputY' for element 'trail3'
          _view.trailDot23.linkProperty("X",  function() { return t; }, function(_v) { t = _v; } ); // HtmlView Page linking property 'X' for element 'trailDot23'
          _view.trailDot23.linkProperty("Y",  function() { return a; }, function(_v) { a = _v; } ); // HtmlView Page linking property 'Y' for element 'trailDot23'
          _view.trailDot23.linkProperty("Visibility",  function() { return avst; }, function(_v) { avst = _v; } ); // HtmlView Page linking property 'Visibility' for element 'trailDot23'
          _view.xaxislabel.linkProperty("X",  function() { return T; }, function(_v) { T = _v; } ); // HtmlView Page linking property 'X' for element 'xaxislabel'
          _view.axesy2.linkProperty("SizeY",  function() { return _view.plottingPanelxvst.getRealWorldYMax(); } ); // HtmlView Page linking property 'SizeY' for element 'axesy2'
          _view.axesy.linkProperty("SizeY",  function() { return _view.plottingPanelxvst.getRealWorldYMax(); } ); // HtmlView Page linking property 'SizeY' for element 'axesy'
          _view.axes.linkProperty("SizeX",  function() { return Math.max(t, T*1.5); } ); // HtmlView Page linking property 'SizeX' for element 'axes'
          _view.comboBox.linkProperty("Options",  function() { return ["shm_with_xo=-2","shm_with_xo=-1","shm_with_xo=0,vo=1.257","shm_with_xo=0,vo=0.5236","shm_with_xo=0,vo=2","shm_with_xo=0,vo=6","shm_with_xo=1","shm_with_xo=1,vo=1","shm_with_xo=2","user_defined"]; } ); // HtmlView Page linking property 'Options' for element 'comboBox'
          _view.comboBox.setAction("OnChange", function(_data,_info) {
  var opts = _view.comboBox.getProperty("SelectedOptions");  // array of options
      var option = (opts.length > 0)? opts[0]:""; // selected option 
  if ( option=="user_defined"){
    
    }
  else if ( option=="shm_with_xo=-2"){
    x=-2;
    vx=0;
    }
    else if ( option=="shm_with_xo=-1"){
    x=-1;
    vx=0;
    }
  else if ( option=="shm_with_xo=1"){
    x=1;
    vx=0;
    }
     else if ( option=="shm_with_xo=0,vo=1.257"){
    x=0;
    vx=2*pi/10*2;
  }
      else if ( option=="shm_with_xo=0,vo=0.5236"){
    x=0;
    vx=2*pi/6*0.5;
  }
    else if ( option=="shm_with_xo=0,vo=2"){
    x=0;
    vx=2;
  }
  else if ( option=="shm_with_xo=0,vo=6"){
    x=0;
    vx=6;
  }
  else if ( option=="shm_with_xo=1,vo=1"){
    x=1;
    vx=1;
    }
  else if ( option=="shm_with_xo=2"){
    x=2;
  vx=0;
    }
    else if ( option=="no_damping,b=0.0"){
    b=0;
    }
    else if ( option=="light_damping,b=0.1"){
    b=0.1;
    }
    else if ( option=="critical_damping,b=2.0"){
    b=2.0;
    }
  else if ( option=="heavy_damping,b=5.0"){
    b=5.0;
    }
     else if ( option=="driving_force,fdriver=0.05"){
    x=0;
    amplitude=1.0;
  Hertz = 0.05;
     }
     else if ( option=="driving_force,fdriver=0.1"){
    x=0;
    amplitude=0.5;
  Hertz = 0.1;
    }
      else if ( option=="driving_force,fdriver=0.159,resonance"){
    x=0;
    amplitude=0.5;
  Hertz = 1.0/(2*pi);
    }
    else if ( option=="driving_force,fdriver=0.2"){
    x=0;
    amplitude=0.5;
  Hertz = 0.2;
    }
      else if ( option=="driving_force,fdriver=0.3"){
   x=0;
   amplitude=0.5;
  Hertz = 0.3;
    }
   
        else if ( option=="driving_force,fdriver=0.4"){
    amplitude=0.5;
  Hertz = 0.4;
    }
          else if ( option=="driving_force,fdriver=0.5"){
    x=0;
    amplitude=0.5;
  Hertz = 0.5;
    }
      else if ( option=="driving_force,fdriver=0.6"){
    amplitude=0.5;
  Hertz = 0.6;
    }
       else if ( option=="driving_force,fdriver=0.7"){
    x=0;
    amplitude=0.5;
  Hertz = 0.7;
    }
    else if ( option=="driving_force,fdriver=1.0"){
    x=0;
    amplitude=0.5;
  Hertz = 1.0;
    }
       else if ( option=="driving_force,fdriver=2.0"){
    x=0;
    amplitude=0.5;
  Hertz = 2.0;
    }
    else if ( option=="driving_force,fdriver=4.0"){
    amplitude=0.5;
  Hertz = 4.0;
    }
     else if ( option=="driving_force,fdriver=6.0"){
    amplitude=0.5;
  Hertz = 6.0;
    }
    else if ( option=="driving_force,fdriver=8.0"){
    x=0;
    amplitude=0.5;
  Hertz = 8.0;
    }
    else if ( option=="driving_force,fdriver=10.0"){
    x=0;
    amplitude=0.5;
  Hertz = 10.0;
    }
  else if ( option=="driving_force,fdriver=12.0"){
    x=0;
    amplitude=0.5;
  Hertz = 12.0;
    }
    if(parent.cordova) { // check it is running in Android
  //var option1 = _view.comboBox.getProperty("SelectedOptions");
         parent.TTS.speak(option, function () {
              // success
          }, function (reason) {
              // error
          });
      }
      else {
    var msg = new SpeechSynthesisUtterance(option);
  window.speechSynthesis.speak(msg);
  }

}); // HtmlView Page setting action 'OnChange' for element 'comboBox'
          _view.worldgraph.linkProperty("Options",  function() { return ["world","graph only","both","x vs t","x vs t off","v vs t","v vs t off","a vs t","a vs t off","","show model","hide model"]; } ); // HtmlView Page linking property 'Options' for element 'worldgraph'
          _view.worldgraph.setAction("OnChange", function(_data,_info) {
  //var option = _view.worldgraph.getProperty("SelectedOptions");
  var opts = _view.worldgraph.getProperty("SelectedOptions");  // array of options
      var option = (opts.length > 0)? opts[0]:""; // selected option 
  if ( option=="world"){
    world=true;
    Width1 = "100%";
  Width2 = "0%";
    }
    else if ( option=="graph only"){
    world=false;
    graph=true;
  Width1 = "0%";
  Width2 = "100%";
    _view.plottingPanelxvst.getTitleY().setPosition([0.09,0.85]);
    }
    else if ( option=="x vs t"){
  xvst=true;
  graph=true;
  }
  else if (option == "x vs t off") {
      xvst = false;
      graph = true;
  }
  else if ( option=="v vs t"){
  vvst=true;
  graph=true;
  }
  else if (option == "v vs t off") {
      vvst = false;
      graph = true;
  }
  else if ( option=="a vs t"){
  avst=true;
  graph=true;
  }
  else if (option == "a vs t off") {
      avst = false;
      graph = true;
  }
  else if ( option=="both"){
  world=true;
  graph=true;
  Width1 = "50%";
  Width2 = "50%";
    _view.plottingPanelxvst.getTitleY().setPosition([0.12,0.85]);
  }
  else if ( option=="show model"){
  showmodel=true;
  }
  else if ( option=="hide model"){
  showmodel=false;
  }
  if(parent.cordova) { // check it is running in Android
  //var option1 = _view.comboBox.getProperty("SelectedOptions");
         parent.TTS.speak(option, function () {
              // success
          }, function (reason) {
              // error
          });
      }
      else {
    var msg = new SpeechSynthesisUtterance(option);
  window.speechSynthesis.speak(msg);
  }

}); // HtmlView Page setting action 'OnChange' for element 'worldgraph'
          _view.playPauseButton2.setAction("OffClick", function(_data,_info) {
  text="paused";
  _pause();

}); // HtmlView Page setting action 'OffClick' for element 'playPauseButton2'
          _view.playPauseButton2.linkProperty("State",  function() { return _isPaused; } ); // HtmlView Page linking property 'State' for element 'playPauseButton2'
          _view.playPauseButton2.setAction("OnClick", function(_data,_info) {
  _play();
  text="playing";

}); // HtmlView Page setting action 'OnClick' for element 'playPauseButton2'
          _view.stepButton2.setAction("OnClick", function(_data,_info) {
  _step();

}); // HtmlView Page setting action 'OnClick' for element 'stepButton2'
          _view.resetButton2.setAction("OnClick", function(_data,_info) {
  _reset();

}); // HtmlView Page setting action 'OnClick' for element 'resetButton2'
          _view.FullScreen2Button.setAction("OffClick", function(_data,_info) {
  toggleFullScreen();

}); // HtmlView Page setting action 'OffClick' for element 'FullScreen2Button'
          _view.FullScreen2Button.linkProperty("Visibility",  function() { return (!parent.cordova&&!iOS); } ); // HtmlView Page linking property 'Visibility' for element 'FullScreen2Button'
          _view.FullScreen2Button.linkProperty("Disabled",  function() { return _isPlaying; } ); // HtmlView Page linking property 'Disabled' for element 'FullScreen2Button'
          _view.FullScreen2Button.setAction("OnClick", function(_data,_info) {
  toggleFullScreen();

}); // HtmlView Page setting action 'OnClick' for element 'FullScreen2Button'
          _view.model.linkProperty("Visibility",  function() { return showmodel; }, function(_v) { showmodel = _v; } ); // HtmlView Page linking property 'Visibility' for element 'model'
          _view.model3.setAction("OnCheckOff", function(_data,_info) {
  showmodel=false;

}); // HtmlView Page setting action 'OnCheckOff' for element 'model3'
          _view.model3.linkProperty("Checked",  function() { return showmodel; }, function(_v) { showmodel = _v; } ); // HtmlView Page linking property 'Checked' for element 'model3'
          _view.model3.linkProperty("Visibility",  function() { return showmodel; }, function(_v) { showmodel = _v; } ); // HtmlView Page linking property 'Visibility' for element 'model3'
          _view.model3.setAction("OnCheckOn", function(_data,_info) {
  showmodel=true;

}); // HtmlView Page setting action 'OnCheckOn' for element 'model3'
          _view.models.linkProperty("Options",  function() { return ["0","2*sin(t)","2*cos(t)","-2*cos(t)","-1*cos(t)","1*sin(t+1.57)","1.41*sin(t+0.5236)","2*sin(3*t)","0.5*sin(1.05*t)","2*sin(0.63*t)","show me"]; } ); // HtmlView Page linking property 'Options' for element 'models'
          _view.models.setAction("OnChange", function(_data,_info) {
  //var option = _view.models.getProperty("SelectedOptions");
  var opts = _view.models.getProperty("SelectedOptions");  // array of options
      var option = (opts.length > 0)? opts[0]:""; // selected option 
  showmodel=true;
  functionY=option+"";
  if (option=="show me"){
  functionY= +_view._format(Acalculated,"0.0")+"*sin(" +_view._format(w,"0.00")+"*t+("+_view._format(phi,"0.00")+"))";  
    }
    //("+_view._format(Acalculated,"0.0")+")*("+_view._format(w,"0.00")+")*cos(" +_view._format(w,"0.00")+"*t+("+_view._format(phi,"0.00")+"))"
    if (option=="show me v"){
  functionY= "("+_view._format(Acalculated,"0.0")+")*("+_view._format(w,"0.00")+")*cos(" +_view._format(w,"0.00")+"*t+("+_view._format(phi,"0.00")+"))";  
    }
    if (option=="show me a"){
  functionY= "-("+_view._format(Acalculated,"0.0")+")*("+_view._format(w,"0.00")+")*("+_view._format(w,"0.00")+")*sin(" +_view._format(w,"0.00")+"*t+("+_view._format(phi,"0.00")+"))";  
    }
  xmodel=_view.fField.evaluate({ t : t, x : xmodel }); 
  _view._update();
  if(parent.cordova) { // check it is running in Android
  //var option1 = _view.comboBox.getProperty("SelectedOptions");
         parent.TTS.speak(option, function () {
              // success
          }, function (reason) {
              // error
          });
      }
      else {
    var msg = new SpeechSynthesisUtterance(option);
  window.speechSynthesis.speak(msg);
  }

}); // HtmlView Page setting action 'OnChange' for element 'models'
          _view.models.linkProperty("Visibility",  function() { return showmodel; }, function(_v) { showmodel = _v; } ); // HtmlView Page linking property 'Visibility' for element 'models'
          _view.fField.linkProperty("Value",  function() { return functionY; }, function(_v) { functionY = _v; } ); // HtmlView Page linking property 'Value' for element 'fField'
          _view.fField.setAction("OnChange", function(_data,_info) {
  showmodel=true;
  xmodel=_view.fField.evaluate({ t : t, x : xmodel }); 
  _view._update();

}); // HtmlView Page setting action 'OnChange' for element 'fField'
          _view.fField.linkProperty("Visibility",  function() { return showmodel; }, function(_v) { showmodel = _v; } ); // HtmlView Page linking property 'Visibility' for element 'fField'
          break;
      } // end of switch
    }; // end of new reset

    _model.setView(_view);
    _model.reset();
    _view._enableEPub();
  } // end of _selectView

  _model.setAutoplay(false);
  _model.setFPS(20);
  _model.setStepsPerDisplay(1);
  _selectView(_model._autoSelectView(_getViews())); // this includes _model.reset()
  return _model;
}

function SHM14_v2_View (_topFrame,_viewNumber,_libraryPath,_codebasePath) {
  var _view;
  switch(_viewNumber) {
    case -10 : break; // make Lint happy
    default :
    case 0: _view = SHM14_v2_View_0 (_topFrame); break;
  } // end of switch

  if (_codebasePath) _view._2(_codebasePath);

  if (_libraryPath) _view._4(_libraryPath);

  _view._addDescriptionPage('SHM11','./SHM14.xhtml');

  return _view;
} // end of main function

function SHM14_v2_View_0 (_topFrame) {
  var _view = EJSS_CORE.createView(_topFrame);

  _view._reset = function() {
    _view._1();
    _view._9(EJSS_INTERFACE.panel,"fullscreen", _view._topFrame) // EJsS HtmlView.HtmlView Page: declaration of element 'fullscreen'
      ;

    _view._9(EJSS_INTERFACE.panel,"panel", _view.fullscreen) // EJsS HtmlView.HtmlView Page: declaration of element 'panel'
      .setProperty("Height","100%") // EJsS HtmlView.HtmlView Page: setting property 'Height' for element 'panel'
      .setProperty("Width","100%") // EJsS HtmlView.HtmlView Page: setting property 'Width' for element 'panel'
      .setProperty("CSS",{   "position" : "absolute",   "top" : "0%",    "margin-left":"0px",    "left":"0%" }) // EJsS HtmlView.HtmlView Page: setting property 'CSS' for element 'panel'
      ;

    _view._9(EJSS_DRAWING2D.plottingPanel,"plottingPanel", _view.panel) // EJsS HtmlView.HtmlView Page: declaration of element 'plottingPanel'
      .setProperty("Gutters",[0,0,0,0]) // EJsS HtmlView.HtmlView Page: setting property 'Gutters' for element 'plottingPanel'
      .setProperty("XTicks",11) // EJsS HtmlView.HtmlView Page: setting property 'XTicks' for element 'plottingPanel'
      .setProperty("YScalePrecision",1) // EJsS HtmlView.HtmlView Page: setting property 'YScalePrecision' for element 'plottingPanel'
      .setProperty("XFixedTick",0) // EJsS HtmlView.HtmlView Page: setting property 'XFixedTick' for element 'plottingPanel'
      .setProperty("Title","Simple Harmonic Motion of Spring (k=(Ï€^2)/25 N/m) - Mass (m=1 kg) Model") // EJsS HtmlView.HtmlView Page: setting property 'Title' for element 'plottingPanel'
      .setProperty("Enabled",true) // EJsS HtmlView.HtmlView Page: setting property 'Enabled' for element 'plottingPanel'
      .setProperty("YFixedTick",0) // EJsS HtmlView.HtmlView Page: setting property 'YFixedTick' for element 'plottingPanel'
      .setProperty("YAutoTicks",false) // EJsS HtmlView.HtmlView Page: setting property 'YAutoTicks' for element 'plottingPanel'
      .setProperty("AutoScaleY",false) // EJsS HtmlView.HtmlView Page: setting property 'AutoScaleY' for element 'plottingPanel'
      .setProperty("TitleX","x =") // EJsS HtmlView.HtmlView Page: setting property 'TitleX' for element 'plottingPanel'
      .setProperty("AutoScaleX",false) // EJsS HtmlView.HtmlView Page: setting property 'AutoScaleX' for element 'plottingPanel'
      .setProperty("XAutoTicks",false) // EJsS HtmlView.HtmlView Page: setting property 'XAutoTicks' for element 'plottingPanel'
      .setProperty("XScalePrecision",1) // EJsS HtmlView.HtmlView Page: setting property 'XScalePrecision' for element 'plottingPanel'
      ;

    _view._9(EJSS_DRAWING2D.shape,"leftwall", _view.plottingPanel) // EJsS HtmlView.HtmlView Page: declaration of element 'leftwall'
      .setProperty("FillColor","Green") // EJsS HtmlView.HtmlView Page: setting property 'FillColor' for element 'leftwall'
      .setProperty("RelativePosition","WEST") // EJsS HtmlView.HtmlView Page: setting property 'RelativePosition' for element 'leftwall'
      .setProperty("ShapeType","RECTANGLE") // EJsS HtmlView.HtmlView Page: setting property 'ShapeType' for element 'leftwall'
      ;

    _view._9(EJSS_DRAWING2D.shape,"floor", _view.plottingPanel) // EJsS HtmlView.HtmlView Page: declaration of element 'floor'
      .setProperty("FillColor","Orange") // EJsS HtmlView.HtmlView Page: setting property 'FillColor' for element 'floor'
      .setProperty("RelativePosition","NORTH_EAST") // EJsS HtmlView.HtmlView Page: setting property 'RelativePosition' for element 'floor'
      .setProperty("ShapeType","RECTANGLE") // EJsS HtmlView.HtmlView Page: setting property 'ShapeType' for element 'floor'
      .setProperty("X",0) // EJsS HtmlView.HtmlView Page: setting property 'X' for element 'floor'
      ;

    _view._9(EJSS_DRAWING2D.shape,"floor2", _view.plottingPanel) // EJsS HtmlView.HtmlView Page: declaration of element 'floor2'
      .setProperty("FillColor","Orange") // EJsS HtmlView.HtmlView Page: setting property 'FillColor' for element 'floor2'
      .setProperty("RelativePosition","NORTH_WEST") // EJsS HtmlView.HtmlView Page: setting property 'RelativePosition' for element 'floor2'
      .setProperty("ShapeType","RECTANGLE") // EJsS HtmlView.HtmlView Page: setting property 'ShapeType' for element 'floor2'
      .setProperty("X",0) // EJsS HtmlView.HtmlView Page: setting property 'X' for element 'floor2'
      ;

    _view._9(EJSS_DRAWING2D.shape,"mass3", _view.plottingPanel) // EJsS HtmlView.HtmlView Page: declaration of element 'mass3'
      .setProperty("FillColor","Blue") // EJsS HtmlView.HtmlView Page: setting property 'FillColor' for element 'mass3'
      .setProperty("ShapeType","RECTANGLE") // EJsS HtmlView.HtmlView Page: setting property 'ShapeType' for element 'mass3'
      .setProperty("EnabledPosition","ENABLED_X") // EJsS HtmlView.HtmlView Page: setting property 'EnabledPosition' for element 'mass3'
      ;

    _view._9(EJSS_DRAWING2D.shape,"svg", _view.plottingPanel) // EJsS HtmlView.HtmlView Page: declaration of element 'svg'
      .setProperty("FillColor","url(#mygrandient)") // EJsS HtmlView.HtmlView Page: setting property 'FillColor' for element 'svg'
      .setProperty("ShapeType","RECTANGLE") // EJsS HtmlView.HtmlView Page: setting property 'ShapeType' for element 'svg'
      .setProperty("EnabledPosition","ENABLED_X") // EJsS HtmlView.HtmlView Page: setting property 'EnabledPosition' for element 'svg'
      ;

    _view._9(EJSS_DRAWING2D.shape,"mass2", _view.plottingPanel) // EJsS HtmlView.HtmlView Page: declaration of element 'mass2'
      .setProperty("FillColor","Orange") // EJsS HtmlView.HtmlView Page: setting property 'FillColor' for element 'mass2'
      .setProperty("SizeX",20) // EJsS HtmlView.HtmlView Page: setting property 'SizeX' for element 'mass2'
      .setProperty("ShapeType","WHEEL") // EJsS HtmlView.HtmlView Page: setting property 'ShapeType' for element 'mass2'
      .setProperty("SizeY",20) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'mass2'
      .setProperty("PixelSize",true) // EJsS HtmlView.HtmlView Page: setting property 'PixelSize' for element 'mass2'
      .setProperty("EnabledPosition","ENABLED_X") // EJsS HtmlView.HtmlView Page: setting property 'EnabledPosition' for element 'mass2'
      ;

    _view._9(EJSS_DRAWING2D.shape,"model2", _view.plottingPanel) // EJsS HtmlView.HtmlView Page: declaration of element 'model2'
      .setProperty("FillColor","Cyan") // EJsS HtmlView.HtmlView Page: setting property 'FillColor' for element 'model2'
      .setProperty("SizeX",30) // EJsS HtmlView.HtmlView Page: setting property 'SizeX' for element 'model2'
      .setProperty("ShapeType","WHEEL") // EJsS HtmlView.HtmlView Page: setting property 'ShapeType' for element 'model2'
      .setProperty("SizeY",30) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'model2'
      .setProperty("PixelSize",true) // EJsS HtmlView.HtmlView Page: setting property 'PixelSize' for element 'model2'
      .setProperty("EnabledPosition","ENABLED_X") // EJsS HtmlView.HtmlView Page: setting property 'EnabledPosition' for element 'model2'
      ;

    _view._9(EJSS_DRAWING2D.group,"labels", _view.plottingPanel) // EJsS HtmlView.HtmlView Page: declaration of element 'labels'
      ;

    _view._9(EJSS_DRAWING2D.arrow,"arrow", _view.labels) // EJsS HtmlView.HtmlView Page: declaration of element 'arrow'
      .setProperty("X",0) // EJsS HtmlView.HtmlView Page: setting property 'X' for element 'arrow'
      .setProperty("LineColor","Blue") // EJsS HtmlView.HtmlView Page: setting property 'LineColor' for element 'arrow'
      .setProperty("SizeY",0) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'arrow'
      .setProperty("LineWidth",3) // EJsS HtmlView.HtmlView Page: setting property 'LineWidth' for element 'arrow'
      .setProperty("Offset","SOUTH_WEST") // EJsS HtmlView.HtmlView Page: setting property 'Offset' for element 'arrow'
      ;

    _view._9(EJSS_DRAWING2D.text,"P", _view.labels) // EJsS HtmlView.HtmlView Page: declaration of element 'P'
      .setProperty("SizeX",10) // EJsS HtmlView.HtmlView Page: setting property 'SizeX' for element 'P'
      .setProperty("RelativePosition","NORTH_WEST") // EJsS HtmlView.HtmlView Page: setting property 'RelativePosition' for element 'P'
      .setProperty("Text","P") // EJsS HtmlView.HtmlView Page: setting property 'Text' for element 'P'
      .setProperty("SizeY",10) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'P'
      .setProperty("PixelSize",true) // EJsS HtmlView.HtmlView Page: setting property 'PixelSize' for element 'P'
      ;

    _view._9(EJSS_DRAWING2D.text,"pointA", _view.labels) // EJsS HtmlView.HtmlView Page: declaration of element 'pointA'
      .setProperty("SizeX",10) // EJsS HtmlView.HtmlView Page: setting property 'SizeX' for element 'pointA'
      .setProperty("RelativePosition","SOUTH_WEST") // EJsS HtmlView.HtmlView Page: setting property 'RelativePosition' for element 'pointA'
      .setProperty("Text","A") // EJsS HtmlView.HtmlView Page: setting property 'Text' for element 'pointA'
      .setProperty("SizeY",10) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'pointA'
      .setProperty("PixelSize",true) // EJsS HtmlView.HtmlView Page: setting property 'PixelSize' for element 'pointA'
      ;

    _view._9(EJSS_DRAWING2D.text,"pointB2", _view.labels) // EJsS HtmlView.HtmlView Page: declaration of element 'pointB2'
      .setProperty("SizeX",10) // EJsS HtmlView.HtmlView Page: setting property 'SizeX' for element 'pointB2'
      .setProperty("RelativePosition","SOUTH_EAST") // EJsS HtmlView.HtmlView Page: setting property 'RelativePosition' for element 'pointB2'
      .setProperty("Text","B") // EJsS HtmlView.HtmlView Page: setting property 'Text' for element 'pointB2'
      .setProperty("SizeY",10) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'pointB2'
      .setProperty("PixelSize",true) // EJsS HtmlView.HtmlView Page: setting property 'PixelSize' for element 'pointB2'
      ;

    _view._9(EJSS_DRAWING2D.text,"pointO", _view.labels) // EJsS HtmlView.HtmlView Page: declaration of element 'pointO'
      .setProperty("SizeX",10) // EJsS HtmlView.HtmlView Page: setting property 'SizeX' for element 'pointO'
      .setProperty("RelativePosition","NORTH_EAST") // EJsS HtmlView.HtmlView Page: setting property 'RelativePosition' for element 'pointO'
      .setProperty("Text","O") // EJsS HtmlView.HtmlView Page: setting property 'Text' for element 'pointO'
      .setProperty("SizeY",10) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'pointO'
      .setProperty("PixelSize",true) // EJsS HtmlView.HtmlView Page: setting property 'PixelSize' for element 'pointO'
      ;

    _view._9(EJSS_DRAWING2D.arrow,"arrow22", _view.labels) // EJsS HtmlView.HtmlView Page: declaration of element 'arrow22'
      .setProperty("MarkEnd","POINTED") // EJsS HtmlView.HtmlView Page: setting property 'MarkEnd' for element 'arrow22'
      .setProperty("MarkMiddle","POINTED") // EJsS HtmlView.HtmlView Page: setting property 'MarkMiddle' for element 'arrow22'
      .setProperty("LineColor","Red") // EJsS HtmlView.HtmlView Page: setting property 'LineColor' for element 'arrow22'
      .setProperty("SizeY",0) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'arrow22'
      .setProperty("LineWidth",3) // EJsS HtmlView.HtmlView Page: setting property 'LineWidth' for element 'arrow22'
      .setProperty("Offset","SOUTH_WEST") // EJsS HtmlView.HtmlView Page: setting property 'Offset' for element 'arrow22'
      ;

    _view._9(EJSS_DRAWING2D.text,"x", _view.plottingPanel) // EJsS HtmlView.HtmlView Page: declaration of element 'x'
      .setProperty("FillColor","Blue") // EJsS HtmlView.HtmlView Page: setting property 'FillColor' for element 'x'
      .setProperty("RelativePosition","SOUTH") // EJsS HtmlView.HtmlView Page: setting property 'RelativePosition' for element 'x'
      ;

    _view._9(EJSS_DRAWING2D.arrow,"velocity", _view.plottingPanel) // EJsS HtmlView.HtmlView Page: declaration of element 'velocity'
      .setProperty("MarkEnd","TRIANGLE") // EJsS HtmlView.HtmlView Page: setting property 'MarkEnd' for element 'velocity'
      .setProperty("EnabledSize","ENABLED_X") // EJsS HtmlView.HtmlView Page: setting property 'EnabledSize' for element 'velocity'
      .setProperty("LineColor","Magenta") // EJsS HtmlView.HtmlView Page: setting property 'LineColor' for element 'velocity'
      .setProperty("SizeY",0) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'velocity'
      .setProperty("LineWidth",2) // EJsS HtmlView.HtmlView Page: setting property 'LineWidth' for element 'velocity'
      ;

    _view._9(EJSS_DRAWING2D.text,"v", _view.plottingPanel) // EJsS HtmlView.HtmlView Page: declaration of element 'v'
      .setProperty("FillColor","Magenta") // EJsS HtmlView.HtmlView Page: setting property 'FillColor' for element 'v'
      .setProperty("RelativePosition","SOUTH") // EJsS HtmlView.HtmlView Page: setting property 'RelativePosition' for element 'v'
      ;

    _view._9(EJSS_DRAWING2D.text,"a", _view.plottingPanel) // EJsS HtmlView.HtmlView Page: declaration of element 'a'
      .setProperty("FillColor","Red") // EJsS HtmlView.HtmlView Page: setting property 'FillColor' for element 'a'
      .setProperty("RelativePosition","SOUTH") // EJsS HtmlView.HtmlView Page: setting property 'RelativePosition' for element 'a'
      ;

    _view._9(EJSS_DRAWING2D.spring,"spring", _view.plottingPanel) // EJsS HtmlView.HtmlView Page: declaration of element 'spring'
      .setProperty("LineColor","Black") // EJsS HtmlView.HtmlView Page: setting property 'LineColor' for element 'spring'
      .setProperty("Y",0) // EJsS HtmlView.HtmlView Page: setting property 'Y' for element 'spring'
      .setProperty("PointsPerLoop",50) // EJsS HtmlView.HtmlView Page: setting property 'PointsPerLoop' for element 'spring'
      .setProperty("SizeY",0) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'spring'
      .setProperty("LineWidth",2) // EJsS HtmlView.HtmlView Page: setting property 'LineWidth' for element 'spring'
      ;

    _view._9(EJSS_DRAWING2D.spring,"spring2", _view.plottingPanel) // EJsS HtmlView.HtmlView Page: declaration of element 'spring2'
      .setProperty("LineColor","Black") // EJsS HtmlView.HtmlView Page: setting property 'LineColor' for element 'spring2'
      .setProperty("Y",0) // EJsS HtmlView.HtmlView Page: setting property 'Y' for element 'spring2'
      .setProperty("Visibility",false) // EJsS HtmlView.HtmlView Page: setting property 'Visibility' for element 'spring2'
      .setProperty("SizeY",0) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'spring2'
      .setProperty("LineWidth",2) // EJsS HtmlView.HtmlView Page: setting property 'LineWidth' for element 'spring2'
      ;

    _view._9(EJSS_DRAWING2D.arrow,"drivingforce", _view.plottingPanel) // EJsS HtmlView.HtmlView Page: declaration of element 'drivingforce'
      .setProperty("FillColor","Green") // EJsS HtmlView.HtmlView Page: setting property 'FillColor' for element 'drivingforce'
      .setProperty("LineColor","Green") // EJsS HtmlView.HtmlView Page: setting property 'LineColor' for element 'drivingforce'
      .setProperty("SizeY",0) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'drivingforce'
      .setProperty("LineWidth",3) // EJsS HtmlView.HtmlView Page: setting property 'LineWidth' for element 'drivingforce'
      ;

    _view._9(EJSS_DRAWING2D.shape,"rightwallplunger2", _view.plottingPanel) // EJsS HtmlView.HtmlView Page: declaration of element 'rightwallplunger2'
      .setProperty("FillColor","Green") // EJsS HtmlView.HtmlView Page: setting property 'FillColor' for element 'rightwallplunger2'
      .setProperty("RelativePosition","EAST") // EJsS HtmlView.HtmlView Page: setting property 'RelativePosition' for element 'rightwallplunger2'
      .setProperty("ShapeType","RECTANGLE") // EJsS HtmlView.HtmlView Page: setting property 'ShapeType' for element 'rightwallplunger2'
      ;

    _view._9(EJSS_DRAWING2D.plottingPanel,"plottingPanelxvst", _view.panel) // EJsS HtmlView.HtmlView Page: declaration of element 'plottingPanelxvst'
      .setProperty("Gutters",[0,0,0,0]) // EJsS HtmlView.HtmlView Page: setting property 'Gutters' for element 'plottingPanelxvst'
      .setProperty("YScalePrecision",1) // EJsS HtmlView.HtmlView Page: setting property 'YScalePrecision' for element 'plottingPanelxvst'
      .setProperty("XFixedTick",0) // EJsS HtmlView.HtmlView Page: setting property 'XFixedTick' for element 'plottingPanelxvst'
      .setProperty("YFixedTick",0) // EJsS HtmlView.HtmlView Page: setting property 'YFixedTick' for element 'plottingPanelxvst'
      .setProperty("YTickStep",0.5) // EJsS HtmlView.HtmlView Page: setting property 'YTickStep' for element 'plottingPanelxvst'
      .setProperty("XAutoTicks",false) // EJsS HtmlView.HtmlView Page: setting property 'XAutoTicks' for element 'plottingPanelxvst'
      .setProperty("Enabled",true) // EJsS HtmlView.HtmlView Page: setting property 'Enabled' for element 'plottingPanelxvst'
      .setProperty("Title","Position/Velocity/Acceleration vs. Time") // EJsS HtmlView.HtmlView Page: setting property 'Title' for element 'plottingPanelxvst'
      .setProperty("MaximumY",1) // EJsS HtmlView.HtmlView Page: setting property 'MaximumY' for element 'plottingPanelxvst'
      .setProperty("YAutoTicks",false) // EJsS HtmlView.HtmlView Page: setting property 'YAutoTicks' for element 'plottingPanelxvst'
      .setProperty("MinimumX",0) // EJsS HtmlView.HtmlView Page: setting property 'MinimumX' for element 'plottingPanelxvst'
      .setProperty("MinimumY",-1) // EJsS HtmlView.HtmlView Page: setting property 'MinimumY' for element 'plottingPanelxvst'
      .setProperty("TitleY","Position/Velocity/Acceleration") // EJsS HtmlView.HtmlView Page: setting property 'TitleY' for element 'plottingPanelxvst'
      .setProperty("TitleX","Time (s)") // EJsS HtmlView.HtmlView Page: setting property 'TitleX' for element 'plottingPanelxvst'
      .setProperty("AutoScaleY",true) // EJsS HtmlView.HtmlView Page: setting property 'AutoScaleY' for element 'plottingPanelxvst'
      .setProperty("AutoScaleX",true) // EJsS HtmlView.HtmlView Page: setting property 'AutoScaleX' for element 'plottingPanelxvst'
      .setProperty("MarginX",10) // EJsS HtmlView.HtmlView Page: setting property 'MarginX' for element 'plottingPanelxvst'
      .setProperty("XScalePrecision",2) // EJsS HtmlView.HtmlView Page: setting property 'XScalePrecision' for element 'plottingPanelxvst'
      ;

    _view._9(EJSS_DRAWING2D.analyticCurve,"analyticCurve", _view.plottingPanelxvst) // EJsS HtmlView.HtmlView Page: declaration of element 'analyticCurve'
      .setProperty("FunctionX","t") // EJsS HtmlView.HtmlView Page: setting property 'FunctionX' for element 'analyticCurve'
      .setProperty("Minimum",0) // EJsS HtmlView.HtmlView Page: setting property 'Minimum' for element 'analyticCurve'
      .setProperty("NumPoints",100) // EJsS HtmlView.HtmlView Page: setting property 'NumPoints' for element 'analyticCurve'
      .setProperty("Variable","t") // EJsS HtmlView.HtmlView Page: setting property 'Variable' for element 'analyticCurve'
      .setProperty("LineColor","Cyan") // EJsS HtmlView.HtmlView Page: setting property 'LineColor' for element 'analyticCurve'
      .setProperty("LineWidth",3) // EJsS HtmlView.HtmlView Page: setting property 'LineWidth' for element 'analyticCurve'
      ;

    _view._9(EJSS_DRAWING2D.trail,"trail", _view.plottingPanelxvst) // EJsS HtmlView.HtmlView Page: declaration of element 'trail'
      .setProperty("LineColor","Blue") // EJsS HtmlView.HtmlView Page: setting property 'LineColor' for element 'trail'
      .setProperty("LineWidth",1.5) // EJsS HtmlView.HtmlView Page: setting property 'LineWidth' for element 'trail'
      ;

    _view._9(EJSS_DRAWING2D.shape,"trailDot2", _view.plottingPanelxvst) // EJsS HtmlView.HtmlView Page: declaration of element 'trailDot2'
      .setProperty("FillColor","Blue") // EJsS HtmlView.HtmlView Page: setting property 'FillColor' for element 'trailDot2'
      .setProperty("SizeX",10) // EJsS HtmlView.HtmlView Page: setting property 'SizeX' for element 'trailDot2'
      .setProperty("LineColor","Black") // EJsS HtmlView.HtmlView Page: setting property 'LineColor' for element 'trailDot2'
      .setProperty("PixelSize",true) // EJsS HtmlView.HtmlView Page: setting property 'PixelSize' for element 'trailDot2'
      .setProperty("SizeY",10) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'trailDot2'
      ;

    _view._9(EJSS_DRAWING2D.group,"labels2", _view.plottingPanelxvst) // EJsS HtmlView.HtmlView Page: declaration of element 'labels2'
      ;

    _view._9(EJSS_DRAWING2D.arrow,"arrow2", _view.labels2) // EJsS HtmlView.HtmlView Page: declaration of element 'arrow2'
      .setProperty("SizeX",0) // EJsS HtmlView.HtmlView Page: setting property 'SizeX' for element 'arrow2'
      .setProperty("X",0) // EJsS HtmlView.HtmlView Page: setting property 'X' for element 'arrow2'
      .setProperty("LineColor","Blue") // EJsS HtmlView.HtmlView Page: setting property 'LineColor' for element 'arrow2'
      .setProperty("Y",0) // EJsS HtmlView.HtmlView Page: setting property 'Y' for element 'arrow2'
      .setProperty("LineWidth",3) // EJsS HtmlView.HtmlView Page: setting property 'LineWidth' for element 'arrow2'
      .setProperty("Offset","SOUTH_WEST") // EJsS HtmlView.HtmlView Page: setting property 'Offset' for element 'arrow2'
      ;

    _view._9(EJSS_DRAWING2D.text,"P2", _view.labels2) // EJsS HtmlView.HtmlView Page: declaration of element 'P2'
      .setProperty("SizeX",10) // EJsS HtmlView.HtmlView Page: setting property 'SizeX' for element 'P2'
      .setProperty("RelativePosition","SOUTH_WEST") // EJsS HtmlView.HtmlView Page: setting property 'RelativePosition' for element 'P2'
      .setProperty("Text","P") // EJsS HtmlView.HtmlView Page: setting property 'Text' for element 'P2'
      .setProperty("SizeY",10) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'P2'
      .setProperty("PixelSize",true) // EJsS HtmlView.HtmlView Page: setting property 'PixelSize' for element 'P2'
      ;

    _view._9(EJSS_DRAWING2D.text,"pointA2", _view.labels2) // EJsS HtmlView.HtmlView Page: declaration of element 'pointA2'
      .setProperty("RelativePosition","NORTH") // EJsS HtmlView.HtmlView Page: setting property 'RelativePosition' for element 'pointA2'
      .setProperty("Text","A") // EJsS HtmlView.HtmlView Page: setting property 'Text' for element 'pointA2'
      .setProperty("Visibility",false) // EJsS HtmlView.HtmlView Page: setting property 'Visibility' for element 'pointA2'
      .setProperty("PixelSize",true) // EJsS HtmlView.HtmlView Page: setting property 'PixelSize' for element 'pointA2'
      ;

    _view._9(EJSS_DRAWING2D.textSet,"textSetA", _view.labels2) // EJsS HtmlView.HtmlView Page: declaration of element 'textSetA'
      .setProperty("FillColor","Black") // EJsS HtmlView.HtmlView Page: setting property 'FillColor' for element 'textSetA'
      .setProperty("RelativePosition","NORTH") // EJsS HtmlView.HtmlView Page: setting property 'RelativePosition' for element 'textSetA'
      .setProperty("PixelSize",true) // EJsS HtmlView.HtmlView Page: setting property 'PixelSize' for element 'textSetA'
      ;

    _view._9(EJSS_DRAWING2D.textSet,"textSetB", _view.labels2) // EJsS HtmlView.HtmlView Page: declaration of element 'textSetB'
      .setProperty("FillColor","Black") // EJsS HtmlView.HtmlView Page: setting property 'FillColor' for element 'textSetB'
      .setProperty("RelativePosition","SOUTH") // EJsS HtmlView.HtmlView Page: setting property 'RelativePosition' for element 'textSetB'
      .setProperty("PixelSize",true) // EJsS HtmlView.HtmlView Page: setting property 'PixelSize' for element 'textSetB'
      ;

    _view._9(EJSS_DRAWING2D.text,"pointB22", _view.labels2) // EJsS HtmlView.HtmlView Page: declaration of element 'pointB22'
      .setProperty("RelativePosition","SOUTH") // EJsS HtmlView.HtmlView Page: setting property 'RelativePosition' for element 'pointB22'
      .setProperty("Text","B") // EJsS HtmlView.HtmlView Page: setting property 'Text' for element 'pointB22'
      .setProperty("Visibility",false) // EJsS HtmlView.HtmlView Page: setting property 'Visibility' for element 'pointB22'
      .setProperty("PixelSize",true) // EJsS HtmlView.HtmlView Page: setting property 'PixelSize' for element 'pointB22'
      ;

    _view._9(EJSS_DRAWING2D.text,"pointO2", _view.labels2) // EJsS HtmlView.HtmlView Page: declaration of element 'pointO2'
      .setProperty("RelativePosition","NORTH_WEST") // EJsS HtmlView.HtmlView Page: setting property 'RelativePosition' for element 'pointO2'
      .setProperty("Text","O") // EJsS HtmlView.HtmlView Page: setting property 'Text' for element 'pointO2'
      .setProperty("SizeY",10) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'pointO2'
      .setProperty("PixelSize",true) // EJsS HtmlView.HtmlView Page: setting property 'PixelSize' for element 'pointO2'
      ;

    _view._9(EJSS_DRAWING2D.trail,"trail2", _view.plottingPanelxvst) // EJsS HtmlView.HtmlView Page: declaration of element 'trail2'
      .setProperty("LineColor","Magenta") // EJsS HtmlView.HtmlView Page: setting property 'LineColor' for element 'trail2'
      .setProperty("LineWidth",1.5) // EJsS HtmlView.HtmlView Page: setting property 'LineWidth' for element 'trail2'
      ;

    _view._9(EJSS_DRAWING2D.shape,"trailDot22", _view.plottingPanelxvst) // EJsS HtmlView.HtmlView Page: declaration of element 'trailDot22'
      .setProperty("FillColor","Magenta") // EJsS HtmlView.HtmlView Page: setting property 'FillColor' for element 'trailDot22'
      .setProperty("SizeX",10) // EJsS HtmlView.HtmlView Page: setting property 'SizeX' for element 'trailDot22'
      .setProperty("LineColor","Black") // EJsS HtmlView.HtmlView Page: setting property 'LineColor' for element 'trailDot22'
      .setProperty("PixelSize",true) // EJsS HtmlView.HtmlView Page: setting property 'PixelSize' for element 'trailDot22'
      .setProperty("SizeY",10) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'trailDot22'
      ;

    _view._9(EJSS_DRAWING2D.trail,"trail3", _view.plottingPanelxvst) // EJsS HtmlView.HtmlView Page: declaration of element 'trail3'
      .setProperty("LineColor","Red") // EJsS HtmlView.HtmlView Page: setting property 'LineColor' for element 'trail3'
      .setProperty("LineWidth",1.5) // EJsS HtmlView.HtmlView Page: setting property 'LineWidth' for element 'trail3'
      ;

    _view._9(EJSS_DRAWING2D.shape,"trailDot23", _view.plottingPanelxvst) // EJsS HtmlView.HtmlView Page: declaration of element 'trailDot23'
      .setProperty("FillColor","Red") // EJsS HtmlView.HtmlView Page: setting property 'FillColor' for element 'trailDot23'
      .setProperty("SizeX",10) // EJsS HtmlView.HtmlView Page: setting property 'SizeX' for element 'trailDot23'
      .setProperty("LineColor","Black") // EJsS HtmlView.HtmlView Page: setting property 'LineColor' for element 'trailDot23'
      .setProperty("PixelSize",true) // EJsS HtmlView.HtmlView Page: setting property 'PixelSize' for element 'trailDot23'
      .setProperty("SizeY",10) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'trailDot23'
      ;

    _view._9(EJSS_DRAWING2D.text,"yaxislabel2", _view.plottingPanelxvst) // EJsS HtmlView.HtmlView Page: declaration of element 'yaxislabel2'
      .setProperty("RelativePosition","NORTH_WEST") // EJsS HtmlView.HtmlView Page: setting property 'RelativePosition' for element 'yaxislabel2'
      .setProperty("X",0) // EJsS HtmlView.HtmlView Page: setting property 'X' for element 'yaxislabel2'
      .setProperty("Y",2) // EJsS HtmlView.HtmlView Page: setting property 'Y' for element 'yaxislabel2'
      .setProperty("Text","x (m)") // EJsS HtmlView.HtmlView Page: setting property 'Text' for element 'yaxislabel2'
      .setProperty("Visibility",false) // EJsS HtmlView.HtmlView Page: setting property 'Visibility' for element 'yaxislabel2'
      ;

    _view._9(EJSS_DRAWING2D.text,"xaxislabel", _view.plottingPanelxvst) // EJsS HtmlView.HtmlView Page: declaration of element 'xaxislabel'
      .setProperty("RelativePosition","NORTH_EAST") // EJsS HtmlView.HtmlView Page: setting property 'RelativePosition' for element 'xaxislabel'
      .setProperty("Y",0) // EJsS HtmlView.HtmlView Page: setting property 'Y' for element 'xaxislabel'
      .setProperty("Text","x (m)") // EJsS HtmlView.HtmlView Page: setting property 'Text' for element 'xaxislabel'
      .setProperty("Visibility",false) // EJsS HtmlView.HtmlView Page: setting property 'Visibility' for element 'xaxislabel'
      ;

    _view._9(EJSS_DRAWING2D.arrow,"axesy2", _view.plottingPanelxvst) // EJsS HtmlView.HtmlView Page: declaration of element 'axesy2'
      .setProperty("MarkEnd","NONE") // EJsS HtmlView.HtmlView Page: setting property 'MarkEnd' for element 'axesy2'
      .setProperty("SizeX",0) // EJsS HtmlView.HtmlView Page: setting property 'SizeX' for element 'axesy2'
      .setProperty("X",0) // EJsS HtmlView.HtmlView Page: setting property 'X' for element 'axesy2'
      .setProperty("LineColor","Black") // EJsS HtmlView.HtmlView Page: setting property 'LineColor' for element 'axesy2'
      .setProperty("Y",0) // EJsS HtmlView.HtmlView Page: setting property 'Y' for element 'axesy2'
      .setProperty("LineWidth",2) // EJsS HtmlView.HtmlView Page: setting property 'LineWidth' for element 'axesy2'
      .setProperty("Offset","NORTH_EAST") // EJsS HtmlView.HtmlView Page: setting property 'Offset' for element 'axesy2'
      ;

    _view._9(EJSS_DRAWING2D.arrow,"axesy", _view.plottingPanelxvst) // EJsS HtmlView.HtmlView Page: declaration of element 'axesy'
      .setProperty("MarkEnd","TRIANGLE") // EJsS HtmlView.HtmlView Page: setting property 'MarkEnd' for element 'axesy'
      .setProperty("SizeX",0) // EJsS HtmlView.HtmlView Page: setting property 'SizeX' for element 'axesy'
      .setProperty("X",0) // EJsS HtmlView.HtmlView Page: setting property 'X' for element 'axesy'
      .setProperty("LineColor","Black") // EJsS HtmlView.HtmlView Page: setting property 'LineColor' for element 'axesy'
      .setProperty("Y",0) // EJsS HtmlView.HtmlView Page: setting property 'Y' for element 'axesy'
      .setProperty("LineWidth",2) // EJsS HtmlView.HtmlView Page: setting property 'LineWidth' for element 'axesy'
      .setProperty("Offset","SOUTH_WEST") // EJsS HtmlView.HtmlView Page: setting property 'Offset' for element 'axesy'
      ;

    _view._9(EJSS_DRAWING2D.arrow,"axes", _view.plottingPanelxvst) // EJsS HtmlView.HtmlView Page: declaration of element 'axes'
      .setProperty("MarkEnd","TRIANGLE") // EJsS HtmlView.HtmlView Page: setting property 'MarkEnd' for element 'axes'
      .setProperty("X",0) // EJsS HtmlView.HtmlView Page: setting property 'X' for element 'axes'
      .setProperty("Y",0) // EJsS HtmlView.HtmlView Page: setting property 'Y' for element 'axes'
      .setProperty("SizeY",0) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'axes'
      .setProperty("LineWidth",2) // EJsS HtmlView.HtmlView Page: setting property 'LineWidth' for element 'axes'
      .setProperty("Offset","SOUTH_WEST") // EJsS HtmlView.HtmlView Page: setting property 'Offset' for element 'axes'
      ;

    _view._9(EJSS_INTERFACE.panel,"model4", _view.fullscreen) // EJsS HtmlView.HtmlView Page: declaration of element 'model4'
      .setProperty("Height","5%") // EJsS HtmlView.HtmlView Page: setting property 'Height' for element 'model4'
      .setProperty("Width","100%") // EJsS HtmlView.HtmlView Page: setting property 'Width' for element 'model4'
      .setProperty("CSS",{   "position" : "absolute",   "top" : "30px",    "margin-left":"0px",    "left":"-9.8%" }) // EJsS HtmlView.HtmlView Page: setting property 'CSS' for element 'model4'
      ;

    _view._9(EJSS_INTERFACE.comboBox,"comboBox", _view.model4) // EJsS HtmlView.HtmlView Page: declaration of element 'comboBox'
      .setProperty("Tooltip","select user_defined and drag the mass") // EJsS HtmlView.HtmlView Page: setting property 'Tooltip' for element 'comboBox'
      ;

    _view._9(EJSS_INTERFACE.comboBox,"worldgraph", _view.model4) // EJsS HtmlView.HtmlView Page: declaration of element 'worldgraph'
      .setProperty("Tooltip","select user_defined and drag the mass") // EJsS HtmlView.HtmlView Page: setting property 'Tooltip' for element 'worldgraph'
      ;

    _view._9(EJSS_INTERFACE.twoStateButton,"playPauseButton2", _view.model4) // EJsS HtmlView.HtmlView Page: declaration of element 'playPauseButton2'
      .setProperty("Tooltip","Play/Pause") // EJsS HtmlView.HtmlView Page: setting property 'Tooltip' for element 'playPauseButton2'
      .setProperty("ImageOnUrl","/org/opensourcephysics/resources/controls/images/play.gif") // EJsS HtmlView.HtmlView Page: setting property 'ImageOnUrl' for element 'playPauseButton2'
      .setProperty("ImageOffUrl","/org/opensourcephysics/resources/controls/images/pause.gif") // EJsS HtmlView.HtmlView Page: setting property 'ImageOffUrl' for element 'playPauseButton2'
      ;

    _view._9(EJSS_INTERFACE.button,"stepButton2", _view.model4) // EJsS HtmlView.HtmlView Page: declaration of element 'stepButton2'
      .setProperty("ImageUrl","/org/opensourcephysics/resources/controls/images/stepforward.gif") // EJsS HtmlView.HtmlView Page: setting property 'ImageUrl' for element 'stepButton2'
      ;

    _view._9(EJSS_INTERFACE.button,"resetButton2", _view.model4) // EJsS HtmlView.HtmlView Page: declaration of element 'resetButton2'
      .setProperty("ImageUrl","/org/opensourcephysics/resources/controls/images/reset.gif") // EJsS HtmlView.HtmlView Page: setting property 'ImageUrl' for element 'resetButton2'
      ;

    _view._9(EJSS_INTERFACE.twoStateButton,"FullScreen2Button", _view.model4) // EJsS HtmlView.HtmlView Page: declaration of element 'FullScreen2Button'
      .setProperty("Tooltip","Fullscreen ") // EJsS HtmlView.HtmlView Page: setting property 'Tooltip' for element 'FullScreen2Button'
      .setProperty("ImageOnUrl","/org/opensourcephysics/resources/controls/images/window.gif") // EJsS HtmlView.HtmlView Page: setting property 'ImageOnUrl' for element 'FullScreen2Button'
      .setProperty("ImageOffUrl","/org/opensourcephysics/resources/controls/images/close.gif") // EJsS HtmlView.HtmlView Page: setting property 'ImageOffUrl' for element 'FullScreen2Button'
      ;

    _view._9(EJSS_INTERFACE.imageAndTextButton,"model", _view.model4) // EJsS HtmlView.HtmlView Page: declaration of element 'model'
      .setProperty("Background","Cyan") // EJsS HtmlView.HtmlView Page: setting property 'Background' for element 'model'
      .setProperty("Tooltip","key in expression like 2*sin(1*t)") // EJsS HtmlView.HtmlView Page: setting property 'Tooltip' for element 'model'
      .setProperty("Text","your model, X =") // EJsS HtmlView.HtmlView Page: setting property 'Text' for element 'model'
      ;

    _view._9(EJSS_INTERFACE.checkBox,"model3", _view.model4) // EJsS HtmlView.HtmlView Page: declaration of element 'model3'
      .setProperty("Background","Cyan") // EJsS HtmlView.HtmlView Page: setting property 'Background' for element 'model3'
      .setProperty("Tooltip","show model") // EJsS HtmlView.HtmlView Page: setting property 'Tooltip' for element 'model3'
      ;

    _view._9(EJSS_INTERFACE.comboBox,"models", _view.model4) // EJsS HtmlView.HtmlView Page: declaration of element 'models'
      .setProperty("Tooltip","select suggested models") // EJsS HtmlView.HtmlView Page: setting property 'Tooltip' for element 'models'
      ;

    _view._9(EJSS_INTERFACE.functionField,"fField", _view.model4) // EJsS HtmlView.HtmlView Page: declaration of element 'fField'
      .setProperty("Width",200) // EJsS HtmlView.HtmlView Page: setting property 'Width' for element 'fField'
      .setProperty("Tooltip","green function") // EJsS HtmlView.HtmlView Page: setting property 'Tooltip' for element 'fField'
      ;

  };

  return _view;
}


//--><!]]></script>
  </head>
  <body>
    <div role="button" id="_topFrame" style="text-align:center"></div>
  <div id="metadata" class="metadata">
    <br />
    <div id="title_author">
      <hr />
      <b>Title and author:</b>
      <p>
      spring k=(Ï€^2)/25 N/m) massm=1 kg  model x,v,a vs t<br />
     <img alt="Logo" src="SHM14/2016-01-22_1350s.png" />
      </p>
      <p>
      <img alt="author image" src="1authorlookangphoto5050.png" />
 weelookang@gmail.com
      </p>
    </div>
    <hr />
    <p></p>
    <div id="copyright_message">
      <div class="cc_left"  style="float:left">&#169; 2017, weelookang@gmail.com.</div>
      <div class="cc_right" style="float:right">    Released under a <a rel="license" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.en_US"> <img alt="Creative Commons Attribution-NonCommercial-ShareAlike" src="_ejs_library/images/cc_icon.png" /> </a> license.</div>
    </div>
  </div>
    <script type="text/javascript"><!--//--><![CDATA[//><!--
      var _model;
      window.addEventListener('load',
        function () { 
          _model =  new SHM14_v2("_topFrame","_ejs_library/",null);
          if (typeof _isApp !== "undefined" && _isApp) _model.setRunAlways(true);
          TextResizeDetector.TARGET_ELEMENT_ID = '_topFrame';
          TextResizeDetector.USER_INIT_FUNC = function () {
            var iBase = TextResizeDetector.addEventListener(function(e,args) {
              _model._fontResized(args[0].iBase,args[0].iSize,args[0].iDelta);
              },null);
            _model._fontResized(iBase);
          };
          _model.onload();
        }, false);
      var interval = setInterval(function() {
         if(document.readyState === 'complete') {
           window.addEventListener('resize', function () { if (_model._resized) _model._resized(window.innerWidth,window.innerHeight); }, false);
           window.addEventListener('scroll', function () { if (_model._resized) _model._resized(window.innerWidth,window.innerHeight); }, false);
           var startCaptureBut = document.getElementById('startCaptureBut'); 
           var stopCaptureBut = document.getElementById('stopCaptureBut'); 
           var resetCaptureBut = document.getElementById('resetCaptureBut'); 
           var playCaptureBut = document.getElementById('playCaptureBut'); 
           var stepCaptureBut = document.getElementById('stepCaptureBut'); 
           if (startCaptureBut) {
             startCaptureBut.onclick = function() {
               _model.startCapture();
             };
             stopCaptureBut.onclick = function() {
               _model.saveText('recording','rec',JSON.stringify(_model.stopCapture()));
             };
             resetCaptureBut.onclick = function() {
               _model.resetCapture();
             };
             playCaptureBut.onclick = function() {
               _model.readText(null,'.rec',function(content){
               _model.playCapture(JSON.parse(content),function(){startCaptureBut.disabled=false; playCaptureBut.disabled=false; stepCaptureBut.disabled=false; window.alert(end_reproduction_message);});               });
             };
             stepCaptureBut.onchange= function() {
               var stepCapt;
               if (stepCaptureBut.value >= 0) stepCapt =  stepCaptureBut.value + 1;
               else stepCapt = 1 + 1.8*stepCaptureBut.value/8;
               _model.changeCaptureStep(stepCapt);
             };
           }
           clearInterval(interval);
         };
      }, 200)
    //--><!]]></script>
  </body>
</html>
